<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- This manual is for Libgcrypt version No value for VERSION and was last
updated No value for UPDATED.  Libgcrypt is GNU's library of cryptographic
building blocks.

Copyright C 2000, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011, 2012 Free Software Foundation, Inc. 

Copyright C 2012, 2013, 2016, 2017 g10 Code GmbH

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 2 of the License, or (at your
option) any later version. The text of the license can be found in the
section entitled "GNU General Public License".

 -->
<!-- Created on September 11, 2023 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>The Libgcrypt Reference Manual</title>

<meta name="description" content="The Libgcrypt Reference Manual">
<meta name="keywords" content="The Libgcrypt Reference Manual">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Top"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-Libgcrypt-Library"></a>
<h1 class="settitle">The Libgcrypt Library</h1>
<p>This manual is for Libgcrypt version No value for VERSION and was last
updated No value for UPDATED.  Libgcrypt is GNU&rsquo;s library of cryptographic
building blocks.
</p>
<p>Copyright &copy; 2000, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011, 2012 Free Software Foundation, Inc. <br>
Copyright &copy; 2012, 2013, 2016, 2017 g10 Code GmbH
</p>
<blockquote><p>Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 2 of the License, or (at your
option) any later version. The text of the license can be found in the
section entitled &ldquo;GNU General Public License&rdquo;.
</p></blockquote>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Introduction">1. Introduction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 What is Libgcrypt.
</td></tr>
<tr><td align="left" valign="top"><a href="#Preparation">2. Preparation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  What you should do before using the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Generalities">3. Generalities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 General library functions and data types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Handler-Functions">4. Handler Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Working with handler functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Symmetric-cryptography">5. Symmetric cryptography</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       How to use symmetric cryptography.
</td></tr>
<tr><td align="left" valign="top"><a href="#Public-Key-cryptography">6. Public Key cryptography</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      How to use public key cryptography.
</td></tr>
<tr><td align="left" valign="top"><a href="#Hashing">7. Hashing</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                      How to use hash algorithms.
</td></tr>
<tr><td align="left" valign="top"><a href="#Message-Authentication-Codes">8. Message Authentication Codes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> How to use MAC algorithms.
</td></tr>
<tr><td align="left" valign="top"><a href="#Key-Derivation">9. Key Derivation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               How to derive keys from strings
</td></tr>
<tr><td align="left" valign="top"><a href="#Random-Numbers">10. Random Numbers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               How to work with random numbers.
</td></tr>
<tr><td align="left" valign="top"><a href="#S_002dexpressions">11. S-expressions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                How to manage S-expressions.
</td></tr>
<tr><td align="left" valign="top"><a href="#MPI-library">12. MPI library</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  How to work with multi-precision-integers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Prime-numbers">13. Prime numbers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                How to use the Prime number related functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Utilities">14. Utilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Utility functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Tools">15. Tools</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                        Utility tools.
</td></tr>
<tr><td align="left" valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Architecture">17. Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 How Libgcrypt works internally.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Appendices

</pre></th></tr><tr><td align="left" valign="top"><a href="#Self_002dTests">A. Description of the Self-Tests</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  Description of the self-tests.
</td></tr>
<tr><td align="left" valign="top"><a href="#FIPS-Mode">B. Description of the FIPS Mode</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                   Description of the FIPS mode.
</td></tr>
<tr><td align="left" valign="top"><a href="#Library-Copying">GNU Lesser General Public License</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             The GNU Lesser General Public License
                                says how you can copy and share Libgcrypt.
</td></tr>
<tr><td align="left" valign="top"><a href="#Copying">GNU General Public License</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     The GNU General Public License says how you
                                can copy and share some parts of Libgcrypt.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Indices

</pre></th></tr><tr><td align="left" valign="top"><a href="#Figures-and-Tables">List of Figures and Tables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Index of figures and tables.
</td></tr>
<tr><td align="left" valign="top"><a href="#Concept-Index">Concept Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Index of concepts and programs.
</td></tr>
<tr><td align="left" valign="top"><a href="#Function-and-Data-Index">Function and Data Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Index of functions, variables and data types.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr></table>




<hr size="1">
<a name="Introduction"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-Started" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Introduction-1"></a>
<h1 class="chapter">1. Introduction</h1>

<p>Libgcrypt is a library providing cryptographic building blocks.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Getting-Started">1.1 Getting Started</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             How to use this manual.
</td></tr>
<tr><td align="left" valign="top"><a href="#Features">1.2 Features</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    A glance at Libgcrypt&rsquo;s features.
</td></tr>
<tr><td align="left" valign="top"><a href="#Overview">1.3 Overview</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Overview about the library.
</td></tr>
</table>

<hr size="6">
<a name="Getting-Started"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Features" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Getting-Started-1"></a>
<h2 class="section">1.1 Getting Started</h2>

<p>This manual documents the Libgcrypt library application programming
interface (API).  All functions and data types provided by the library
are explained.
</p>
<p>The reader is assumed to possess basic knowledge about applied
cryptography.
</p>
<p>This manual can be used in several ways.  If read from the beginning
to the end, it gives a good introduction into the library and how it
can be used in an application.  Forward references are included where
necessary.  Later on, the manual can be used as a reference manual to
get just the information needed about any particular interface of the
library.  Experienced programmers might want to start looking at the
examples at the end of the manual, and then only read up those parts
of the interface which are unclear.
</p>

<hr size="6">
<a name="Features"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Getting-Started" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Overview" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Features-1"></a>
<h2 class="section">1.2 Features</h2>

<p>Libgcrypt might have a couple of advantages over other libraries doing
a similar job.
</p>
<dl compact="compact">
<dt> It&rsquo;s Free Software</dt>
<dd><p>Anybody can use, modify, and redistribute it under the terms of the GNU
Lesser General Public License (see section <a href="#Library-Copying">GNU Lesser General Public License</a>).  Note, that
some parts (which are in general not needed by applications) are subject
to the terms of the GNU General Public License (see section <a href="#Copying">GNU General Public License</a>); please
see the README file of the distribution for the list of these parts.
</p>
</dd>
<dt> It encapsulates the low level cryptography</dt>
<dd><p>Libgcrypt provides a high level interface to cryptographic
building blocks using an extensible and flexible API.
</p>
</dd>
</dl>

<hr size="6">
<a name="Overview"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Features" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Overview-1"></a>
<h2 class="section">1.3 Overview</h2>

<p>The Libgcrypt library is fully thread-safe, where it makes
sense to be thread-safe.  Not thread-safe are some cryptographic
functions that modify a certain context stored in handles.  If the
user really intents to use such functions from different threads on
the same handle, he has to take care of the serialization of such
functions himself.  If not described otherwise, every function is
thread-safe.
</p>
<p>Libgcrypt depends on the library &lsquo;libgpg-error&rsquo;, which contains some
common code used by other GnuPG components.
</p>
<hr size="6">
<a name="Preparation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Overview" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Header" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Preparation-1"></a>
<h1 class="chapter">2. Preparation</h1>

<p>To use Libgcrypt, you have to perform some changes to your
sources and the build system.  The necessary changes are small and
explained in the following sections.  At the end of this chapter, it
is described how the library is initialized, and how the requirements
of the library are verified.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Header">2.1 Header</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                      What header file you need to include.
</td></tr>
<tr><td align="left" valign="top"><a href="#Building-sources">2.2 Building sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            How to build sources using the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Building-sources-using-Automake">2.3 Building sources using Automake</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  How to build sources with the help of Automake.
</td></tr>
<tr><td align="left" valign="top"><a href="#Initializing-the-library">2.4 Initializing the library</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    How to initialize the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Multi_002dThreading">2.5 Multi-Threading</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             How Libgcrypt can be used in a MT environment.
</td></tr>
<tr><td align="left" valign="top"><a href="#Enabling-FIPS-mode">2.6 How to enable the FIPS mode</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Disabling-FIPS-mode">2.7 How to disable the FIPS mode</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#Hardware-features">2.8 How to disable hardware features</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>


<hr size="6">
<a name="Header"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Preparation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Building-sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Header-1"></a>
<h2 class="section">2.1 Header</h2>

<p>All interfaces (data types and functions) of the library are defined
in the header file &lsquo;<tt>gcrypt.h</tt>&rsquo;.  You must include this in all source
files using the library, either directly or through some other header
file, like this:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">#include &lt;gcrypt.h&gt;
</pre></td></tr></table>

<p>The name space of Libgcrypt is <code>gcry_*</code> for function
and type names and <code>GCRY*</code> for other symbols.  In addition the
same name prefixes with one prepended underscore are reserved for
internal use and should never be used by an application.  Note that
Libgcrypt uses libgpg-error, which uses <code>gpg_*</code> as
name space for function and type names and <code>GPG_*</code> for other
symbols, including all the error codes.
</p>
<p>Certain parts of gcrypt.h may be excluded by defining these macros:
</p>
<dl compact="compact">
<dt> <code>GCRYPT_NO_MPI_MACROS</code></dt>
<dd><p>Do not define the shorthand macros <code>mpi_*</code> for <code>gcry_mpi_*</code>.
</p>
</dd>
<dt> <code>GCRYPT_NO_DEPRECATED</code></dt>
<dd><p>Do not include definitions for deprecated features.  This is useful to
make sure that no deprecated features are used.
</p></dd>
</dl>

<hr size="6">
<a name="Building-sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Header" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Building-sources-using-Automake" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Building-sources-1"></a>
<h2 class="section">2.2 Building sources</h2>

<p>If you want to compile a source file including the &lsquo;gcrypt.h&rsquo; header
file, you must make sure that the compiler can find it in the
directory hierarchy.  This is accomplished by adding the path to the
directory in which the header file is located to the compilers include
file search path (via the &lsquo;<samp>-I</samp>&rsquo; option).
</p>
<p>However, the path to the include file is determined at the time the
source is configured.  To solve this problem, Libgcrypt ships with
<code>libgcrypt.pc</code> file, that knows about the path to the include
file and other configuration options.  The options that need to be
added to the compiler invocation at compile time are output by the
&lsquo;<samp>--cflags</samp>&rsquo; option to <code>pkg-config libgcrypt</code>.  The
following example shows how it can be used at the command line:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">gcc -c foo.c `pkg-config --cflags libgcrypt`
</pre></td></tr></table>

<p>Adding the output of &lsquo;<samp>pkg-config --cflags libgcrypt</samp>&rsquo; to the
compiler&rsquo;s command line will ensure that the compiler can find the
Libgcrypt header file.
</p>
<p>A similar problem occurs when linking the program with the library.
Again, the compiler has to find the library files.  For this to work,
the path to the library files has to be added to the library search path
(via the &lsquo;<samp>-L</samp>&rsquo; option).  For this, the option &lsquo;<samp>--libs</samp>&rsquo; to
<code>pkg-config libgcrypt</code> can be used.  For convenience, this option
also outputs all other options that are required to link the program
with the Libgcrypt libraries (in particular, the &lsquo;<samp>-lgcrypt</samp>&rsquo;
option).  The example shows how to link &lsquo;<tt>foo.o</tt>&rsquo; with the Libgcrypt
library to a program <code>foo</code>.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">gcc -o foo foo.o `pkg-config --libs libgcrypt`
</pre></td></tr></table>

<p>Of course you can also combine both examples to a single command by
specifying both options to <code>pkg-config libgcrypt</code>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">gcc -o foo foo.c `pkg-config --cflags --libs libgcrypt`
</pre></td></tr></table>

<hr size="6">
<a name="Building-sources-using-Automake"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Building-sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Initializing-the-library" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Building-sources-using-Automake-1"></a>
<h2 class="section">2.3 Building sources using Automake</h2>

<p>It is much easier if you use GNU Automake instead of writing your own
Makefiles.  If you do that, you do not have to worry about finding and
invoking the <code>pkg-config</code> script at all.
</p>
<p>You can use <code>PKG_CHECK_MODULES</code> macro, or, libgcrypt also
provides an extension to Automake that does all the work for you.
</p>
<dl>
<dt><a name="index-AM_005fPATH_005fLIBGCRYPT"></a><u>Macro:</u> <b>AM_PATH_LIBGCRYPT</b><i> (<span class="roman">[</span><var>minimum-version</var><span class="roman">]</span>, <span class="roman">[</span><var>action-if-found</var><span class="roman">]</span>, <span class="roman">[</span><var>action-if-not-found</var><span class="roman">]</span>)</i></dt>
<dd><p>Check whether Libgcrypt (at least version
<var>minimum-version</var>, if given) exists on the host system.  If it is
found, execute <var>action-if-found</var>, otherwise do
<var>action-if-not-found</var>, if given.
</p>
<p>Additionally, the function defines <code>LIBGCRYPT_CFLAGS</code> to the
flags needed for compilation of the program to find the
&lsquo;<tt>gcrypt.h</tt>&rsquo; header file, and <code>LIBGCRYPT_LIBS</code> to the linker
flags needed to link the program to the Libgcrypt library.
</p>
<p>This macro locates for <code>libgcrypt.pc</code>, with cross-compile support.
</p></dd></dl>

<p>You can use the defined Autoconf variables like this in your
&lsquo;<tt>Makefile.am</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">AM_CPPFLAGS = $(LIBGCRYPT_CFLAGS)
LDADD = $(LIBGCRYPT_LIBS)
</pre></td></tr></table>

<hr size="6">
<a name="Initializing-the-library"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Building-sources-using-Automake" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Multi_002dThreading" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Initializing-the-library-1"></a>
<h2 class="section">2.4 Initializing the library</h2>

<p>Before the library can be used, it must initialize itself.  This is
achieved by invoking the function <code>gcry_check_version</code> described
below.
</p>
<p>Also, it is often desirable to check that the version of
Libgcrypt used is indeed one which fits all requirements.
Even with binary compatibility, new features may have been introduced,
but due to problem with the dynamic linker an old version may actually
be used.  So you may want to check that the version is okay right
after program startup.
</p>
<dl>
<dt><a name="index-gcry_005fcheck_005fversion"></a><u>Function:</u> const char * <b>gcry_check_version</b><i> (const char *<var>req_version</var>)</i></dt>
<dd>
<p>The function <code>gcry_check_version</code> initializes some subsystems used
by Libgcrypt and must be invoked before any other function in the
library.
See section <a href="#Multi_002dThreading">Multi-Threading</a>.
</p>
<p>Furthermore, this function returns the version number of the library.
It can also verify that the version number is higher than a certain
required version number <var>req_version</var>, if this value is not a null
pointer.
</p></dd></dl>

<p>Libgcrypt uses a concept known as secure memory, which is a region of
memory set aside for storing sensitive data.  Because such memory is a
scarce resource, it needs to be setup in advanced to a fixed size.
Further, most operating systems have special requirements on how that
secure memory can be used.  For example, it might be required to install
an application as &ldquo;setuid(root)&rdquo; to allow allocating such memory.
Libgcrypt requires a sequence of initialization steps to make sure that
this works correctly.  The following examples show the necessary steps.
</p>
<p>If you don&rsquo;t have a need for secure memory, for example if your
application does not use secret keys or other confidential data or it
runs in a controlled environment where key material floating around in
memory is not a problem, you should initialize Libgcrypt this way:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  /* Version check should be the very first call because it
     makes sure that important subsystems are initialized.
     #define NEED_LIBGCRYPT_VERSION to the minimum required version. */
  if (!gcry_check_version (NEED_LIBGCRYPT_VERSION))
    {
      fprintf (stderr, &quot;libgcrypt is too old (need %s, have %s)\n&quot;,
         NEED_LIBGCRYPT_VERSION, gcry_check_version (NULL));
      exit (2);
    }

  /* Disable secure memory.  */
  gcry_control (GCRYCTL_DISABLE_SECMEM, 0);

  /* ... If required, other initialization goes here.  */

  /* Tell Libgcrypt that initialization has completed. */
  gcry_control (GCRYCTL_INITIALIZATION_FINISHED, 0);
</pre></td></tr></table>


<p>If you have to protect your keys or other information in memory against
being swapped out to disk and to enable an automatic overwrite of used
and freed memory, you need to initialize Libgcrypt this way:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  /* Version check should be the very first call because it
     makes sure that important subsystems are initialized.
     #define NEED_LIBGCRYPT_VERSION to the minimum required version. */
  if (!gcry_check_version (NEED_LIBGCRYPT_VERSION))
    {
      fprintf (stderr, &quot;libgcrypt is too old (need %s, have %s)\n&quot;,
         NEED_LIBGCRYPT_VERSION, gcry_check_version (NULL));
      exit (2);
    }

<a name="sample_002duse_002dsuspend_002dsecmem"></a>
  /* We don't want to see any warnings, e.g. because we have not yet
     parsed program options which might be used to suppress such
     warnings. */
  gcry_control (GCRYCTL_SUSPEND_SECMEM_WARN);

  /* ... If required, other initialization goes here.  Note that the
     process might still be running with increased privileges and that
     the secure memory has not been initialized.  */

  /* Allocate a pool of 16k secure memory.  This makes the secure memory
     available and also drops privileges where needed.  Note that by
     using functions like gcry_xmalloc_secure and gcry_mpi_snew Libgcrypt
     may expand the secure memory pool with memory which lacks the
     property of not being swapped out to disk.   */
  gcry_control (GCRYCTL_INIT_SECMEM, 16384, 0);

<a name="sample_002duse_002dresume_002dsecmem"></a>
  /* It is now okay to let Libgcrypt complain when there was/is
     a problem with the secure memory. */
  gcry_control (GCRYCTL_RESUME_SECMEM_WARN);

  /* ... If required, other initialization goes here.  */

  /* Tell Libgcrypt that initialization has completed. */
  gcry_control (GCRYCTL_INITIALIZATION_FINISHED, 0);
</pre></td></tr></table>

<p>It is important that these initialization steps are not done by a
library but by the actual application.  A library using Libgcrypt might
want to check for finished initialization using:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  if (!gcry_control (GCRYCTL_INITIALIZATION_FINISHED_P))
    {
      fputs (&quot;libgcrypt has not been initialized\n&quot;, stderr);
      abort ();
    }
</pre></td></tr></table>

<p>Instead of terminating the process, the library may instead print a
warning and try to initialize Libgcrypt itself.  See also the section on
multi-threading below for more pitfalls.
</p>


<hr size="6">
<a name="Multi_002dThreading"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Initializing-the-library" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Enabling-FIPS-mode" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Multi_002dThreading-1"></a>
<h2 class="section">2.5 Multi-Threading</h2>

<p>As mentioned earlier, the Libgcrypt library is
thread-safe if you adhere to the following requirements:
</p>
<ul>
<li>
If you use pthread and your applications forks and does not directly
call exec (even calling stdio functions), all kind of problems may
occur.  Future versions of Libgcrypt will try to cleanup using
pthread_atfork but even that may lead to problems.  This is a common
problem with almost all applications using pthread and fork.


</li><li>
The function <code>gcry_check_version</code> must be called before any other
function in the library.  To
achieve this in multi-threaded programs, you must synchronize the
memory with respect to other threads that also want to use
Libgcrypt.  For this, it is sufficient to call
<code>gcry_check_version</code> before creating the other threads using
Libgcrypt<a name="DOCF1" href="#FOOT1">(1)</a>.

</li><li>
Just like the function <code>gpg_strerror</code>, the function
<code>gcry_strerror</code> is not thread safe.  You have to use
<code>gpg_strerror_r</code> instead.

</li></ul>


<hr size="6">
<a name="Enabling-FIPS-mode"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Multi_002dThreading" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Disabling-FIPS-mode" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="How-to-enable-the-FIPS-mode"></a>
<h2 class="section">2.6 How to enable the FIPS mode</h2>
<a name="index-FIPS-mode"></a>
<a name="index-FIPS-140"></a>

<p><a name="enabling-fips-mode"></a>
Libgcrypt may be used in a FIPS 140-3 mode.  Note, that this does not
necessary mean that Libcgrypt is an appoved FIPS 140-3 module.  Check the
NIST database at <a href="http://csrc.nist.gov/groups/STM/cmvp/">http://csrc.nist.gov/groups/STM/cmvp/</a> to see what
versions of Libgcrypt are approved.
</p>
<p>Because FIPS 140 has certain restrictions on the use of cryptography
which are not always wanted, Libgcrypt needs to be put into FIPS mode
explicitly.  Four alternative mechanisms are provided to switch
Libgcrypt into this mode:
</p>
<ul>
<li>
If the file &lsquo;<tt>/proc/sys/crypto/fips_enabled</tt>&rsquo; exists and contains a
numeric value other than <code>0</code>, Libgcrypt is put into FIPS mode at
initialization time.  Obviously this works only on systems with a
<code>proc</code> file system (i.e. GNU/Linux).

</li><li>
If the file &lsquo;<tt>/etc/gcrypt/fips_enabled</tt>&rsquo; exists, Libgcrypt is put
into FIPS mode at initialization time.  Note that this filename is
hardwired and does not depend on any configuration options.

</li><li>
By setting the environment variable <code>LIBGCRYPT_FORCE_FIPS_MODE</code>,
Libgcrypt is put into FIPS mode at initialization time.

</li><li>
If the application requests FIPS mode using the control command
<code>GCRYCTL_FORCE_FIPS_MODE</code>.  This must be done prior to any
initialization (i.e. before <code>gcry_check_version</code>).

</li></ul>


<hr size="6">
<a name="Disabling-FIPS-mode"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Enabling-FIPS-mode" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hardware-features" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="How-to-disable-the-FIPS-mode"></a>
<h2 class="section">2.7 How to disable the FIPS mode</h2>
<a name="index-FIPS-mode-1"></a>
<a name="index-FIPS-140-1"></a>

<p><a name="disabling-fips-mode"></a>
When the system is configured using libgcrypt in FIPS mode (by file or
environement variable), but an application wants to use non-FIPS
features, Libgcrypt needs to be gotten out of FIPS mode.  A mechanism
is provided to switch Libgcrypt into non-FIPS mode:
</p>
<ul>
<li>
If the application requests non-FIPS mode using the control command
<code>GCRYCTL_NO_FIPS_MODE</code>.  This must be done prior to any
initialization (i.e. before <code>gcry_check_version</code>).
</li></ul>



<hr size="6">
<a name="Hardware-features"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Disabling-FIPS-mode" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Preparation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="How-to-disable-hardware-features"></a>
<h2 class="section">2.8 How to disable hardware features</h2>
<a name="index-hardware-features"></a>

<p><a name="hardware-features"></a>
Libgcrypt makes use of certain hardware features.  If the use of a
feature is not desired, it may be disabled either by a program or
globally using a configuration file.  The currently supported features
are
</p>
<dl compact="compact">
<dt> <code>padlock-rng</code></dt>
<dt> <code>padlock-aes</code></dt>
<dt> <code>padlock-sha</code></dt>
<dt> <code>padlock-mmul</code></dt>
<dt> <code>intel-cpu</code></dt>
<dt> <code>intel-fast-shld</code></dt>
<dt> <code>intel-bmi2</code></dt>
<dt> <code>intel-ssse3</code></dt>
<dt> <code>intel-sse4.1</code></dt>
<dt> <code>intel-pclmul</code></dt>
<dt> <code>intel-aesni</code></dt>
<dt> <code>intel-rdrand</code></dt>
<dt> <code>intel-avx</code></dt>
<dt> <code>intel-avx2</code></dt>
<dt> <code>intel-fast-vpgather</code></dt>
<dt> <code>intel-rdtsc</code></dt>
<dt> <code>intel-shaext</code></dt>
<dt> <code>intel-vaes-vpclmul</code></dt>
<dt> <code>arm-neon</code></dt>
<dt> <code>arm-aes</code></dt>
<dt> <code>arm-sha1</code></dt>
<dt> <code>arm-sha2</code></dt>
<dt> <code>arm-pmull</code></dt>
<dt> <code>ppc-vcrypto</code></dt>
<dt> <code>ppc-arch_3_00</code></dt>
<dt> <code>ppc-arch_2_07</code></dt>
<dt> <code>ppc-arch_3_10</code></dt>
<dt> <code>s390x-msa</code></dt>
<dt> <code>s390x-msa-4</code></dt>
<dt> <code>s390x-msa-8</code></dt>
<dt> <code>s390x-msa-9</code></dt>
<dt> <code>s390x-vx</code></dt>
</dl>

<p>To disable a feature for all processes using Libgcrypt 1.6 or newer,
create the file &lsquo;<tt>/etc/gcrypt/hwf.deny</tt>&rsquo; and put each feature not
to be used on a single line.  Empty lines, white space, and lines
prefixed with a hash mark are ignored.  The file should be world
readable.
</p>
<p>To disable a feature specifically for a program, that program must tell
it Libgcrypt before before calling <code>gcry_check_version</code>.
Example:<a name="DOCF2" href="#FOOT2">(2)</a>
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  gcry_control (GCRYCTL_DISABLE_HWF, &quot;intel-rdrand&quot;, NULL);
</pre></td></tr></table>

<p>To print the list of active features you may use this command:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  mpicalc --print-config | grep ^hwflist: | tr : '\n' | tail -n +2
</pre></td></tr></table>


<hr size="6">
<a name="Generalities"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hardware-features" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Controlling-the-library" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Preparation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generalities-1"></a>
<h1 class="chapter">3. Generalities</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Controlling-the-library">3.1 Controlling the library</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Controlling Libgcrypt&rsquo;s behavior.
</td></tr>
<tr><td align="left" valign="top"><a href="#Error-Handling">3.2 Error Handling</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Error codes and such.
</td></tr>
</table>

<hr size="6">
<a name="Controlling-the-library"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generalities" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Handling" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Controlling-the-library-1"></a>
<h2 class="section">3.1 Controlling the library</h2>

<dl>
<dt><a name="index-gcry_005fcontrol"></a><u>Function:</u> gcry_error_t <b>gcry_control</b><i> (enum gcry_ctl_cmds <var>cmd</var>, ...)</i></dt>
<dd>
<p>This function can be used to influence the general behavior of
Libgcrypt in several ways.  Depending on <var>cmd</var>, more
arguments can or have to be provided.
</p>
<dl compact="compact">
<dt> <code>GCRYCTL_ENABLE_M_GUARD; Arguments: none</code></dt>
<dd><p>This command enables the built-in memory guard.  It must not be used
to activate the memory guard after the memory management has already
been used; therefore it can ONLY be used before
<code>gcry_check_version</code>.  Note that the memory guard is NOT used
when the user of the library has set his own memory management
callbacks.
</p>
</dd>
<dt> <code>GCRYCTL_ENABLE_QUICK_RANDOM; Arguments: none</code></dt>
<dd><p>This command inhibits the use the very secure random quality level
(<code>GCRY_VERY_STRONG_RANDOM</code>) and degrades all request down to
<code>GCRY_STRONG_RANDOM</code>.  In general this is not recommended.  However,
for some applications the extra quality random Libgcrypt tries to create
is not justified and this option may help to get better performance.
Please check with a crypto expert whether this option can be used for
your application.
</p>
<p>This option can only be used at initialization time.
</p>

</dd>
<dt> <code>GCRYCTL_DUMP_RANDOM_STATS; Arguments: none</code></dt>
<dd><p>This command dumps random number generator related statistics to the
library&rsquo;s logging stream.
</p>
</dd>
<dt> <code>GCRYCTL_DUMP_MEMORY_STATS; Arguments: none</code></dt>
<dd><p>This command dumps memory management related statistics to the library&rsquo;s
logging stream.
</p>
</dd>
<dt> <code>GCRYCTL_DUMP_SECMEM_STATS; Arguments: none</code></dt>
<dd><p>This command dumps secure memory management related statistics to the
library&rsquo;s logging stream.
</p>
</dd>
<dt> <code>GCRYCTL_DROP_PRIVS; Arguments: none</code></dt>
<dd><p>This command disables the use of secure memory and drops the privileges
of the current process.  This command has not much use; the suggested way
to disable secure memory is to use <code>GCRYCTL_DISABLE_SECMEM</code> right
after initialization.
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_SECMEM; Arguments: none</code></dt>
<dd><p>This command disables the use of secure memory.  In FIPS mode this command
has no effect at all.
</p>
<p>Many applications do not require secure memory, so they should disable
it right away.  This command should be executed right after
<code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_LOCKED_SECMEM; Arguments: none</code></dt>
<dd><p>This command disables the use of the mlock call for secure memory.
Disabling the use of mlock may for example be done if an encrypted
swap space is in use.  This command should be executed right after
<code>gcry_check_version</code>.  Note that by using functions like
<code>gcry_xmalloc_secure</code> and <code>gcry_mpi_snew</code> Libgcrypt may expand the secure
memory pool with memory which lacks the property of not being swapped
out to disk (but will still be zeroed out on free).
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_PRIV_DROP; Arguments: none</code></dt>
<dd><p>This command sets a global flag to tell the secure memory subsystem
that it shall not drop privileges after secure memory has been
allocated.  This command is commonly used right after
<code>gcry_check_version</code> but may also be used right away at program
startup.  It won&rsquo;t have an effect after the secure memory pool has
been initialized.  WARNING: A process running setuid(root) is a severe
security risk.  Processes making use of Libgcrypt or other complex
code should drop these extra privileges as soon as possible.  If this
command has been used the caller is responsible for dropping the
privileges.
</p>
</dd>
<dt> <code>GCRYCTL_INIT_SECMEM; Arguments: unsigned int nbytes</code></dt>
<dd><p>This command is used to allocate a pool of secure memory and thus
enabling the use of secure memory.  It also drops all extra privileges
the process has (i.e. if it is run as setuid (root)).  If the argument
<var>nbytes</var> is 0, secure memory will be disabled.  The minimum amount
of secure memory allocated is currently 16384 bytes; you may thus use a
value of 1 to request that default size.
</p>
</dd>
<dt> <code>GCRYCTL_AUTO_EXPAND_SECMEM; Arguments: unsigned int chunksize</code></dt>
<dd><p>This command enables on-the-fly expanding of the secure memory area.
Note that by using functions like <code>gcry_xmalloc_secure</code> and
<code>gcry_mpi_snew</code> will do this auto expanding anyway.  The argument
to this option is the suggested size for new secure memory areas.  A
larger size improves performance of all memory allocation and
releasing functions.  The given chunksize is rounded up to the next
32KiB.  The drawback of auto expanding is that memory might be swapped
out to disk; this can be fixed by configuring the system to use an
encrypted swap space.
</p>
</dd>
<dt> <code>GCRYCTL_TERM_SECMEM; Arguments: none</code></dt>
<dd><p>This command zeroises the secure memory and destroys the handler.  The
secure memory pool may not be used anymore after running this command.
If the secure memory pool has already been destroyed, this command has
no effect.  Applications might want to run this command from their
exit handler to make sure that the secure memory gets properly
destroyed.  This command is not necessarily thread-safe but that
should not be needed in cleanup code.  It may be called from a signal
handler.
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_SECMEM_WARN; Arguments: none</code></dt>
<dd><p>Disable warning messages about problems with the secure memory
subsystem. This command should be run right after
<code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_SUSPEND_SECMEM_WARN; Arguments: none</code></dt>
<dd><p>Postpone warning messages from the secure memory subsystem.
See <a href="#sample_002duse_002dsuspend_002dsecmem">the initialization example</a>, on how to
use it.
</p>
</dd>
<dt> <code>GCRYCTL_RESUME_SECMEM_WARN; Arguments: none</code></dt>
<dd><p>Resume warning messages from the secure memory subsystem.
See <a href="#sample_002duse_002dresume_002dsecmem">the initialization example</a>, on how to
use it.
</p>
</dd>
<dt> <code>GCRYCTL_USE_SECURE_RNDPOOL; Arguments: none</code></dt>
<dd><p>This command tells the PRNG to store random numbers in secure memory.
This command should be run right after <code>gcry_check_version</code> and not
later than the command GCRYCTL_INIT_SECMEM.  Note that in FIPS mode the
secure memory is always used.
</p>
</dd>
<dt> <code>GCRYCTL_SET_RANDOM_SEED_FILE; Arguments: const char *filename</code></dt>
<dd><p>This command specifies the file, which is to be used as seed file for
the PRNG.  If the seed file is registered prior to initialization of the
PRNG, the seed file&rsquo;s content (if it exists and seems to be valid) is
fed into the PRNG pool.  After the seed file has been registered, the
PRNG can be signalled to write out the PRNG pool&rsquo;s content into the seed
file with the following command.
</p>

</dd>
<dt> <code>GCRYCTL_UPDATE_RANDOM_SEED_FILE; Arguments: none</code></dt>
<dd><p>Write out the PRNG pool&rsquo;s content into the registered seed file.
</p>
<p>Multiple instances of the applications sharing the same random seed file
can be started in parallel, in which case they will read out the same
pool and then race for updating it (the last update overwrites earlier
updates).  They will differentiate only by the weak entropy that is
added in read_seed_file based on the PID and clock, and up to 16 bytes
of weak random non-blockingly.  The consequence is that the output of
these different instances is correlated to some extent.  In a perfect
attack scenario, the attacker can control (or at least guess) the PID
and clock of the application, and drain the system&rsquo;s entropy pool to
reduce the &quot;up to 16 bytes&quot; above to 0.  Then the dependencies of the
initial states of the pools are completely known.  Note that this is not
an issue if random of <code>GCRY_VERY_STRONG_RANDOM</code> quality is
requested, as in this case enough extra entropy gets mixed.  It is also
not an issue when using rndgetentropy or rndoldlinux module, because the
module guarantees to read full 16 bytes and thus there is no
way for an attacker without kernel access to control these 16 bytes.
</p>
</dd>
<dt> <code>GCRYCTL_CLOSE_RANDOM_DEVICE; Arguments: none</code></dt>
<dd><p>Try to close the random device.  If on Unix system you call fork(),
the child process does no call exec(), and you do not intend to use
Libgcrypt in the child, it might be useful to use this control code to
close the inherited file descriptors of the random device.  If
Libgcrypt is later used again by the child, the device will be
re-opened.  On non-Unix systems this control code is ignored.
</p>
</dd>
<dt> <code>GCRYCTL_SET_VERBOSITY; Arguments: int level</code></dt>
<dd><p>This command sets the verbosity of the logging.  A level of 0 disables
all extra logging, whereas positive numbers enable more verbose logging.
The level may be changed at any time but be aware that no memory
synchronization is done so the effect of this command might not
immediately show up in other threads.  This command may even be used
prior to <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_SET_DEBUG_FLAGS; Arguments: unsigned int flags</code></dt>
<dd><p>Set the debug flag bits as given by the argument.  Be aware that no
memory synchronization is done so the effect of this command might not
immediately show up in other threads.  The debug flags are not
considered part of the API and thus may change without notice.  As of
now bit 0 enables debugging of cipher functions and bit 1 debugging of
multi-precision-integers.  This command may even be used prior to
<code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_CLEAR_DEBUG_FLAGS; Arguments: unsigned int flags</code></dt>
<dd><p>Set the debug flag bits as given by the argument.  Be aware that that no
memory synchronization is done so the effect of this command might not
immediately show up in other threads.  This command may even be used
prior to <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_INTERNAL_LOCKING; Arguments: none</code></dt>
<dd><p>This command does nothing.  It exists only for backward compatibility.
</p>
</dd>
<dt> <code>GCRYCTL_ANY_INITIALIZATION_P; Arguments: none</code></dt>
<dd><p>This command returns true if the library has been basically initialized.
Such a basic initialization happens implicitly with many commands to get
certain internal subsystems running.  The common and suggested way to
do this basic initialization is by calling <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_INITIALIZATION_FINISHED; Arguments: none</code></dt>
<dd><p>This command tells the library that the application has finished the
initialization.
</p>
</dd>
<dt> <code>GCRYCTL_INITIALIZATION_FINISHED_P; Arguments: none</code></dt>
<dd><p>This command returns true if the command
<code>GCRYCTL_INITIALIZATION_FINISHED</code> has already been run.
</p>
</dd>
<dt> <code>GCRYCTL_SET_THREAD_CBS; Arguments: struct ath_ops *ath_ops</code></dt>
<dd><p>This command is obsolete since version 1.6.
</p>
</dd>
<dt> <code>GCRYCTL_FAST_POLL; Arguments: none</code></dt>
<dd><p>Run a fast random poll.
</p>
</dd>
<dt> <code>GCRYCTL_SET_RNDEGD_SOCKET; Arguments: const char *filename</code></dt>
<dd><p>This command may be used to override the default name of the EGD socket
to connect to.  It may be used only during initialization as it is not
thread safe.  Changing the socket name again is not supported.  The
function may return an error if the given filename is too long for a
local socket name.
</p>
<p>EGD is an alternative random gatherer, used only on systems lacking a
proper random device.
</p>
</dd>
<dt> <code>GCRYCTL_PRINT_CONFIG; Arguments: FILE *stream</code></dt>
<dd><p>This command dumps information pertaining to the configuration of the
library to the given stream.  If <code>NULL</code> is given for <var>stream</var>, the log
system is used.  This command may be used before the initialization has
been finished but not before a <code>gcry_check_version</code>.  Note that
the macro <code>estream_t</code> can be used instead of <code>gpgrt_stream_t</code>.
</p>
</dd>
<dt> <code>GCRYCTL_OPERATIONAL_P; Arguments: none</code></dt>
<dd><p>This command returns true if the library is in an operational state.
This information makes sense only in FIPS mode.  In contrast to other
functions, this is a pure test function and won&rsquo;t put the library into
FIPS mode or change the internal state.  This command may be used before
the initialization has been finished but not before a <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_MODE_P; Arguments: none</code></dt>
<dd><p>This command returns true if the library is in FIPS mode.  Note, that
this is no indication about the current state of the library.  This
command may be used before the initialization has been finished but not
before a <code>gcry_check_version</code>.  An application may use this command or
the convenience macro below to check whether FIPS mode is actually
active.
</p>
<dl>
<dt><a name="index-gcry_005ffips_005fmode_005factive"></a><u>Function:</u> int <b>gcry_fips_mode_active</b><i> (void)</i></dt>
<dd>
<p>Returns true if the FIPS mode is active.  Note that this is
implemented as a macro.
</p></dd></dl>



</dd>
<dt> <code>GCRYCTL_FORCE_FIPS_MODE; Arguments: none</code></dt>
<dd><p>Running this command puts the library into FIPS mode.  If the library is
already in FIPS mode, a self-test is triggered and thus the library will
be put into operational state.  This command may be used before a call
to <code>gcry_check_version</code> and that is actually the recommended way to let an
application switch the library into FIPS mode.  Note that Libgcrypt will
reject an attempt to switch to FIPS mode during or after the initialization.
</p>
</dd>
<dt> <code>GCRYCTL_NO_FIPS_MODE; Arguments: none</code></dt>
<dd><p>Running this command puts the library into non-FIPS mode.  This
command may be used before a call to <code>gcry_check_version</code> and
that is actually the recommended way to let an application switch the
library into non-FIPS mode.  Note that Libgcrypt will reject an attempt to
switch to non-FIPS mode during or after the initialization.
</p>
</dd>
<dt> <code>GCRYCTL_SET_ENFORCED_FIPS_FLAG; Arguments: none</code></dt>
<dd><p>This command is obsolete and has no effect; do not use it.
</p>
</dd>
<dt> <code>GCRYCTL_SET_PREFERRED_RNG_TYPE; Arguments: int</code></dt>
<dd><p>These are advisory commands to select a certain random number
generator.  They are only advisory because libraries may not know what
an application actually wants or vice versa.  Thus Libgcrypt employs a
priority check to select the actually used RNG.  If an applications
selects a lower priority RNG but a library requests a higher priority
RNG, Libgcrypt will switch to the higher priority RNG.  Applications
and libraries should use these control codes before
<code>gcry_check_version</code>.  The available generators are:
</p><dl compact="compact">
<dt> <code>GCRY_RNG_TYPE_STANDARD</code></dt>
<dd><p>A conservative standard generator based on the &ldquo;Continuously Seeded
Pseudo Random Number Generator&rdquo; designed by Peter Gutmann.
</p></dd>
<dt> <code>GCRY_RNG_TYPE_FIPS</code></dt>
<dd><p>A deterministic random number generator conforming to the document
&ldquo;NIST-Recommended Random Number Generator Based on ANSI X9.31
Appendix A.2.4 Using the 3-Key Triple DES and AES Algorithms&rdquo;
(2005-01-31).  This implementation uses the AES variant.
</p></dd>
<dt> <code>GCRY_RNG_TYPE_SYSTEM</code></dt>
<dd><p>A wrapper around the system&rsquo;s native RNG.  On Unix system these are
usually the /dev/random and /dev/urandom devices.
</p></dd>
</dl>
<p>The default is <code>GCRY_RNG_TYPE_STANDARD</code> unless FIPS mode as been
enabled; in which case <code>GCRY_RNG_TYPE_FIPS</code> is used and locked
against further changes.
</p>
</dd>
<dt> <code>GCRYCTL_GET_CURRENT_RNG_TYPE; Arguments: int *</code></dt>
<dd><p>This command stores the type of the currently used RNG as an integer
value at the provided address.
</p>

</dd>
<dt> <code>GCRYCTL_SELFTEST; Arguments: none</code></dt>
<dd><p>This may be used at anytime to have the library run all implemented
self-tests.  It works in standard and in FIPS mode.  Returns 0 on
success or an error code on failure.
</p>
</dd>
<dt> <code>GCRYCTL_DISABLE_HWF; Arguments: const char *name</code></dt>
<dd>
<p>Libgcrypt detects certain features of the CPU at startup time.  For
performance tests it is sometimes required not to use such a feature.
This option may be used to disable a certain feature; i.e. Libgcrypt
behaves as if this feature has not been detected.  This call can be
used several times to disable a set of features, or features may be
given as a colon or comma delimited string.  The special feature
&quot;all&quot; can be used to disable all available features.
</p>
<p>Note that the detection code might be run if the feature has been
disabled.  This command must be used at initialization time;
i.e. before calling <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>GCRYCTL_REINIT_SYSCALL_CLAMP; Arguments: none</code></dt>
<dd>
<p>Libgcrypt wraps blocking system calls with two functions calls
(&ldquo;system call clamp&rdquo;) to give user land threading libraries a hook
for re-scheduling.  This works by reading the system call clamp from
Libgpg-error at initialization time.  However sometimes Libgcrypt
needs to be initialized before the user land threading systems and at
that point the system call clamp has not been registered with
Libgpg-error and in turn Libgcrypt would not use them.  The control
code can be used to tell Libgcrypt that a system call clamp has now
been registered with Libgpg-error and advise Libgcrypt to read the
clamp again.  Obviously this control code may only be used before a
second thread is started in a process.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_CIPHER; Arguments: enum gcry_cipher_algos [, enum gcry_cipher_modes]</code></dt>
<dd>
<p>Check if the given symmetric cipher and optional cipher mode combination
is approved under the current FIPS 140-3 certification. If the
combination is approved, this function returns <code>GPG_ERR_NO_ERROR</code>.
Otherwise <code>GPG_ERR_NOT_SUPPORTED</code> is returned.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_KDF; Arguments: enum gcry_kdf_algos</code></dt>
<dd>
<p>Check if the given KDF is approved under the current FIPS 140-3
certification. If the KDF is approved, this function returns
<code>GPG_ERR_NO_ERROR</code>. Otherwise <code>GPG_ERR_NOT_SUPPORTED</code>
is returned.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_FUNCTION; Arguments: const char *</code></dt>
<dd>
<p>Check if the given function is approved under the current FIPS 140-3
certification. If the function is approved, this function returns
<code>GPG_ERR_NO_ERROR</code> (other restrictions might still apply).
Otherwise <code>GPG_ERR_NOT_SUPPORTED</code> is returned.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_MAC; Arguments: enum gcry_mac_algos</code></dt>
<dd>
<p>Check if the given MAC is approved under the current FIPS 140-3
certification. If the MAC is approved, this function returns
<code>GPG_ERR_NO_ERROR</code>. Otherwise <code>GPG_ERR_NOT_SUPPORTED</code>
is returned.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_MD; Arguments: enum gcry_md_algos</code></dt>
<dd>
<p>Check if the given message digest algorithm is approved under the current
FIPS 140-3 certification. If the algorithm is approved, this function returns
<code>GPG_ERR_NO_ERROR</code>. Otherwise <code>GPG_ERR_NOT_SUPPORTED</code> is returned.
</p>
</dd>
<dt> <code>GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS; Arguments: const char *</code></dt>
<dd>
<p>Check if the given public key operation flag or s-expression object name is
approved under the current FIPS 140-3 certification.  If the flag is
approved, this function returns <code>GPG_ERR_NO_ERROR</code>.
</p>
<p>Otherwise <code>GPG_ERR_NOT_SUPPORTED</code> is returned.
</p>
<p>For compound s-expression objects, if the object name is allowed, the user
is responsible to check also the internal members.  For example:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  gcry_sexp_t s_sig = NULL;
  gcry_md_hd_t hd = NULL;
  gcry_sexp_t s_sk = NULL;
  const char *data_tmpl = &quot;(data(flags pss)(hash %s %b)(salt-length 1:0))&quot;;

  if (err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_FUNCTION, &quot;gcry_md_open&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_MD, GCRY_MD_SHA512) &amp;&amp;
      err = gcry_md_open (&amp;hd, GCRY_MD_SHA512, 0))
    {
      printf (&quot;gcry_md_open failed: %s&quot;, gpg_strerror (err));
      return;
    }
  gcry_md_write (hd, buffer, buflen);

  /* initialize the key in s_sk */

  if (err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_FUNCTION, &quot;gcry_pk_hash_sign&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS, &quot;data&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS, &quot;flags&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS, &quot;pss&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS, &quot;hash&quot;) &amp;&amp;
      err = gcry_control(GCRYCTL_FIPS_SERVICE_INDICATOR_PK_FLAGS, &quot;salt-length&quot;)
      err = gcry_pk_hash_sign (&amp;s_sig, data_tmpl, s_sk, hd, NULL))
    {
      printf (&quot;gcry_pk_hash_sign failed: %s&quot;, gpg_strerror (err));
      return;
    }
  /* ok */
</pre></td></tr></table>

</dd>
</dl>

</dd></dl>

<hr size="6">
<a name="Error-Handling"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Controlling-the-library" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Values" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generalities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-Handling-1"></a>
<h2 class="section">3.2 Error Handling</h2>

<p>Many functions in Libgcrypt can return an error if they
fail.  For this reason, the application should always catch the error
condition and take appropriate measures, for example by releasing the
resources and passing the error up to the caller, or by displaying a
descriptive message to the user and cancelling the operation.
</p>
<p>Some error values do not indicate a system error or an error in the
operation, but the result of an operation that failed properly.  For
example, if you try to decrypt a tampered message, the decryption will
fail.  Another error value actually means that the end of a data
buffer or list has been reached.  The following descriptions explain
for many error codes what they mean usually.  Some error values have
specific meanings if returned by a certain functions.  Such cases are
described in the documentation of those functions.
</p>
<p>Libgcrypt uses the <code>libgpg-error</code> library.  This allows to share
the error codes with other components of the GnuPG system, and to pass
error values transparently from the crypto engine, or some helper
application of the crypto engine, to the user.  This way no
information is lost.  As a consequence, Libgcrypt does not use its own
identifiers for error codes, but uses those provided by
<code>libgpg-error</code>.  They usually start with <code>GPG_ERR_</code>.
</p>
<p>However, Libgcrypt does provide aliases for the functions
defined in libgpg-error, which might be preferred for name space
consistency.
</p>

<p>Most functions in Libgcrypt return an error code in the case
of failure.  For this reason, the application should always catch the
error condition and take appropriate measures, for example by
releasing the resources and passing the error up to the caller, or by
displaying a descriptive message to the user and canceling the
operation.
</p>
<p>Some error values do not indicate a system error or an error in the
operation, but the result of an operation that failed properly.
</p>
<p>GnuPG components, including Libgcrypt, use an extra library named
libgpg-error to provide a common error handling scheme.  For more
information on libgpg-error, see the according manual.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                The error value and what it means.
</td></tr>
<tr><td align="left" valign="top"><a href="#Error-Sources">3.2.2 Error Sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               A list of important error sources.
</td></tr>
<tr><td align="left" valign="top"><a href="#Error-Codes">3.2.3 Error Codes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 A list of important error codes.
</td></tr>
<tr><td align="left" valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               How to get a descriptive string from a value.
</td></tr>
</table>


<hr size="6">
<a name="Error-Values"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-Handling" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Sources" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Handling" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-Values-1"></a>
<h3 class="subsection">3.2.1 Error Values</h3>
<a name="index-error-values"></a>
<a name="index-error-codes"></a>
<a name="index-error-sources"></a>

<dl>
<dt><a name="index-gcry_005ferr_005fcode_005ft"></a><u>Data type:</u> <b>gcry_err_code_t</b></dt>
<dd><p>The <code>gcry_err_code_t</code> type is an alias for the
<code>libgpg-error</code> type <code>gpg_err_code_t</code>.  The error code
indicates the type of an error, or the reason why an operation failed.
</p>
<p>A list of important error codes can be found in the next section.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferr_005fsource_005ft"></a><u>Data type:</u> <b>gcry_err_source_t</b></dt>
<dd><p>The <code>gcry_err_source_t</code> type is an alias for the
<code>libgpg-error</code> type <code>gpg_err_source_t</code>.  The error source
has not a precisely defined meaning.  Sometimes it is the place where
the error happened, sometimes it is the place where an error was
encoded into an error value.  Usually the error source will give an
indication to where to look for the problem.  This is not always true,
but it is attempted to achieve this goal.
</p>
<p>A list of important error sources can be found in the next section.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferror_005ft"></a><u>Data type:</u> <b>gcry_error_t</b></dt>
<dd><p>The <code>gcry_error_t</code> type is an alias for the <code>libgpg-error</code>
type <code>gpg_error_t</code>.  An error value like this has always two
components: an error code and an error source.  Both together form the
error value.
</p>
<p>Thus, the error value can not be directly compared against an error
code, but the accessor functions described below must be used.
However, it is guaranteed that only 0 is used to indicate success
(<code>GPG_ERR_NO_ERROR</code>), and that in this case all other parts of
the error value are set to 0, too.
</p>
<p>Note that in Libgcrypt, the error source is used purely for
diagnostic purposes.  Only the error code should be checked to test
for a certain outcome of a function.  The manual only documents the
error code part of an error value.  The error source is left
unspecified and might be anything.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferr_005fcode"></a><u>Function:</u> gcry_err_code_t <b>gcry_err_code</b><i> (gcry_error_t <var>err</var>)</i></dt>
<dd><p>The static inline function <code>gcry_err_code</code> returns the
<code>gcry_err_code_t</code> component of the error value <var>err</var>.  This
function must be used to extract the error code from an error value in
order to compare it with the <code>GPG_ERR_*</code> error code macros.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferr_005fsource"></a><u>Function:</u> gcry_err_source_t <b>gcry_err_source</b><i> (gcry_error_t <var>err</var>)</i></dt>
<dd><p>The static inline function <code>gcry_err_source</code> returns the
<code>gcry_err_source_t</code> component of the error value <var>err</var>.  This
function must be used to extract the error source from an error value in
order to compare it with the <code>GPG_ERR_SOURCE_*</code> error source macros.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferr_005fmake"></a><u>Function:</u> gcry_error_t <b>gcry_err_make</b><i> (gcry_err_source_t <var>source</var>, gcry_err_code_t <var>code</var>)</i></dt>
<dd><p>The static inline function <code>gcry_err_make</code> returns the error
value consisting of the error source <var>source</var> and the error code
<var>code</var>.
</p>
<p>This function can be used in callback functions to construct an error
value to return it to the library.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferror"></a><u>Function:</u> gcry_error_t <b>gcry_error</b><i> (gcry_err_code_t <var>code</var>)</i></dt>
<dd><p>The static inline function <code>gcry_error</code> returns the error value
consisting of the default error source and the error code <var>code</var>.
</p>
<p>For <acronym>GCRY</acronym> applications, the default error source is
<code>GPG_ERR_SOURCE_USER_1</code>.  You can define
<code>GCRY_ERR_SOURCE_DEFAULT</code> before including &lsquo;<tt>gcrypt.h</tt>&rsquo; to
change this default.
</p>
<p>This function can be used in callback functions to construct an error
value to return it to the library.
</p></dd></dl>

<p>The <code>libgpg-error</code> library provides error codes for all system
error numbers it knows about.  If <var>err</var> is an unknown error
number, the error code <code>GPG_ERR_UNKNOWN_ERRNO</code> is used.  The
following functions can be used to construct error values from system
errno numbers.
</p>
<dl>
<dt><a name="index-gcry_005ferr_005fmake_005ffrom_005ferrno"></a><u>Function:</u> gcry_error_t <b>gcry_err_make_from_errno</b><i> (gcry_err_source_t <var>source</var>, int <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_err_make_from_errno</code> is like
<code>gcry_err_make</code>, but it takes a system error like <code>errno</code>
instead of a <code>gcry_err_code_t</code> error code.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferror_005ffrom_005ferrno"></a><u>Function:</u> gcry_error_t <b>gcry_error_from_errno</b><i> (int <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_error_from_errno</code> is like <code>gcry_error</code>,
but it takes a system error like <code>errno</code> instead of a
<code>gcry_err_code_t</code> error code.
</p></dd></dl>

<p>Sometimes you might want to map system error numbers to error codes
directly, or map an error code representing a system error back to the
system error number.  The following functions can be used to do that.
</p>
<dl>
<dt><a name="index-gcry_005ferr_005fcode_005ffrom_005ferrno"></a><u>Function:</u> gcry_err_code_t <b>gcry_err_code_from_errno</b><i> (int <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_err_code_from_errno</code> returns the error code
for the system error <var>err</var>.  If <var>err</var> is not a known system
error, the function returns <code>GPG_ERR_UNKNOWN_ERRNO</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ferr_005fcode_005fto_005ferrno"></a><u>Function:</u> int <b>gcry_err_code_to_errno</b><i> (gcry_err_code_t <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_err_code_to_errno</code> returns the system error
for the error code <var>err</var>.  If <var>err</var> is not an error code
representing a system error, or if this system error is not defined on
this system, the function returns <code>0</code>.
</p></dd></dl>


<hr size="6">
<a name="Error-Sources"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-Values" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Codes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Handling" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-Sources-1"></a>
<h3 class="subsection">3.2.2 Error Sources</h3>
<a name="index-error-codes_002c-list-of"></a>

<p>The library <code>libgpg-error</code> defines an error source for every
component of the GnuPG system.  The error source part of an error
value is not well defined.  As such it is mainly useful to improve the
diagnostic error message for the user.
</p>
<p>If the error code part of an error value is <code>0</code>, the whole error
value will be <code>0</code>.  In this case the error source part is of
course <code>GPG_ERR_SOURCE_UNKNOWN</code>.
</p>
<p>The list of error sources that might occur in applications using
<acronym>Libgcrypt</acronym> is:
</p>
<dl compact="compact">
<dt> <code>GPG_ERR_SOURCE_UNKNOWN</code></dt>
<dd><p>The error source is not known.  The value of this error source is
<code>0</code>.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_GPGME</code></dt>
<dd><p>The error source is <acronym>GPGME</acronym> itself.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_GPG</code></dt>
<dd><p>The error source is GnuPG, which is the crypto engine used for the
OpenPGP protocol.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_GPGSM</code></dt>
<dd><p>The error source is GPGSM, which is the crypto engine used for the
OpenPGP protocol.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_GCRYPT</code></dt>
<dd><p>The error source is <code>libgcrypt</code>, which is used by crypto engines
to perform cryptographic operations.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_GPGAGENT</code></dt>
<dd><p>The error source is <code>gpg-agent</code>, which is used by crypto
engines to perform operations with the secret key.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_PINENTRY</code></dt>
<dd><p>The error source is <code>pinentry</code>, which is used by
<code>gpg-agent</code> to query the passphrase to unlock a secret key.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_SCD</code></dt>
<dd><p>The error source is the SmartCard Daemon, which is used by
<code>gpg-agent</code> to delegate operations with the secret key to a
SmartCard.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_KEYBOX</code></dt>
<dd><p>The error source is <code>libkbx</code>, a library used by the crypto
engines to manage local keyrings.
</p>
</dd>
<dt> <code>GPG_ERR_SOURCE_USER_1</code></dt>
<dt> <code>GPG_ERR_SOURCE_USER_2</code></dt>
<dt> <code>GPG_ERR_SOURCE_USER_3</code></dt>
<dt> <code>GPG_ERR_SOURCE_USER_4</code></dt>
<dd><p>These error sources are not used by any GnuPG component and can be
used by other software.  For example, applications using
Libgcrypt can use them to mark error values coming from callback
handlers.  Thus <code>GPG_ERR_SOURCE_USER_1</code> is the default for errors
created with <code>gcry_error</code> and <code>gcry_error_from_errno</code>,
unless you define <code>GCRY_ERR_SOURCE_DEFAULT</code> before including
&lsquo;<tt>gcrypt.h</tt>&rsquo;.
</p></dd>
</dl>


<hr size="6">
<a name="Error-Codes"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-Sources" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Strings" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Handling" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-Codes-1"></a>
<h3 class="subsection">3.2.3 Error Codes</h3>
<a name="index-error-codes_002c-list-of-1"></a>

<p>The library <code>libgpg-error</code> defines many error values.  The
following list includes the most important error codes.
</p>
<dl compact="compact">
<dt> <code>GPG_ERR_EOF</code></dt>
<dd><p>This value indicates the end of a list, buffer or file.
</p>
</dd>
<dt> <code>GPG_ERR_NO_ERROR</code></dt>
<dd><p>This value indicates success.  The value of this error code is
<code>0</code>.  Also, it is guaranteed that an error value made from the
error code <code>0</code> will be <code>0</code> itself (as a whole).  This means
that the error source information is lost for this error code,
however, as this error code indicates that no error occurred, this is
generally not a problem.
</p>
</dd>
<dt> <code>GPG_ERR_GENERAL</code></dt>
<dd><p>This value means that something went wrong, but either there is not
enough information about the problem to return a more useful error
value, or there is no separate error value for this type of problem.
</p>
</dd>
<dt> <code>GPG_ERR_ENOMEM</code></dt>
<dd><p>This value means that an out-of-memory condition occurred.
</p>
</dd>
<dt> <code>GPG_ERR_E...</code></dt>
<dd><p>System errors are mapped to GPG_ERR_EFOO where FOO is the symbol for
the system error.
</p>
</dd>
<dt> <code>GPG_ERR_INV_VALUE</code></dt>
<dd><p>This value means that some user provided data was out of range.
</p>
</dd>
<dt> <code>GPG_ERR_UNUSABLE_PUBKEY</code></dt>
<dd><p>This value means that some recipients for a message were invalid.
</p>
</dd>
<dt> <code>GPG_ERR_UNUSABLE_SECKEY</code></dt>
<dd><p>This value means that some signers were invalid.
</p>
</dd>
<dt> <code>GPG_ERR_NO_DATA</code></dt>
<dd><p>This value means that data was expected where no data was found.
</p>
</dd>
<dt> <code>GPG_ERR_CONFLICT</code></dt>
<dd><p>This value means that a conflict of some sort occurred.
</p>
</dd>
<dt> <code>GPG_ERR_NOT_IMPLEMENTED</code></dt>
<dd><p>This value indicates that the specific function (or operation) is not
implemented.  This error should never happen.  It can only occur if
you use certain values or configuration options which do not work,
but for which we think that they should work at some later time.
</p>
</dd>
<dt> <code>GPG_ERR_DECRYPT_FAILED</code></dt>
<dd><p>This value indicates that a decryption operation was unsuccessful.
</p>
</dd>
<dt> <code>GPG_ERR_WRONG_KEY_USAGE</code></dt>
<dd><p>This value indicates that a key is not used appropriately.
</p>
</dd>
<dt> <code>GPG_ERR_NO_SECKEY</code></dt>
<dd><p>This value indicates that no secret key for the user ID is available.
</p>
</dd>
<dt> <code>GPG_ERR_UNSUPPORTED_ALGORITHM</code></dt>
<dd><p>This value means a verification failed because the cryptographic
algorithm is not supported by the crypto backend.
</p>
</dd>
<dt> <code>GPG_ERR_BAD_SIGNATURE</code></dt>
<dd><p>This value means a verification failed because the signature is bad.
</p>
</dd>
<dt> <code>GPG_ERR_NO_PUBKEY</code></dt>
<dd><p>This value means a verification failed because the public key is not
available.
</p>
</dd>
<dt> <code>GPG_ERR_NOT_OPERATIONAL</code></dt>
<dd><p>This value means that the library is not yet in state which allows to
use this function.  This error code is in particular returned if
Libgcrypt is operated in FIPS mode and the internal state of the
library does not yet or not anymore allow the use of a service.
</p>
<p>This error code is only available with newer libgpg-error versions, thus
you might see &ldquo;invalid error code&rdquo; when passing this to
<code>gpg_strerror</code>.  The numeric value of this error code is 176.
</p>
</dd>
<dt> <code>GPG_ERR_USER_1</code></dt>
<dt> <code>GPG_ERR_USER_2</code></dt>
<dt> <code>...</code></dt>
<dt> <code>GPG_ERR_USER_16</code></dt>
<dd><p>These error codes are not used by any GnuPG component and can be
freely used by other software.  Applications using Libgcrypt
might use them to mark specific errors returned by callback handlers
if no suitable error codes (including the system errors) for these
errors exist already.
</p></dd>
</dl>


<hr size="6">
<a name="Error-Strings"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-Codes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-Handling" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-Strings-1"></a>
<h3 class="subsection">3.2.4 Error Strings</h3>
<a name="index-error-values_002c-printing-of"></a>
<a name="index-error-codes_002c-printing-of"></a>
<a name="index-error-sources_002c-printing-of"></a>
<a name="index-error-strings"></a>

<dl>
<dt><a name="index-gcry_005fstrerror"></a><u>Function:</u> const char * <b>gcry_strerror</b><i> (gcry_error_t <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_strerror</code> returns a pointer to a statically
allocated string containing a description of the error code contained
in the error value <var>err</var>.  This string can be used to output a
diagnostic message to the user.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fstrsource"></a><u>Function:</u> const char * <b>gcry_strsource</b><i> (gcry_error_t <var>err</var>)</i></dt>
<dd><p>The function <code>gcry_strsource</code> returns a pointer to a statically
allocated string containing a description of the error source
contained in the error value <var>err</var>.  This string can be used to
output a diagnostic message to the user.
</p></dd></dl>

<p>The following example illustrates the use of the functions described
above:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">{
  gcry_cipher_hd_t handle;
  gcry_error_t err = 0;

  err = gcry_cipher_open (&amp;handle, GCRY_CIPHER_AES,
                          GCRY_CIPHER_MODE_CBC, 0);
  if (err)
    {
      fprintf (stderr, &quot;Failure: %s/%s\n&quot;,
               gcry_strsource (err),
               gcry_strerror (err));
    }
}
</pre></td></tr></table>

<hr size="6">
<a name="Handler-Functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-Strings" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Progress-handler" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Generalities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Handler-Functions-1"></a>
<h1 class="chapter">4. Handler Functions</h1>

<p>Libgcrypt makes it possible to install so called &lsquo;handler functions&rsquo;,
which get called by Libgcrypt in case of certain events.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Progress-handler">4.1 Progress handler</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Using a progress handler function.
</td></tr>
<tr><td align="left" valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Using special memory allocation functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Error-handler">4.3 Error handler</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Using error handler functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Logging-handler">4.4 Logging handler</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Using a special logging function.
</td></tr>
</table>

<hr size="6">
<a name="Progress-handler"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Handler-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Allocation-handler" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Progress-handler-1"></a>
<h2 class="section">4.1 Progress handler</h2>

<p>It is often useful to retrieve some feedback while long running
operations are performed.
</p>
<dl>
<dt><a name="index-gcry_005fhandler_005fprogress_005ft"></a><u>Data type:</u> <b>gcry_handler_progress_t</b></dt>
<dd><p>Progress handler functions have to be of the type
<code>gcry_handler_progress_t</code>, which is defined as:
</p>
<p><code>void (*gcry_handler_progress_t) (void *, const char *, int, int, int)</code>
</p></dd></dl>

<p>The following function may be used to register a handler function for
this purpose.
</p>
<dl>
<dt><a name="index-gcry_005fset_005fprogress_005fhandler"></a><u>Function:</u> void <b>gcry_set_progress_handler</b><i> (gcry_handler_progress_t <var>cb</var>, void *<var>cb_data</var>)</i></dt>
<dd>
<p>This function installs <var>cb</var> as the &lsquo;Progress handler&rsquo; function.
It may be used only during initialization.  <var>cb</var> must be defined
as follows:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">void
my_progress_handler (void *<var>cb_data</var>, const char *<var>what</var>,
                     int <var>printchar</var>, int <var>current</var>, int <var>total</var>)
{
  /* Do something.  */
}
</pre></td></tr></table>

<p>A description of the arguments of the progress handler function follows.
</p>
<dl compact="compact">
<dt> <var>cb_data</var></dt>
<dd><p>The argument provided in the call to <code>gcry_set_progress_handler</code>.
</p></dd>
<dt> <var>what</var></dt>
<dd><p>A string identifying the type of the progress output.  The following
values for <var>what</var> are defined:
</p>
<dl compact="compact">
<dt> <code>need_entropy</code></dt>
<dd><p>Not enough entropy is available.  <var>total</var> holds the number of
required bytes.
</p>
</dd>
<dt> <code>wait_dev_random</code></dt>
<dd><p>Waiting to re-open a random device.  <var>total</var> gives the number of
seconds until the next try.
</p>
</dd>
<dt> <code>primegen</code></dt>
<dd><p>Values for <var>printchar</var>:
</p><dl compact="compact">
<dt> <code>\n</code></dt>
<dd><p>Prime generated.
</p></dd>
<dt> <code>!</code></dt>
<dd><p>Need to refresh the pool of prime numbers.
</p></dd>
<dt> <code>&lt;, &gt;</code></dt>
<dd><p>Number of bits adjusted.
</p></dd>
<dt> <code>^</code></dt>
<dd><p>Searching for a generator.
</p></dd>
<dt> <code>.</code></dt>
<dd><p>Fermat test on 10 candidates failed.
</p></dd>
<dt> <code>:</code></dt>
<dd><p>Restart with a new random value.
</p></dd>
<dt> <code>+</code></dt>
<dd><p>Rabin-Miller test passed.
</p></dd>
</dl>

</dd>
</dl>

</dd>
</dl>
</dd></dl>

<hr size="6">
<a name="Allocation-handler"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Progress-handler" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Error-handler" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Allocation-handler-1"></a>
<h2 class="section">4.2 Allocation handler</h2>

<p>It is possible to make Libgcrypt use special memory
allocation functions instead of the built-in ones.
</p>
<p>Memory allocation functions are of the following types:
</p><dl>
<dt><a name="index-gcry_005fhandler_005falloc_005ft"></a><u>Data type:</u> <b>gcry_handler_alloc_t</b></dt>
<dd><p>This type is defined as: <code>void *(*gcry_handler_alloc_t) (size_t n)</code>.
</p></dd></dl>
<dl>
<dt><a name="index-gcry_005fhandler_005fsecure_005fcheck_005ft"></a><u>Data type:</u> <b>gcry_handler_secure_check_t</b></dt>
<dd><p>This type is defined as: <code>int *(*gcry_handler_secure_check_t) (const void *)</code>.
</p></dd></dl>
<dl>
<dt><a name="index-gcry_005fhandler_005frealloc_005ft"></a><u>Data type:</u> <b>gcry_handler_realloc_t</b></dt>
<dd><p>This type is defined as: <code>void *(*gcry_handler_realloc_t) (void *p, size_t n)</code>.
</p></dd></dl>
<dl>
<dt><a name="index-gcry_005fhandler_005ffree_005ft"></a><u>Data type:</u> <b>gcry_handler_free_t</b></dt>
<dd><p>This type is defined as: <code>void *(*gcry_handler_free_t) (void *)</code>.
</p></dd></dl>

<p>Special memory allocation functions can be installed with the
following function:
</p>
<dl>
<dt><a name="index-gcry_005fset_005fallocation_005fhandler"></a><u>Function:</u> void <b>gcry_set_allocation_handler</b><i> (gcry_handler_alloc_t <var>func_alloc</var>, gcry_handler_alloc_t <var>func_alloc_secure</var>, gcry_handler_secure_check_t <var>func_secure_check</var>, gcry_handler_realloc_t <var>func_realloc</var>, gcry_handler_free_t <var>func_free</var>)</i></dt>
<dd><p>Install the provided functions and use them instead of the built-in
functions for doing memory allocation.  Using this function is in
general not recommended because the standard Libgcrypt allocation
functions are guaranteed to zeroize memory if needed.
</p>
<p>This function may be used only during initialization and may not be
used in FIPS mode.
</p>

</dd></dl>

<hr size="6">
<a name="Error-handler"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Allocation-handler" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Logging-handler" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Error-handler-1"></a>
<h2 class="section">4.3 Error handler</h2>

<p>The following functions may be used to register handler functions that
are called by Libgcrypt in case certain error conditions occur.  They
may and should be registered prior to calling <code>gcry_check_version</code>.
</p>
<dl>
<dt><a name="index-gcry_005fhandler_005fno_005fmem_005ft"></a><u>Data type:</u> <b>gcry_handler_no_mem_t</b></dt>
<dd><p>This type is defined as: <code>int (*gcry_handler_no_mem_t) (void *, size_t, unsigned int)</code>
</p></dd></dl>
<dl>
<dt><a name="index-gcry_005fset_005foutofcore_005fhandler"></a><u>Function:</u> void <b>gcry_set_outofcore_handler</b><i> (gcry_handler_no_mem_t <var>func_no_mem</var>, void *<var>cb_data</var>)</i></dt>
<dd><p>This function registers <var>func_no_mem</var> as &lsquo;out-of-core handler&rsquo;,
which means that it will be called in the case of not having enough
memory available.  The handler is called with 3 arguments: The first
one is the pointer <var>cb_data</var> as set with this function, the second
is the requested memory size and the last being a flag.  If bit 0 of
the flag is set, secure memory has been requested.  The handler should
either return true to indicate that Libgcrypt should try again
allocating memory or return false to let Libgcrypt use its default
fatal error handler.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fhandler_005ferror_005ft"></a><u>Data type:</u> <b>gcry_handler_error_t</b></dt>
<dd><p>This type is defined as: <code>void (*gcry_handler_error_t) (void *, int, const char *)</code>
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fset_005ffatalerror_005fhandler"></a><u>Function:</u> void <b>gcry_set_fatalerror_handler</b><i> (gcry_handler_error_t <var>func_error</var>, void *<var>cb_data</var>)</i></dt>
<dd><p>This function registers <var>func_error</var> as &lsquo;error handler&rsquo;,
which means that it will be called in error conditions.
</p></dd></dl>

<hr size="6">
<a name="Logging-handler"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Error-handler" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Logging-handler-1"></a>
<h2 class="section">4.4 Logging handler</h2>

<dl>
<dt><a name="index-gcry_005fhandler_005flog_005ft"></a><u>Data type:</u> <b>gcry_handler_log_t</b></dt>
<dd><p>This type is defined as: <code>void (*gcry_handler_log_t) (void *, int, const char *, va_list)</code>
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fset_005flog_005fhandler"></a><u>Function:</u> void <b>gcry_set_log_handler</b><i> (gcry_handler_log_t <var>func_log</var>, void *<var>cb_data</var>)</i></dt>
<dd><p>This function registers <var>func_log</var> as &lsquo;logging handler&rsquo;, which means
that it will be called in case Libgcrypt wants to log a message.  This
function may and should be used prior to calling
<code>gcry_check_version</code>.
</p></dd></dl>

<hr size="6">
<a name="Symmetric-cryptography"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Logging-handler" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Available-ciphers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Handler-Functions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Symmetric-cryptography-1"></a>
<h1 class="chapter">5. Symmetric cryptography</h1>

<p>The cipher functions are used for symmetrical cryptography,
i.e. cryptography using a shared key.  The programming model follows
an open/process/close paradigm and is in that similar to other
building blocks provided by Libgcrypt.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           List of ciphers supported by the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      List of cipher modes supported by the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  How to perform operations related to cipher handles.
</td></tr>
<tr><td align="left" valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    General cipher functions independent of cipher handles.
</td></tr>
</table>

<hr size="6">
<a name="Available-ciphers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Available-cipher-modes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Available-ciphers-1"></a>
<h2 class="section">5.1 Available ciphers</h2>

<dl compact="compact">
<dt> <code>GCRY_CIPHER_NONE</code></dt>
<dd><p>This is not a real algorithm but used by some functions as error return.
The value always evaluates to false.
</p>
</dd>
<dt> <code>GCRY_CIPHER_IDEA</code></dt>
<dd><a name="index-IDEA"></a>
<p>This is the IDEA algorithm.
</p>
</dd>
<dt> <code>GCRY_CIPHER_3DES</code></dt>
<dd><a name="index-3DES"></a>
<a name="index-Triple_002dDES"></a>
<a name="index-DES_002dEDE"></a>
<a name="index-Digital-Encryption-Standard"></a>
<p>Triple-DES with 3 keys as EDE.  The key size of this algorithm is 168 bits but
you have to pass 192 bits because the most significant bits of each byte
are ignored.
</p>
</dd>
<dt> <code>GCRY_CIPHER_CAST5</code></dt>
<dd><a name="index-CAST5"></a>
<p>CAST128-5 block cipher algorithm.  The key size is 128 bits.
</p>
</dd>
<dt> <code>GCRY_CIPHER_BLOWFISH</code></dt>
<dd><a name="index-Blowfish"></a>
<p>The blowfish algorithm. The supported key sizes are 8 to 576 bits in
8 bit increments.
</p>
</dd>
<dt> <code>GCRY_CIPHER_SAFER_SK128</code></dt>
<dd><p>Reserved and not currently implemented.
</p>
</dd>
<dt> <code>GCRY_CIPHER_DES_SK</code></dt>
<dd><p>Reserved and not currently implemented.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_AES</code></dt>
<dt> <code>GCRY_CIPHER_AES128</code></dt>
<dt> <code>GCRY_CIPHER_RIJNDAEL</code></dt>
<dt> <code>GCRY_CIPHER_RIJNDAEL128</code></dt>
<dd><a name="index-Rijndael"></a>
<a name="index-AES"></a>
<a name="index-Advanced-Encryption-Standard"></a>
<p>AES (Rijndael) with a 128 bit key.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_AES192</code></dt>
<dt> <code>GCRY_CIPHER_RIJNDAEL192</code></dt>
<dd><p>AES (Rijndael) with a 192 bit key.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_AES256</code></dt>
<dt> <code>GCRY_CIPHER_RIJNDAEL256</code></dt>
<dd><p>AES (Rijndael) with a 256 bit key.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_TWOFISH</code></dt>
<dd><a name="index-Twofish"></a>
<p>The Twofish algorithm with a 256 bit key.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_TWOFISH128</code></dt>
<dd><p>The Twofish algorithm with a 128 bit key.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_ARCFOUR</code></dt>
<dd><a name="index-Arcfour"></a>
<a name="index-RC4"></a>
<p>An algorithm which is 100% compatible with RSA Inc.&rsquo;s RC4 algorithm.
Note that this is a stream cipher and must be used very carefully to
avoid a couple of weaknesses.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_DES</code></dt>
<dd><a name="index-DES"></a>
<p>Standard DES with a 56 bit key. You need to pass 64 bits but the high
bits of each byte are ignored.  Note, that this is a weak algorithm
which can be broken in reasonable time using a brute force approach.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_SERPENT128</code></dt>
<dt> <code>GCRY_CIPHER_SERPENT192</code></dt>
<dt> <code>GCRY_CIPHER_SERPENT256</code></dt>
<dd><a name="index-Serpent"></a>
<p>The Serpent cipher from the AES contest.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_RFC2268_40</code></dt>
<dt> <code>GCRY_CIPHER_RFC2268_128</code></dt>
<dd><a name="index-rfc_002d2268"></a>
<a name="index-RC2"></a>
<p>Ron&rsquo;s Cipher 2 in the 40 and 128 bit variants.
</p>
</dd>
<dt> <code>GCRY_CIPHER_SEED</code></dt>
<dd><a name="index-Seed-_0028cipher_0029"></a>
<p>A 128 bit cipher as described by RFC4269.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_CAMELLIA128</code></dt>
<dt> <code>GCRY_CIPHER_CAMELLIA192</code></dt>
<dt> <code>GCRY_CIPHER_CAMELLIA256</code></dt>
<dd><a name="index-Camellia"></a>
<p>The Camellia cipher by NTT.  See
<a href="http://info.isl.ntt.co.jp/crypt/eng/camellia/specifications.html">http://info.isl.ntt.co.jp/crypt/eng/camellia/specifications.html</a>.
</p>
</dd>
<dt> <code>GCRY_CIPHER_SALSA20</code></dt>
<dd><a name="index-Salsa20"></a>
<p>This is the Salsa20 stream cipher.
</p>
</dd>
<dt> <code>GCRY_CIPHER_SALSA20R12</code></dt>
<dd><a name="index-Salsa20_002f12"></a>
<p>This is the Salsa20/12 - reduced round version of Salsa20 stream cipher.
</p>
</dd>
<dt> <code>GCRY_CIPHER_GOST28147</code></dt>
<dd><a name="index-GOST-28147_002d89"></a>
<p>The GOST 28147-89 cipher, defined in the respective GOST standard.
Translation of this GOST into English is provided in the RFC-5830.
</p>
</dd>
<dt> <code>GCRY_CIPHER_GOST28147_MESH</code></dt>
<dd><a name="index-GOST-28147_002d89-CryptoPro-keymeshing"></a>
<p>The GOST 28147-89 cipher, defined in the respective GOST standard.
Translation of this GOST into English is provided in the RFC-5830.
This cipher will use CryptoPro keymeshing as defined in RFC 4357
if it has to be used for the selected parameter set.
</p>
</dd>
<dt> <code>GCRY_CIPHER_CHACHA20</code></dt>
<dd><a name="index-ChaCha20"></a>
<p>This is the ChaCha20 stream cipher.
</p>
</dd>
<dt> <code>GCRY_CIPHER_SM4</code></dt>
<dd><a name="index-SM4-_0028cipher_0029"></a>
<p>A 128 bit cipher by the State Cryptography Administration
of China (SCA).  See
<a href="https://tools.ietf.org/html/draft-ribose-cfrg-sm4-10">https://tools.ietf.org/html/draft-ribose-cfrg-sm4-10</a>.
</p>
</dd>
</dl>

<hr size="6">
<a name="Available-cipher-modes"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Available-ciphers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Working-with-cipher-handles" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Available-cipher-modes-1"></a>
<h2 class="section">5.2 Available cipher modes</h2>

<dl compact="compact">
<dt> <code>GCRY_CIPHER_MODE_NONE</code></dt>
<dd><p>No mode specified.  This should not be used.  The only exception is that
if Libgcrypt is not used in FIPS mode and if any debug flag has been
set, this mode may be used to bypass the actual encryption.
</p>
</dd>
<dt> <code>GCRY_CIPHER_MODE_ECB</code></dt>
<dd><a name="index-ECB_002c-Electronic-Codebook-mode"></a>
<p>Electronic Codebook mode.
</p>
</dd>
<dt> <code>GCRY_CIPHER_MODE_CFB</code></dt>
<dt> <code>GCRY_CIPHER_MODE_CFB8</code></dt>
<dd><a name="index-CFB_002c-Cipher-Feedback-mode"></a>
<p>Cipher Feedback mode.  For <code>GCRY_CIPHER_MODE_CFB</code> the shift size equals
the block size of the cipher (e.g. for AES it is CFB-128).  For
<code>GCRY_CIPHER_MODE_CFB8</code> the shift size is 8 bits but that variant is not
yet available.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_CBC</code></dt>
<dd><a name="index-CBC_002c-Cipher-Block-Chaining-mode"></a>
<p>Cipher Block Chaining mode.
</p>
</dd>
<dt> <code>GCRY_CIPHER_MODE_STREAM</code></dt>
<dd><p>Stream mode, only to be used with stream cipher algorithms.
</p>
</dd>
<dt> <code>GCRY_CIPHER_MODE_OFB</code></dt>
<dd><a name="index-OFB_002c-Output-Feedback-mode"></a>
<p>Output Feedback mode.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_CTR</code></dt>
<dd><a name="index-CTR_002c-Counter-mode"></a>
<p>Counter mode.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_AESWRAP</code></dt>
<dd><a name="index-AES_002dWrap-mode"></a>
<p>This mode is used to implement the AES-Wrap algorithm according to
RFC-3394.  It may be used with any 128 bit block length algorithm,
however the specs require one of the 3 AES algorithms.  These special
conditions apply: If <code>gcry_cipher_setiv</code> has not been used, the
standard IV is used; if it has been used, the lower 64 bits of the IV
are used as the Alternative Initial Value.  On encryption the provided
output buffer must be 64 bits (8 bytes) larger than the input buffer;
in-place encryption is still allowed.  On decryption the output buffer
may be specified 64 bits (8 bytes) shorter than then input buffer.  As
per specs the input length must be at least 128 bits and the length
must be a multiple of 64 bits.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_CCM</code></dt>
<dd><a name="index-CCM_002c-Counter-with-CBC_002dMAC-mode"></a>
<p>Counter with CBC-MAC mode is an Authenticated Encryption with
Associated Data (AEAD) block cipher mode, which is specified in
&rsquo;NIST Special Publication 800-38C&rsquo; and RFC 3610.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_GCM</code></dt>
<dd><a name="index-GCM_002c-Galois_002fCounter-Mode"></a>
<p>Galois/Counter Mode (GCM) is an Authenticated Encryption with
Associated Data (AEAD) block cipher mode, which is specified in
&rsquo;NIST Special Publication 800-38D&rsquo;.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_POLY1305</code></dt>
<dd><a name="index-Poly1305-based-AEAD-mode-with-ChaCha20"></a>
<p>This mode implements the Poly1305 Authenticated Encryption with Associated
Data (AEAD) mode according to RFC-8439. This mode can be used with ChaCha20
stream cipher.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_OCB</code></dt>
<dd><a name="index-OCB_002c-OCB3"></a>
<p>OCB is an Authenticated Encryption with Associated Data (AEAD) block
cipher mode, which is specified in RFC-7253.  Supported tag lengths
are 128, 96, and 64 bits with the default being 128 bits.  To switch to
a different tag length, <code>gcry_cipher_ctl</code> using the command
<code>GCRYCTL_SET_TAGLEN</code> and the address of an <code>int</code> variable
set to 12 (for 96 bits) or 8 (for 64 bits) provided for the
<code>buffer</code> argument and <code>sizeof(int)</code> for <code>buflen</code>.
</p>
<p>Note that the use of <code>gcry_cipher_final</code> is required.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_XTS</code></dt>
<dd><a name="index-XTS_002c-XTS-mode"></a>
<p>XEX-based tweaked-codebook mode with ciphertext stealing (XTS) mode
is used to implement the AES-XTS as specified in IEEE 1619 Standard
Architecture for Encrypted Shared Storage Media and NIST SP800-38E.
</p>
<p>The XTS mode requires doubling key-length, for example, using 512-bit
key with AES-256 (<code>GCRY_CIPHER_AES256</code>). The 128-bit tweak value
is feed to XTS mode as little-endian byte array using
<code>gcry_cipher_setiv</code> function. When encrypting or decrypting,
full-sized data unit buffers needs to be passed to
<code>gcry_cipher_encrypt</code> or <code>gcry_cipher_decrypt</code>. The tweak
value is automatically incremented after each call of
<code>gcry_cipher_encrypt</code> and <code>gcry_cipher_decrypt</code>.
Auto-increment allows avoiding need of setting IV between processing
of sequential data units.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_EAX</code></dt>
<dd><a name="index-EAX_002c-EAX-mode"></a>
<p>EAX is an Authenticated Encryption with Associated Data (AEAD) block cipher
mode by Bellare, Rogaway, and Wagner (see
<a href="http://web.cs.ucdavis.edu/~rogaway/papers/eax.html">http://web.cs.ucdavis.edu/~rogaway/papers/eax.html</a>).
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_SIV</code></dt>
<dd><a name="index-SIV_002c-SIV-mode"></a>
<p>Synthetic Initialization Vector (SIV) is an Authenticated Encryption
with Associated Data (AEAD) block cipher mode, which is specified in
RFC-5297.  This mode works with block ciphers with block size of 128
bits and uses tag length of 128 bits.  Depending on how it is used,
SIV achieves either the goal of deterministic authenticated encryption
or the goal of nonce-based, misuse-resistant authenticated encryption.
</p>
<p>The SIV mode requires doubling key-length, for example, using 512-bit
key with AES-256 (<code>GCRY_CIPHER_AES256</code>). Multiple AD instances can
be passed to SIV mode with separate calls to
<code>gcry_cipher_authenticate</code>. Nonce may be passed either through
<code>gcry_cipher_setiv</code> or in the last call to
<code>gcry_cipher_authenticate</code>. Note that use of <code>gcry_cipher_setiv</code>
blocks any further calls to <code>gcry_cipher_authenticate</code> as nonce needs
to be the last AD element with the SIV mode. When encrypting or decrypting,
full-sized plaintext or ciphertext needs to be passed to
<code>gcry_cipher_encrypt</code> or <code>gcry_cipher_decrypt</code>. Decryption tag
needs to be given to SIV mode before decryption using
<code>gcry_cipher_set_decryption_tag</code>.
</p>
</dd>
<dt>  <code>GCRY_CIPHER_MODE_GCM_SIV</code></dt>
<dd><a name="index-GCM_002dSIV_002c-GCM_002dSIV-mode_002c-AES_002dGCM_002dSIV"></a>
<p>This mode implements is GCM-SIV Authenticated Encryption with
Associated Data (AEAD) block cipher mode specified in RFC-5297
(AES-GCM-SIV: Nonce Misuse-Resistant Authenticated Encryption).
This implementations works with block ciphers with block size of
128 bits and uses tag length of 128 bits.  Supported key lengths
by the mode are 128 bits and 256 bits. GCM-SIV is specified as
nonce misuse resistant, so that it does not fail catastrophically
if a nonce is repeated.
</p>
<p>When encrypting or decrypting, full-sized plaintext or ciphertext
needs to be passed to <code>gcry_cipher_encrypt</code> or
<code>gcry_cipher_decrypt</code>. Decryption tag needs to be given to
GCM-SIV mode before decryption using <code>gcry_cipher_set_decryption_tag</code>.
</p>
</dd>
</dl>

<hr size="6">
<a name="Working-with-cipher-handles"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Available-cipher-modes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-cipher-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Working-with-cipher-handles-1"></a>
<h2 class="section">5.3 Working with cipher handles</h2>

<p>To use a cipher algorithm, you must first allocate an according
handle.  This is to be done using the open function:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fopen"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_open</b><i> (gcry_cipher_hd_t *<var>hd</var>, int <var>algo</var>, int <var>mode</var>, unsigned int <var>flags</var>)</i></dt>
<dd>
<p>This function creates the context handle required for most of the
other cipher functions and returns a handle to it in &lsquo;hd&rsquo;.  In case of
an error, an according error code is returned.
</p>
<p>The ID of algorithm to use must be specified via <var>algo</var>.  See
<a href="#Available-ciphers">Available ciphers</a> for a list of supported ciphers and the
according constants.
</p>
<p>Besides using the constants directly, the function
<code>gcry_cipher_map_name</code> may be used to convert the textual name of
an algorithm into the according numeric ID.
</p>
<p>The cipher mode to use must be specified via <var>mode</var>.  See
<a href="#Available-cipher-modes">Available cipher modes</a> for a list of supported cipher modes
and the according constants.  Note that some modes are incompatible
with some algorithms - in particular, stream mode
(<code>GCRY_CIPHER_MODE_STREAM</code>) only works with stream ciphers.
Poly1305 AEAD mode (<code>GCRY_CIPHER_MODE_POLY1305</code>) only works with
ChaCha20 stream cipher. The block cipher modes
(<code>GCRY_CIPHER_MODE_ECB</code>, <code>GCRY_CIPHER_MODE_CBC</code>,
<code>GCRY_CIPHER_MODE_CFB</code>, <code>GCRY_CIPHER_MODE_OFB</code>,
<code>GCRY_CIPHER_MODE_CTR</code> and <code>GCRY_CIPHER_MODE_EAX</code>) will work
with any block cipher algorithm.  GCM mode
(<code>GCRY_CIPHER_MODE_GCM</code>), CCM mode (<code>GCRY_CIPHER_MODE_CCM</code>),
OCB mode (<code>GCRY_CIPHER_MODE_OCB</code>), XTS mode
(<code>GCRY_CIPHER_MODE_XTS</code>), SIV mode
(<code>GCRY_CIPHER_MODE_SIV</code>) and GCM-SIV mode
(<code>GCRY_CIPHER_MODE_GCM_SIV</code>) will only work with block cipher
algorithms which have the block size of 16 bytes.
</p>
<p>The third argument <var>flags</var> can either be passed as <code>0</code> or as
the bit-wise OR of the following constants.
</p>
<dl compact="compact">
<dt> <code>GCRY_CIPHER_SECURE</code></dt>
<dd><p>Make sure that all operations are allocated in secure memory.  This is
useful when the key material is highly confidential.
</p></dd>
<dt> <code>GCRY_CIPHER_ENABLE_SYNC</code></dt>
<dd><a name="index-sync-mode-_0028OpenPGP_0029"></a>
<p>This flag enables the CFB sync mode, which is a special feature of
Libgcrypt&rsquo;s CFB mode implementation to allow for OpenPGP&rsquo;s CFB variant.
See <code>gcry_cipher_sync</code>.
</p></dd>
<dt> <code>GCRY_CIPHER_CBC_CTS</code></dt>
<dd><a name="index-cipher-text-stealing"></a>
<p>Enable cipher text stealing (CTS) for the CBC mode.  Cannot be used
simultaneously with GCRY_CIPHER_CBC_MAC.  CTS mode makes it possible to
transform data of almost arbitrary size (only limitation is that it
must be greater than the algorithm&rsquo;s block size).
</p></dd>
<dt> <code>GCRY_CIPHER_CBC_MAC</code></dt>
<dd><a name="index-CBC_002dMAC"></a>
<p>Compute CBC-MAC keyed checksums.  This is the same as CBC mode, but
only output the last block.  Cannot be used simultaneously with
GCRY_CIPHER_CBC_CTS.
</p></dd>
</dl>
</dd></dl>

<p>Use the following function to release an existing handle:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fclose"></a><u>Function:</u> void <b>gcry_cipher_close</b><i> (gcry_cipher_hd_t <var>h</var>)</i></dt>
<dd>
<p>This function releases the context created by <code>gcry_cipher_open</code>.
It also zeroises all sensitive information associated with this cipher
handle.
</p></dd></dl>

<p>In order to use a handle for performing cryptographic operations, a
&lsquo;key&rsquo; has to be set first:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fsetkey"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_setkey</b><i> (gcry_cipher_hd_t <var>h</var>, const void *<var>k</var>, size_t <var>l</var>)</i></dt>
<dd>
<p>Set the key <var>k</var> used for encryption or decryption in the context
denoted by the handle <var>h</var>.  The length <var>l</var> (in bytes) of the
key <var>k</var> must match the required length of the algorithm set for
this context or be in the allowed range for algorithms with variable
key size.  The function checks this and returns an error if there is a
problem.  A caller should always check for an error.
</p>
</dd></dl>

<p>Most crypto modes requires an initialization vector (IV), which
usually is a non-secret random string acting as a kind of salt value.
The CTR mode requires a counter, which is also similar to a salt
value.  To set the IV or CTR, use these functions:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fsetiv"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_setiv</b><i> (gcry_cipher_hd_t <var>h</var>, const void *<var>k</var>, size_t <var>l</var>)</i></dt>
<dd>
<p>Set the initialization vector used for encryption or decryption. The
vector is passed as the buffer <var>K</var> of length <var>l</var> bytes and
copied to internal data structures.  The function checks that the IV
matches the requirement of the selected algorithm and mode.
</p>
<p>This function is also used by AEAD modes and with Salsa20 and ChaCha20
stream ciphers to set or update the required nonce.  In these cases it
needs to be called after setting the key.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fsetctr"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_setctr</b><i> (gcry_cipher_hd_t <var>h</var>, const void *<var>c</var>, size_t <var>l</var>)</i></dt>
<dd>
<p>Set the counter vector used for encryption or decryption. The counter
is passed as the buffer <var>c</var> of length <var>l</var> bytes and copied to
internal data structures.  The function checks that the counter
matches the requirement of the selected algorithm (i.e., it must have
the same size as the block size).
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005freset"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_reset</b><i> (gcry_cipher_hd_t <var>h</var>)</i></dt>
<dd>
<p>Set the given handle&rsquo;s context back to the state it had after the last
call to <code>gcry_cipher_setkey</code> and clear the initialization vector.
</p>
<p>Note that <code>gcry_cipher_reset</code> is implemented as a macro.
</p></dd></dl>

<p>Authenticated Encryption with Associated Data (AEAD) block cipher
modes require the handling of the authentication tag and the additional
authenticated data, which can be done by using the following
functions:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fauthenticate"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_authenticate</b><i> (gcry_cipher_hd_t <var>h</var>, const void *<var>abuf</var>, size_t <var>abuflen</var>)</i></dt>
<dd>
<p>Process the buffer <var>abuf</var> of length <var>abuflen</var> as the additional
authenticated data (AAD) for AEAD cipher modes.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fgettag"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_gettag</b><i>             (gcry_cipher_hd_t <var>h</var>,             void *<var>tag</var>, size_t <var>taglen</var>)</i></dt>
<dd>
<p>This function is used to read the authentication tag after encryption.
The function finalizes and outputs the authentication tag to the buffer
<var>tag</var> of length <var>taglen</var> bytes.
</p>
<p>Depending on the used mode certain restrictions for <var>taglen</var> are
enforced:  For GCM <var>taglen</var> must be at least 16 or one of the
allowed truncated lengths (4, 8, 12, 13, 14, or 15).
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fchecktag"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_checktag</b><i>             (gcry_cipher_hd_t <var>h</var>,             const void *<var>tag</var>, size_t <var>taglen</var>)</i></dt>
<dd>
<p>Check the authentication tag after decryption. The authentication
tag is passed as the buffer <var>tag</var> of length <var>taglen</var> bytes
and compared to internal authentication tag computed during
decryption.  Error code <code>GPG_ERR_CHECKSUM</code> is returned if
the authentication tag in the buffer <var>tag</var> does not match
the authentication tag calculated during decryption.
</p>
<p>Depending on the used mode certain restrictions for <var>taglen</var> are
enforced: For GCM <var>taglen</var> must either be 16 or one of the allowed
truncated lengths (4, 8, 12, 13, 14, or 15).
</p>
</dd></dl>

<p>The actual encryption and decryption is done by using one of the
following functions.  They may be used as often as required to process
all the data.
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fencrypt"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_encrypt</b><i> (gcry_cipher_hd_t <var>h</var>, unsigned char *{out, size_t <var>outsize</var>, const unsigned char *<var>in</var>, size_t <var>inlen</var>)</i></dt>
<dd>
<p><code>gcry_cipher_encrypt</code> is used to encrypt the data.  This function
can either work in place or with two buffers.  It uses the cipher
context already setup and described by the handle <var>h</var>.  There are 2
ways to use the function: If <var>in</var> is passed as <code>NULL</code> and
<var>inlen</var> is <code>0</code>, in-place encryption of the data in <var>out</var> of
length <var>outsize</var> takes place.  With <var>in</var> being not <code>NULL</code>,
<var>inlen</var> bytes are encrypted to the buffer <var>out</var> which must have
at least a size of <var>inlen</var>.  <var>outsize</var> must be set to the
allocated size of <var>out</var>, so that the function can check that there
is sufficient space. Note that overlapping buffers are not allowed.
</p>
<p>Depending on the selected algorithms and encryption mode, the length of
the buffers must be a multiple of the block size.
</p>
<p>Some encryption modes require that <code>gcry_cipher_final</code> is used
before the final data chunk is passed to this function.
</p>
<p>The function returns <code>0</code> on success or an error code.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fcipher_005fdecrypt"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_decrypt</b><i> (gcry_cipher_hd_t <var>h</var>, unsigned char *{out, size_t <var>outsize</var>, const unsigned char *<var>in</var>, size_t <var>inlen</var>)</i></dt>
<dd>
<p><code>gcry_cipher_decrypt</code> is used to decrypt the data.  This function
can either work in place or with two buffers.  It uses the cipher
context already setup and described by the handle <var>h</var>.  There are 2
ways to use the function: If <var>in</var> is passed as <code>NULL</code> and
<var>inlen</var> is <code>0</code>, in-place decryption of the data in <var>out</var> or
length <var>outsize</var> takes place.  With <var>in</var> being not <code>NULL</code>,
<var>inlen</var> bytes are decrypted to the buffer <var>out</var> which must have
at least a size of <var>inlen</var>.  <var>outsize</var> must be set to the
allocated size of <var>out</var>, so that the function can check that there
is sufficient space.  Note that overlapping buffers are not allowed.
</p>
<p>Depending on the selected algorithms and encryption mode, the length of
the buffers must be a multiple of the block size.
</p>
<p>Some encryption modes require that <code>gcry_cipher_final</code> is used
before the final data chunk is passed to this function.
</p>
<p>The function returns <code>0</code> on success or an error code.
</p></dd></dl>


<p>The OCB mode features integrated padding and must thus be told about
the end of the input data. This is done with:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005ffinal"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_final</b><i> (gcry_cipher_hd_t <var>h</var>)</i></dt>
<dd>
<p>Set a flag in the context to tell the encrypt and decrypt functions
that their next call will provide the last chunk of data.  Only the
first call to this function has an effect and only for modes which
support it.  Checking the error is in general not necessary.  This is
implemented as a macro.
</p></dd></dl>


<p>The SIV mode and the GCM-SIV mode requires decryption tag to be input
before decryption. This is done with:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fset_005fdecryption_005ftag"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_set_decryption_tag</b><i> (gcry_cipher_hd_t <var>h</var>, const void *<var>tag</var>, size_t <var>taglen</var>)</i></dt>
<dd>
<p>Set decryption tag for SIV or GCM-SIV mode decryption.  This is
implemented as a macro.
</p></dd></dl>


<p>OpenPGP (as defined in RFC-4880) requires a special sync operation in
some places.  The following function is used for this:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fsync"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_sync</b><i> (gcry_cipher_hd_t <var>h</var>)</i></dt>
<dd>
<p>Perform the OpenPGP sync operation on context <var>h</var>.  Note that this
is a no-op unless the context was created with the flag
<code>GCRY_CIPHER_ENABLE_SYNC</code>.
</p></dd></dl>

<p>Some of the described functions are implemented as macros utilizing a
catch-all control function.  This control function is rarely used
directly but there is nothing which would inhibit it:
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005fctl"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_ctl</b><i> (gcry_cipher_hd_t <var>h</var>, int <var>cmd</var>, void *<var>buffer</var>, size_t <var>buflen</var>)</i></dt>
<dd>
<p><code>gcry_cipher_ctl</code> controls various aspects of the cipher module and
specific cipher contexts.  Usually some more specialized functions or
macros are used for this purpose.  The semantics of the function and its
parameters depends on the command <var>cmd</var> and the passed context
handle <var>h</var>.  Please see the comments in the source code
(<code>src/global.c</code>) for details.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005finfo"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_info</b><i> (gcry_cipher_hd_t <var>h</var>,               int <var>what</var>, void *<var>buffer</var>, size_t *<var>nbytes</var>)</i></dt>
<dd>
<p><code>gcry_cipher_info</code> is used to retrieve various
information about a cipher context or the cipher module in general.
</p>
<dl compact="compact">
<dt> <code>GCRYCTL_GET_TAGLEN:</code></dt>
<dd><p>Return the length of the tag for an AE algorithm mode.  An error is
returned for modes which do not support a tag.  <var>buffer</var> must be
given as <code>NULL</code>.  On success the result is stored <var>nbytes</var>.  The
taglen is returned in bytes.
</p>
</dd>
</dl>

</dd></dl>

<hr size="6">
<a name="General-cipher-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Working-with-cipher-handles" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="General-cipher-functions-1"></a>
<h2 class="section">5.4 General cipher functions</h2>

<p>To work with the algorithms, several functions are available to map
algorithm names to the internal identifiers, as well as ways to
retrieve information about an algorithm or the current cipher context.
</p>
<dl>
<dt><a name="index-gcry_005fcipher_005falgo_005finfo"></a><u>Function:</u> gcry_error_t <b>gcry_cipher_algo_info</b><i> (int <var>algo</var>, int <var>what</var>, void *<var>buffer</var>, size_t *<var>nbytes</var>)</i></dt>
<dd>
<p>This function is used to retrieve information on a specific algorithm.
You pass the cipher algorithm ID as <var>algo</var> and the type of
information requested as <var>what</var>. The result is either returned as
the return code of the function or copied to the provided <var>buffer</var>
whose allocated length must be available in an integer variable with the
address passed in <var>nbytes</var>.  This variable will also receive the
actual used length of the buffer.
</p>
<p>Here is a list of supported codes for <var>what</var>:
</p>
<dl compact="compact">
<dt> <code>GCRYCTL_GET_KEYLEN:</code></dt>
<dd><p>Return the length of the key. If the algorithm supports multiple key
lengths, the maximum supported value is returned.  The length is
returned as number of octets (bytes) and not as number of bits in
<var>nbytes</var>; <var>buffer</var> must be zero.  Note that it is usually
better to use the convenience function
<code>gcry_cipher_get_algo_keylen</code>.
</p>
</dd>
<dt> <code>GCRYCTL_GET_BLKLEN:</code></dt>
<dd><p>Return the block length of the algorithm.  The length is returned as a
number of octets in <var>nbytes</var>; <var>buffer</var> must be zero.  Note
that it is usually better to use the convenience function
<code>gcry_cipher_get_algo_blklen</code>.
</p>
</dd>
<dt> <code>GCRYCTL_TEST_ALGO:</code></dt>
<dd><p>Returns <code>0</code> when the specified algorithm is available for use.
<var>buffer</var> and <var>nbytes</var> must be zero.
</p>
</dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fget_005falgo_005fkeylen"></a><u>Function:</u> size_t <b>gcry_cipher_get_algo_keylen</b><i> (<var>algo</var>)</i></dt>
<dd>
<p>This function returns length of the key for algorithm <var>algo</var>.  If
the algorithm supports multiple key lengths, the maximum supported key
length is returned.  On error <code>0</code> is returned.  The key length is
returned as number of octets.
</p>
<p>This is a convenience functions which should be preferred over
<code>gcry_cipher_algo_info</code> because it allows proper type
checking.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fget_005falgo_005fblklen"></a><u>Function:</u> size_t <b>gcry_cipher_get_algo_blklen</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>This functions returns the block-length of the algorithm <var>algo</var>
counted in octets.  On error <code>0</code> is returned.
</p>
<p>This is a convenience functions which should be preferred over
<code>gcry_cipher_algo_info</code> because it allows proper type
checking.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fcipher_005falgo_005fname"></a><u>Function:</u> const char * <b>gcry_cipher_algo_name</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p><code>gcry_cipher_algo_name</code> returns a string with the name of the
cipher algorithm <var>algo</var>.  If the algorithm is not known or another
error occurred, the string <code>&quot;?&quot;</code> is returned.  This function should
not be used to test for the availability of an algorithm.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fmap_005fname"></a><u>Function:</u> int <b>gcry_cipher_map_name</b><i> (const char *<var>name</var>)</i></dt>
<dd>
<p><code>gcry_cipher_map_name</code> returns the algorithm identifier for the
cipher algorithm described by the string <var>name</var>.  If this algorithm
is not available, <code>0</code> is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcipher_005fmode_005ffrom_005foid"></a><u>Function:</u> int <b>gcry_cipher_mode_from_oid</b><i> (const char *<var>string</var>)</i></dt>
<dd>
<p>Return the cipher mode associated with an <acronym>ASN.1</acronym> object
identifier.  The object identifier is expected to be in the
<acronym>IETF</acronym>-style dotted decimal notation.  The function returns
<code>0</code> for an unknown object identifier or when no mode is associated
with it.
</p></dd></dl>


<hr size="6">
<a name="Public-Key-cryptography"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#General-cipher-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Available-algorithms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Symmetric-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Public-Key-cryptography-1"></a>
<h1 class="chapter">6. Public Key cryptography</h1>

<p>Public key cryptography, also known as asymmetric cryptography, is an
easy way for key management and to provide digital signatures.
Libgcrypt provides two completely different interfaces to
public key cryptography, this chapter explains the one based on
S-expressions.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Available-algorithms">6.1 Available algorithms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Algorithms supported by the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Used-S_002dexpressions">6.2 Used S-expressions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Introduction into the used S-expression.
</td></tr>
<tr><td align="left" valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Functions for performing the cryptographic actions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Dedicated-ECC-Functions">6.4 Dedicated functions for elliptic curves.</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  General functions, not implementing any cryptography.
</td></tr>
</table>

<hr size="6">
<a name="Available-algorithms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Used-S_002dexpressions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Available-algorithms-1"></a>
<h2 class="section">6.1 Available algorithms</h2>

<p>Libgcrypt supports the RSA (Rivest-Shamir-Adleman) algorithms as well
as DSA (Digital Signature Algorithm), Elgamal, ECDSA, ECDH, and EdDSA.
</p>
<hr size="6">
<a name="Used-S_002dexpressions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Available-algorithms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#RSA-key-parameters" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Used-S_002dexpressions-1"></a>
<h2 class="section">6.2 Used S-expressions</h2>

<p>Libgcrypt&rsquo;s API for asymmetric cryptography is based on data structures
called S-expressions (see
<a href="http://people.csail.mit.edu/rivest/sexp.html">http://people.csail.mit.edu/rivest/sexp.html</a>) and does not work
with contexts/handles as most of the other building blocks of Libgcrypt do.
</p>
<p>The following information are stored in S-expressions:
</p>
<ul>
<li> keys

</li><li> plain text data

</li><li> encrypted data

</li><li> signatures

</li></ul>

<p>To describe how Libgcrypt expect keys, we use examples. Note that
words in
uppercase
indicate parameters, whereas lowercase words are literals.
</p>
<p>Note that all MPI (multi-precision-integers) values are expected to be in
<code>GCRYMPI_FMT_USG</code> format.  An easy way to create S-expressions is
by using <code>gcry_sexp_build</code> which allows to pass a string with
printf-like escapes to insert MPI values.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#RSA-key-parameters">6.2.1 RSA key parameters</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Parameters used with an RSA key.
</td></tr>
<tr><td align="left" valign="top"><a href="#DSA-key-parameters">6.2.2 DSA key parameters</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Parameters used with a DSA key.
</td></tr>
<tr><td align="left" valign="top"><a href="#ECC-key-parameters">6.2.3 ECC key parameters</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Parameters used with ECC keys.
</td></tr>
</table>

<hr size="6">
<a name="RSA-key-parameters"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Used-S_002dexpressions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#DSA-key-parameters" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Used-S_002dexpressions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="RSA-key-parameters-1"></a>
<h3 class="subsection">6.2.1 RSA key parameters</h3>

<p>An RSA private key is described by this S-expression:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(private-key
  (rsa
    (n <var>n-mpi</var>)
    (e <var>e-mpi</var>)
    (d <var>d-mpi</var>)
    (p <var>p-mpi</var>)
    (q <var>q-mpi</var>)
    (u <var>u-mpi</var>)))
</pre></td></tr></table>

<p>An RSA public key is described by this S-expression:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(public-key
  (rsa
    (n <var>n-mpi</var>)
    (e <var>e-mpi</var>)))
</pre></td></tr></table>


<dl compact="compact">
<dt> <var>n-mpi</var></dt>
<dd><p>RSA public modulus <em>n</em>.
</p></dd>
<dt> <var>e-mpi</var></dt>
<dd><p>RSA public exponent <em>e</em>.
</p></dd>
<dt> <var>d-mpi</var></dt>
<dd><p>RSA secret exponent <em>d = e^-1 \bmod (p-1)(q-1)</em>.
</p></dd>
<dt> <var>p-mpi</var></dt>
<dd><p>RSA secret prime <em>p</em>.
</p></dd>
<dt> <var>q-mpi</var></dt>
<dd><p>RSA secret prime <em>q</em> with <em>p &lt; q</em>.
</p></dd>
<dt> <var>u-mpi</var></dt>
<dd><p>Multiplicative inverse <em>u = p^-1 \bmod q</em>.
</p></dd>
</dl>

<p>For signing and decryption, the parameters <em>(p, q, u)</em> are optional
but greatly improve the performance.  Either all of these optional
parameters must be given or none of them.  They are mandatory for
<code>gcry_pk_testkey</code>.
</p>
<p>Note that OpenSSL uses slighly different parameters: <em>q &lt; p</em> and
 <em>u = q^-1 \bmod p</em>.  To use these parameters you will need to
swap the values and recompute <em>u</em>.  Here is example code to do this:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  if (gcry_mpi_cmp (p, q) &gt; 0)
    {
      gcry_mpi_swap (p, q);
      gcry_mpi_invm (u, p, q);
    }
</pre></td></tr></table>




<hr size="6">
<a name="DSA-key-parameters"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#RSA-key-parameters" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#ECC-key-parameters" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Used-S_002dexpressions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="DSA-key-parameters-1"></a>
<h3 class="subsection">6.2.2 DSA key parameters</h3>

<p>A DSA private key is described by this S-expression:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(private-key
  (dsa
    (p <var>p-mpi</var>)
    (q <var>q-mpi</var>)
    (g <var>g-mpi</var>)
    (y <var>y-mpi</var>)
    (x <var>x-mpi</var>)))
</pre></td></tr></table>

<dl compact="compact">
<dt> <var>p-mpi</var></dt>
<dd><p>DSA prime <em>p</em>.
</p></dd>
<dt> <var>q-mpi</var></dt>
<dd><p>DSA group order <em>q</em> (which is a prime divisor of <em>p-1</em>).
</p></dd>
<dt> <var>g-mpi</var></dt>
<dd><p>DSA group generator <em>g</em>.
</p></dd>
<dt> <var>y-mpi</var></dt>
<dd><p>DSA public key value <em>y = g^x \bmod p</em>.
</p></dd>
<dt> <var>x-mpi</var></dt>
<dd><p>DSA secret exponent x.
</p></dd>
</dl>

<p>The public key is similar, with &quot;private-key&quot; replaced by &quot;public-key&quot;
and no <var>x-mpi</var>.
</p>

<hr size="6">
<a name="ECC-key-parameters"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#DSA-key-parameters" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Cryptographic-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Used-S_002dexpressions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="ECC-key-parameters-1"></a>
<h3 class="subsection">6.2.3 ECC key parameters</h3>

<p><a name="ecc_005fkeyparam"></a>
An ECC private key is described by this S-expression:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(private-key
  (ecc
    (p <var>p-mpi</var>)
    (a <var>a-mpi</var>)
    (b <var>b-mpi</var>)
    (g <var>g-point</var>)
    (n <var>n-mpi</var>)
    (q <var>q-point</var>)
    (d <var>d-mpi</var>)))
</pre></td></tr></table>

<dl compact="compact">
<dt> <var>p-mpi</var></dt>
<dd><p>Prime specifying the field <em>GF(p)</em>.
</p></dd>
<dt> <var>a-mpi</var></dt>
<dt> <var>b-mpi</var></dt>
<dd><p>The two coefficients of the Weierstrass equation <em>y^2 = x^3 + ax + b</em>
</p></dd>
<dt> <var>g-point</var></dt>
<dd><p>Base point <em>g</em>.
</p></dd>
<dt> <var>n-mpi</var></dt>
<dd><p>Order of <em>g</em>
</p></dd>
<dt> <var>q-point</var></dt>
<dd><p>The point representing the public key <em>Q = dG</em>.
</p></dd>
<dt> <var>d-mpi</var></dt>
<dd><p>The private key <em>d</em>
</p></dd>
</dl>

<p>All point values are encoded in standard format; Libgcrypt does in
general only support uncompressed points, thus the first byte needs to
be <code>0x04</code>.  However &ldquo;EdDSA&rdquo; describes its own compression
scheme which is used by default; the non-standard first byte
<code>0x40</code> may optionally be used to explicit flag the use of the
algorithm&rsquo;s native compression method.
</p>
<p>The public key is similar, with &quot;private-key&quot; replaced by &quot;public-key&quot;
and no <var>d-mpi</var>.
</p>
<p>If the domain parameters are well-known, the name of this curve may be
used.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(private-key
  (ecc
    (curve &quot;NIST P-192&quot;)
    (q <var>q-point</var>)
    (d <var>d-mpi</var>)))
</pre></td></tr></table>

<p>Note that <var>q-point</var> is optional for a private key.  The
<code>curve</code> parameter may be given in any case and is used to replace
missing parameters.
</p>
<p>Currently implemented curves are:
</p>
<dl compact="compact">
<dt> <code>Curve25519</code></dt>
<dt> <code>X25519</code></dt>
<dt> <code>1.3.6.1.4.1.3029.1.5.1</code></dt>
<dt> <code>1.3.101.110</code></dt>
<dd><p>The RFC-8410 255 bit curve, its RFC name, OpenPGP and RFC OIDs.
</p>
</dd>
<dt> <code>X448</code></dt>
<dt> <code>1.3.101.111</code></dt>
<dd><p>The RFC-8410 448 bit curve and its RFC OID.
</p>
</dd>
<dt> <code>Ed25519</code></dt>
<dt> <code>1.3.6.1.4.1.11591.15.1</code></dt>
<dt> <code>1.3.101.112</code></dt>
<dd><p>The signing variant of the RFC-8410 255 bit curve, its OpenPGP and RFC OIDs.
</p>
</dd>
<dt> <code>Ed448</code></dt>
<dt> <code>1.3.101.113</code></dt>
<dd><p>The signing variant of the RFC-8410 448 bit curve and its RFC OID.
</p>
</dd>
<dt> <code>NIST P-192</code></dt>
<dt> <code>1.2.840.10045.3.1.1</code></dt>
<dt> <code>nistp192</code></dt>
<dt> <code>prime192v1</code></dt>
<dt> <code>secp192r1</code></dt>
<dd><p>The NIST 192 bit curve, its OID and aliases.
</p>
</dd>
<dt> <code>NIST P-224</code></dt>
<dt> <code>1.3.132.0.33</code></dt>
<dt> <code>nistp224</code></dt>
<dt> <code>secp224r1</code></dt>
<dd><p>The NIST 224 bit curve, its OID and aliases.
</p>
</dd>
<dt> <code>NIST P-256</code></dt>
<dt> <code>1.2.840.10045.3.1.7</code></dt>
<dt> <code>nistp256</code></dt>
<dt> <code>prime256v1</code></dt>
<dt> <code>secp256r1</code></dt>
<dd><p>The NIST 256 bit curve, its OID and aliases.
</p>
</dd>
<dt> <code>NIST P-384</code></dt>
<dt> <code>1.3.132.0.34</code></dt>
<dt> <code>nistp384</code></dt>
<dt> <code>secp384r1</code></dt>
<dd><p>The NIST 384 bit curve, its OID and aliases.
</p>
</dd>
<dt> <code>NIST P-521</code></dt>
<dt> <code>1.3.132.0.35</code></dt>
<dt> <code>nistp521</code></dt>
<dt> <code>secp521r1</code></dt>
<dd><p>The NIST 521 bit curve, its OID and aliases.
</p>
</dd>
<dt> <code>brainpoolP160r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.1</code></dt>
<dd><p>The Brainpool 160 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP192r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.3</code></dt>
<dd><p>The Brainpool 192 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP224r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.5</code></dt>
<dd><p>The Brainpool 224 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP256r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.7</code></dt>
<dd><p>The Brainpool 256 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP320r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.9</code></dt>
<dd><p>The Brainpool 320 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP384r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.11</code></dt>
<dd><p>The Brainpool 384 bit curve and its OID.
</p>
</dd>
<dt> <code>brainpoolP512r1</code></dt>
<dt> <code>1.3.36.3.3.2.8.1.1.13</code></dt>
<dd><p>The Brainpool 512 bit curve and its OID.
</p>
</dd>
<dt> <code>GOST2001-test</code></dt>
<dt> <code>1.2.643.2.2.35.0</code></dt>
<dt> <code>GOST2001-CryptoPro-A</code></dt>
<dt> <code>1.2.643.2.2.35.1</code></dt>
<dt> <code>GOST2001-CryptoPro-B</code></dt>
<dt> <code>1.2.643.2.2.35.2</code></dt>
<dt> <code>GOST2001-CryptoPro-C</code></dt>
<dt> <code>1.2.643.2.2.35.3</code></dt>
<dt> <code>GOST2001-CryptoPro-A</code></dt>
<dt> <code>GOST2001-CryptoPro-XchA</code></dt>
<dt> <code>GOST2001-CryptoPro-C</code></dt>
<dt> <code>GOST2001-CryptoPro-XchB</code></dt>
<dt> <code>GOST2001-CryptoPro-A</code></dt>
<dt> <code>1.2.643.2.2.36.0</code></dt>
<dt> <code>GOST2001-CryptoPro-C</code></dt>
<dt> <code>1.2.643.2.2.36.1</code></dt>
<dt> <code>GOST2012-256-tc26-A</code></dt>
<dt> <code>1.2.643.7.1.2.1.1.1</code></dt>
<dt> <code>GOST2001-CryptoPro-A</code></dt>
<dt> <code>1.2.643.7.1.2.1.1.2</code></dt>
<dt> <code>GOST2001-CryptoPro-A</code></dt>
<dt> <code>GOST2012-256-tc26-B</code></dt>
<dt> <code>GOST2001-CryptoPro-B</code></dt>
<dt> <code>1.2.643.7.1.2.1.1.3</code></dt>
<dt> <code>GOST2001-CryptoPro-B</code></dt>
<dt> <code>GOST2012-256-tc26-C</code></dt>
<dt> <code>GOST2001-CryptoPro-C</code></dt>
<dt> <code>1.2.643.7.1.2.1.1.4</code></dt>
<dt> <code>GOST2001-CryptoPro-C</code></dt>
<dt> <code>GOST2012-256-tc26-D</code></dt>
<dt> <code>GOST2012-512-test</code></dt>
<dt> <code>GOST2012-test</code></dt>
<dt> <code>GOST2012-512-test</code></dt>
<dt> <code>1.2.643.7.1.2.1.2.0</code></dt>
<dt> <code>GOST2012-512-tc26-A</code></dt>
<dt> <code>GOST2012-tc26-A</code></dt>
<dt> <code>GOST2012-512-tc26-B</code></dt>
<dt> <code>GOST2012-tc26-B</code></dt>
<dt> <code>GOST2012-512-tc26-A</code></dt>
<dt> <code>1.2.643.7.1.2.1.2.1</code></dt>
<dt> <code>GOST2012-512-tc26-B</code></dt>
<dt> <code>1.2.643.7.1.2.1.2.2</code></dt>
<dt> <code>GOST2012-512-tc26-C</code></dt>
<dt> <code>1.2.643.7.1.2.1.2.3</code></dt>
<dt> <code>secp256k1</code></dt>
<dt> <code>1.3.132.0.10</code></dt>
<dt> <code>sm2p256v1</code></dt>
<dt> <code>1.2.156.10197.1.301</code></dt>
</dl>
<p>As usual the OIDs may optionally be prefixed with the string <code>OID.</code>
or <code>oid.</code>.
</p>

<hr size="6">
<a name="Cryptographic-Functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#ECC-key-parameters" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dedicated-ECC-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Cryptographic-Functions-1"></a>
<h2 class="section">6.3 Cryptographic Functions</h2>

<p>Some functions operating on S-expressions support &lsquo;flags&rsquo; to influence
the operation.  These flags have to be listed in a sub-S-expression
named &lsquo;flags&rsquo;.  Flag names are case-sensitive.  The following flags
are known:
</p>
<dl compact="compact">
<dt> <code>comp</code></dt>
<dt> <code>nocomp</code></dt>
<dd><a name="index-comp"></a>
<a name="index-nocomp"></a>
<p>If supported by the algorithm and curve, the <code>comp</code> flag requests
that points are returned in compact (compressed) representation.  The
<code>nocomp</code> flag requests that points are returned with full
coordinates.  The default depends on the the algorithm and curve.  The
compact representation requires a small overhead before a point can be
used but halves the size of a public key to be conveyed.  If
<code>comp</code> is used with the &ldquo;EdDSA&rdquo; algorithm, the key generation
prefixes the public key with a <code>0x40</code> byte.
</p>
</dd>
<dt> <code>pkcs1</code></dt>
<dd><a name="index-PKCS1"></a>
<p>Use PKCS#1 block type 2 padding for encryption, block type 1 padding
for signing.
</p>
</dd>
<dt> <code>oaep</code></dt>
<dd><a name="index-OAEP"></a>
<p>Use RSA-OAEP padding for encryption.
</p>
</dd>
<dt> <code>pss</code></dt>
<dd><a name="index-PSS"></a>
<p>Use RSA-PSS padding for signing.
</p>
</dd>
<dt> <code>eddsa</code></dt>
<dd><a name="index-EdDSA"></a>
<p>Use the EdDSA scheme signing instead of the default ECDSA algorithm.
Note that the EdDSA uses a special form of the public key.
</p>
</dd>
<dt> <code>rfc6979</code></dt>
<dd><a name="index-RFC6979"></a>
<p>For DSA and ECDSA use a deterministic scheme for the k parameter.
</p>
</dd>
<dt> <code>no-blinding</code></dt>
<dd><a name="index-no_002dblinding"></a>
<p>Do not use a technique called &lsquo;blinding&rsquo;, which is used by default in
order to prevent leaking of secret information.  Blinding is only
implemented by RSA, but it might be implemented by other algorithms in
the future as well, when necessary.
</p>
</dd>
<dt> <code>param</code></dt>
<dd><a name="index-param"></a>
<p>For ECC key generation also return the domain parameters.  For ECC
signing and verification override default parameters by provided
domain parameters of the public or private key.
</p>
</dd>
<dt> <code>transient-key</code></dt>
<dd><a name="index-transient_002dkey"></a>
<p>This flag is only meaningful for RSA, DSA, and ECC key generation.  If
given, the key is created using a faster and a somewhat less secure
random number generator.  This flag may be used for keys which are
only used for a short time or per-message and do not require full
cryptographic strength.
</p>
</dd>
<dt> <code>no-keytest</code></dt>
<dd><a name="index-no_002dkeytest"></a>
<p>This flag skips internal failsafe tests to assert that a generated key
is properly working.  It currently has an effect only for standard ECC
key generation.  It is mostly useful along with transient-key to
achieve fastest ECC key generation.
</p>
</dd>
<dt> <code>use-x931</code></dt>
<dd><a name="index-X9_002e31"></a>
<p>Force the use of the ANSI X9.31 key generation algorithm instead of
the default algorithm. This flag is only meaningful for RSA key
generation and usually not required.  Note that this algorithm is
implicitly used if either <code>derive-parms</code> is given.
</p>
</dd>
<dt> <code>use-fips186</code></dt>
<dd><a name="index-FIPS-186"></a>
<p>Force the use of the FIPS 186 key generation algorithm instead of the
default algorithm.  This flag is only meaningful for DSA and usually
not required.  Note that this algorithm is implicitly used if either
<code>derive-parms</code> is given or Libgcrypt is in FIPS mode.  As of now
FIPS 186-2 is implemented; after the approval of FIPS 186-3 the code
will be changed to implement 186-3.
</p>
</dd>
<dt> <code>use-fips186-2</code></dt>
<dd><a name="index-FIPS-186_002d2"></a>
<p>Force the use of the FIPS 186-2 key generation algorithm instead of
the default algorithm.  This algorithm is slightly different from
FIPS 186-3 and allows only 1024 bit keys.  This flag is only meaningful
for DSA and only required for FIPS testing backward compatibility.
</p>
</dd>
</dl>

<p>Now that we know the key basics, we can carry on and explain how to
encrypt and decrypt data.  In almost all cases the data is a random
session key which is in turn used for the actual encryption of the real
data.  There are 2 functions to do this:
</p>
<dl>
<dt><a name="index-gcry_005fpk_005fencrypt"></a><u>Function:</u> gcry_error_t <b>gcry_pk_encrypt</b><i> (gcry_sexp_t *<var>r_ciph</var>, gcry_sexp_t <var>data</var>, gcry_sexp_t <var>pkey</var>)</i></dt>
<dd>
<p>Obviously a public key must be provided for encryption.  It is
expected as an appropriate S-expression (see above) in <var>pkey</var>.
The data to be encrypted can either be in the simple old format, which
is a very simple S-expression consisting only of one MPI, or it may be
a more complex S-expression which also allows to specify flags for
operation, like e.g. padding rules.
</p>
<p>If you don&rsquo;t want to let Libgcrypt handle the padding, you must pass an
appropriate MPI using this expression for <var>data</var>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags raw)
  (value <var>mpi</var>))
</pre></td></tr></table>

<p>This has the same semantics as the old style MPI only way.  <var>MPI</var>
is the actual data, already padded appropriate for your protocol.
Most RSA based systems however use PKCS#1 padding and so you can use
this S-expression for <var>data</var>:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags pkcs1)
  (value <var>block</var>))
</pre></td></tr></table>

<p>Here, the &quot;flags&quot; list has the &quot;pkcs1&quot; flag which let the function know
that it should provide PKCS#1 block type 2 padding.  The actual data to
be encrypted is passed as a string of octets in <var>block</var>.  The
function checks that this data actually can be used with the given key,
does the padding and encrypts it.
</p>
<p>If the function could successfully perform the encryption, the return
value will be 0 and a new S-expression with the encrypted result is
allocated and assigned to the variable at the address of <var>r_ciph</var>.
The caller is responsible to release this value using
<code>gcry_sexp_release</code>.  In case of an error, an error code is
returned and <var>r_ciph</var> will be set to <code>NULL</code>.
</p>
<p>The returned S-expression has this format when used with RSA:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(enc-val
  (rsa
    (a <var>a-mpi</var>)))
</pre></td></tr></table>

<p>Where <var>a-mpi</var> is an MPI with the result of the RSA operation.  When
using the Elgamal algorithm, the return value will have this format:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(enc-val
  (elg
    (a <var>a-mpi</var>)
    (b <var>b-mpi</var>)))
</pre></td></tr></table>

<p>Where <var>a-mpi</var> and <var>b-mpi</var> are MPIs with the result of the
Elgamal encryption operation.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005fdecrypt"></a><u>Function:</u> gcry_error_t <b>gcry_pk_decrypt</b><i> (gcry_sexp_t *<var>r_plain</var>, gcry_sexp_t <var>data</var>, gcry_sexp_t <var>skey</var>)</i></dt>
<dd>
<p>Obviously a private key must be provided for decryption.  It is expected
as an appropriate S-expression (see above) in <var>skey</var>.  The data to
be decrypted must match the format of the result as returned by
<code>gcry_pk_encrypt</code>, but should be enlarged with a <code>flags</code>
element:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(enc-val
  (flags)
  (elg
    (a <var>a-mpi</var>)
    (b <var>b-mpi</var>)))
</pre></td></tr></table>

<p>This function does not remove padding from the data by default.  To
let Libgcrypt remove padding, give a hint in &lsquo;flags&rsquo; telling which
padding method was used when encrypting:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(flags <var>padding-method</var>)
</pre></td></tr></table>

<p>Currently <var>padding-method</var> is either <code>pkcs1</code> for PKCS#1 block
type 2 padding, or <code>oaep</code> for RSA-OAEP padding.
</p>
<p>The function returns 0 on success or an error code.  The variable at the
address of <var>r_plain</var> will be set to <code>NULL</code> on error or receive the
decrypted value on success.  The format of <var>r_plain</var> is a
simple S-expression part (i.e. not a valid one) with just one MPI if
there was no <code>flags</code> element in <var>data</var>; if at least an empty
<code>flags</code> is passed in <var>data</var>, the format is:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(value <var>plaintext</var>)
</pre></td></tr></table>
</dd></dl>


<p>Another operation commonly performed using public key cryptography is
signing data.  In some sense this is even more important than
encryption because digital signatures are an important instrument for
key management.  Libgcrypt supports digital signatures using
2 functions, similar to the encryption functions:
</p>
<dl>
<dt><a name="index-gcry_005fpk_005fsign"></a><u>Function:</u> gcry_error_t <b>gcry_pk_sign</b><i> (gcry_sexp_t *<var>r_sig</var>, gcry_sexp_t <var>data</var>, gcry_sexp_t <var>skey</var>)</i></dt>
<dd>
<p>This function creates a digital signature for <var>data</var> using the
private key <var>skey</var> and place it into the variable at the address of
<var>r_sig</var>.  <var>data</var> may either be the simple old style S-expression
with just one MPI or a modern and more versatile S-expression which
allows to let Libgcrypt handle padding:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"> (data
  (flags pkcs1)
  (hash <var>hash-algo</var> <var>block</var>))
</pre></td></tr></table>

<p>This example requests to sign the data in <var>block</var> after applying
PKCS#1 block type 1 style padding.  <var>hash-algo</var> is a string with the
hash algorithm to be encoded into the signature, this may be any hash
algorithm name as supported by Libgcrypt.  Most likely, this will be
&quot;sha256&quot; or &quot;sha1&quot;.  It is obvious that the length of <var>block</var> must
match the size of that message digests; the function checks that this
and other constraints are valid.
</p>
<p>If PKCS#1 padding is not required (because the caller does already
provide a padded value), either the old format or better the following
format should be used:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags raw)
  (value <var>mpi</var>))
</pre></td></tr></table>

<p>Here, the data to be signed is directly given as an <var>MPI</var>.
</p>
<p>For DSA the input data is expected in this format:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags raw)
  (value <var>mpi</var>))
</pre></td></tr></table>

<p>Here, the data to be signed is directly given as an <var>MPI</var>.  It is
expect that this MPI is the hash value.  For the standard DSA,
using a MPI is not a problem in regard to leading zeroes because the
hash value is directly used as an MPI.  For better standard
conformance it would be better to explicitly use a memory string (like
with pkcs1) but that is currently not supported.  However, for
deterministic DSA as specified in RFC6979 this can&rsquo;t be used.  Instead
the following input is expected.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags rfc6979)
  (hash <var>hash-algo</var> <var>block</var>))
</pre></td></tr></table>

<p>Note that the provided hash-algo is used for the internal HMAC; it
should match the hash-algo used to create <var>block</var>.
</p>

<p>The signature is returned as a newly allocated S-expression in
<var>r_sig</var> using this format for RSA:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(sig-val
  (rsa
    (s <var>s-mpi</var>)))
</pre></td></tr></table>

<p>Where <var>s-mpi</var> is the result of the RSA sign operation.  For DSA the
S-expression returned is:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(sig-val
  (dsa
    (r <var>r-mpi</var>)
    (s <var>s-mpi</var>)))
</pre></td></tr></table>

<p>Where <var>r-mpi</var> and <var>s-mpi</var> are the result of the DSA sign
operation.
</p>
<p>For Elgamal signing (which is slow, yields large numbers and probably
is not as secure as the other algorithms), the same format is used
with &quot;elg&quot; replacing &quot;dsa&quot;; for ECDSA signing, the same format is used
with &quot;ecdsa&quot; replacing &quot;dsa&quot;.
</p>
<p>For the EdDSA algorithm (cf. Ed25515) the required input parameters are:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(data
  (flags eddsa)
  (hash-algo sha512)
  (value <var>message</var>))
</pre></td></tr></table>

<p>Note that the <var>message</var> may be of any length; hashing is part of
the algorithm.  Using a large data block for <var>message</var> is in
general not suggested; in that case the used protocol should better
require that a hash of the message is used as input to the EdDSA
algorithm.  Note that for X.509 certificates <var>message</var> is the
<code>tbsCertificate</code> part and in CMS <var>message</var> is the
<code>signedAttrs</code> part; see RFC-8410 and RFC-8419.
</p>

</dd></dl>

<p>The operation most commonly used is definitely the verification of a
signature.  Libgcrypt provides this function:
</p>
<dl>
<dt><a name="index-gcry_005fpk_005fverify"></a><u>Function:</u> gcry_error_t <b>gcry_pk_verify</b><i> (gcry_sexp_t <var>sig</var>, gcry_sexp_t <var>data</var>, gcry_sexp_t <var>pkey</var>)</i></dt>
<dd>
<p>This is used to check whether the signature <var>sig</var> matches the
<var>data</var>.  The public key <var>pkey</var> must be provided to perform this
verification.  This function is similar in its parameters to
<code>gcry_pk_sign</code> with the exceptions that the public key is used
instead of the private key and that no signature is created but a
signature, in a format as created by <code>gcry_pk_sign</code>, is passed to
the function in <var>sig</var>.
</p>
<p>The result is 0 for success (i.e. the data matches the signature), or an
error code where the most relevant code is <code>GCRY_ERR_BAD_SIGNATURE</code>
to indicate that the signature does not match the provided data.
</p>
</dd></dl>

<p>Additionally, libgcrypt provides three functions for digital
signatures.  Those functions are useful when hashing computation
should be closely combined with signature computation.
</p>
<dl>
<dt><a name="index-gcry_005fpk_005fhash_005fsign"></a><u>Function:</u> gcry_error_t <b>gcry_pk_hash_sign</b><i> (gcry_sexp_t *<var>result</var>, const char *<var>data_tmpl</var>, gcry_sexp_t <var>skey</var>, gcry_md_hd_t <var>hd</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>This function is a variant of <code>gcry_pk_sign</code> which takes as
additional parameter <var>hd</var>, handle for hash, and an optional
context <var>ctx</var>.  <var>skey</var> is a private key in S-expression.  The
hash algorithm used by the handle needs to be enabled and input needs
to be supplied beforehand.  <var>data-tmpl</var> specifies a template to
compose an S-expression to be signed.  A template should include
<code>&quot;(hash %s %b)&quot;</code> or <code>&quot;(hash ALGONAME %b)&quot;</code>.  For the former
case, &quot;%s&quot; is substituted by the string of algorithm of
<code>gcry_md_get_algo (</code><var>hd</var><code>)</code> and when <code>gcry_md_read</code>
is called, <code>ALGO=0</code> is used internally.  For the latter case,
hash algorithm by <code>ALGONAME</code> is used when <code>gcry_md_read</code> is
called internally.  The hash handle must not yet been finalized; the
function takes a copy of the state and does a finalize on the copy.
The last argument, <var>ctx</var>, may be used for supplying nonce
externally.  If no need, <var>ctx</var> should be passed as <code>NULL</code>.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005fhash_005fverify"></a><u>Function:</u> gcry_error_t <b>gcry_pk_hash_verify</b><i> (gcry_sexp_t <var>sigval</var>, const char *<var>data_tmpl</var>, gcry_sexp_t <var>pkey</var>, gcry_md_hd_t <var>hd</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>This function is a variant of <code>gcry_pk_verify</code> which takes as
additional parameter <var>hd</var>, handle for hash, and an optional
context <var>ctx</var>.  <var>pkey</var> is a public key in S-expression.  See
<code>gcry_pk_hash_sign</code>, for the explanation of handle for hash,
<var>data-tmpl</var> and <var>ctx</var>.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005frandom_005foverride_005fnew"></a><u>Function:</u> gcry_error_t <b>gcry_pk_random_override_new</b><i> (gcry_ctx_t *<var>r_ctx</var>, const unsigned char *<var>p</var>, size_t <var>len</var>)</i></dt>
<dd>
<p>This function is used to allocate a new context for nonce, by memory
area pointed to by <var>p</var> to <var>len</var> bytes.  This context can be
used when calling <code>gcry_pk_hash_sign</code> or
<code>gcry_pk_hash_verify</code> to supply nonce externally, instead of
generating internally.
</p>
<p>On success the function returns 0 and stores the new context object at
<var>r_ctx</var>; this object eventually needs to be released
(see <a href="#gcry_005fctx_005frelease">gcry_ctx_release</a>).  On error the function stores <code>NULL</code> at
<var>r_ctx</var> and returns an error code.
</p>
</dd></dl>


<hr size="6">
<a name="Dedicated-ECC-Functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Cryptographic-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#General-public_002dkey-related-Functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Dedicated-functions-for-elliptic-curves_002e"></a>
<h2 class="section">6.4 Dedicated functions for elliptic curves.</h2>

<p>The S-expression based interface is not optimal for certain operations on elliptic
curves.  Thus a few special functions are implemented to
support common operations on curves with one of these assigned curve
ids:
</p>
<dl compact="compact">
<dt> <code>GCRY_ECC_CURVE25519</code></dt>
<dt> <code>GCRY_ECC_CURVE448</code></dt>
</dl>

<dl>
<dt><a name="index-gcry_005fecc_005fget_005falgo_005fkeylen"></a><u>Function:</u> unsigned int <b>gcry_ecc_get_algo_keylen</b><i> (int <var>curveid</var>);</i></dt>
<dd>
<p>Returns the length in bytes of a point on the curve with the id
<var>curveid</var>.  0 is returned for curves which have no assigned id.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fecc_005fmul_005fpoint"></a><u>Function:</u> gpg_error_t <b>gcry_ecc_mul_point</b><i>             (int <var>curveid</var>,             unsigned char *<var>result</var>,             const unsigned char *<var>scalar</var>,             const unsigned char *<var>point</var>)</i></dt>
<dd>
<p>This function computes the scalar multiplication on the Montgomery
form of the curve with id <var>curveid</var>.  If <var>point</var> is <code>NULL</code>, the
base point of the curve is used.  The caller needs to provide a large
enough buffer for <var>result</var> and a valid <var>scalar</var> and
<var>point</var>.
</p></dd></dl>


<hr size="6">
<a name="General-public_002dkey-related-Functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Dedicated-ECC-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="General-public_002dkey-related-Functions-1"></a>
<h2 class="section">6.5 General public-key related Functions</h2>

<p>A couple of utility functions are available to retrieve the length of
the key, map algorithm identifiers and perform sanity checks:
</p>
<dl>
<dt><a name="index-gcry_005fpk_005falgo_005fname"></a><u>Function:</u> const char * <b>gcry_pk_algo_name</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Map the public key algorithm id <var>algo</var> to a string representation of
the algorithm name.  For unknown algorithms this functions returns the
string <code>&quot;?&quot;</code>.  This function should not be used to test for the
availability of an algorithm.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005fmap_005fname"></a><u>Function:</u> int <b>gcry_pk_map_name</b><i> (const char *<var>name</var>)</i></dt>
<dd>
<p>Map the algorithm <var>name</var> to a public key algorithm Id.  Returns 0 if
the algorithm name is not known.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005ftest_005falgo"></a><u>Function:</u> int <b>gcry_pk_test_algo</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Return 0 if the public key algorithm <var>algo</var> is available for use.
Note that this is implemented as a macro.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fpk_005fget_005fnbits"></a><u>Function:</u> unsigned int <b>gcry_pk_get_nbits</b><i> (gcry_sexp_t <var>key</var>)</i></dt>
<dd>
<p>Return what is commonly referred as the key length for the given
public or private key in <var>key</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005fget_005fkeygrip"></a><u>Function:</u> unsigned char * <b>gcry_pk_get_keygrip</b><i> (gcry_sexp_t <var>key</var>, unsigned char *<var>array</var>)</i></dt>
<dd>
<p>Return the so called &quot;keygrip&quot; which is the SHA-1 hash of the public key
parameters expressed in a way depended on the algorithm.  <var>array</var>
must either provide space for 20 bytes or be <code>NULL</code>. In the latter
case a newly allocated array of that size is returned.  On success a
pointer to the newly allocated space or to <var>array</var> is returned.
<code>NULL</code> is returned to indicate an error which is most likely an
unknown algorithm or one where a &quot;keygrip&quot; has not yet been defined.
The function accepts public or secret keys in <var>key</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fpk_005ftestkey"></a><u>Function:</u> gcry_error_t <b>gcry_pk_testkey</b><i> (gcry_sexp_t <var>key</var>)</i></dt>
<dd>
<p>Return zero if the private key <var>key</var> is &lsquo;sane&rsquo;, an error code otherwise.
Note that it is not possible to check the &lsquo;saneness&rsquo; of a public key.
</p>
</dd></dl>


<dl>
<dt><a name="index-gcry_005fpk_005falgo_005finfo"></a><u>Function:</u> gcry_error_t <b>gcry_pk_algo_info</b><i> (int <var>algo</var>, int <var>what</var>, void *<var>buffer</var>, size_t *<var>nbytes</var>)</i></dt>
<dd>
<p>Depending on the value of <var>what</var> return various information about
the public key algorithm with the id <var>algo</var>.  Note that the
function returns <code>-1</code> on error and the actual error code must be
retrieved using the function <code>gcry_errno</code>.  The currently defined
values for <var>what</var> are:
</p>
<dl compact="compact">
<dt> <code>GCRYCTL_TEST_ALGO:</code></dt>
<dd><p>Return 0 if the specified algorithm is available for use.
<var>buffer</var> must be <code>NULL</code>, <var>nbytes</var> may be passed as
<code>NULL</code> or point to a variable with the required usage of the
algorithm. This may be 0 for &quot;don&rsquo;t care&quot; or the bit-wise OR of these
flags:
</p>
<dl compact="compact">
<dt> <code>GCRY_PK_USAGE_SIGN</code></dt>
<dd><p>Algorithm is usable for signing.
</p></dd>
<dt> <code>GCRY_PK_USAGE_ENCR</code></dt>
<dd><p>Algorithm is usable for encryption.
</p></dd>
</dl>

<p>Unless you need to test for the allowed usage, it is in general better
to use the macro gcry_pk_test_algo instead.
</p>
</dd>
<dt> <code>GCRYCTL_GET_ALGO_USAGE:</code></dt>
<dd><p>Return the usage flags for the given algorithm.  For an invalid algorithm
return 0.  Disabled algorithms are ignored here because we
want to know whether the algorithm is at all capable of a certain usage.
</p>
</dd>
<dt> <code>GCRYCTL_GET_ALGO_NPKEY</code></dt>
<dd><p>Return the number of elements the public key for algorithm <var>algo</var>
consist of.  Return 0 for an unknown algorithm.
</p>
</dd>
<dt> <code>GCRYCTL_GET_ALGO_NSKEY</code></dt>
<dd><p>Return the number of elements the private key for algorithm <var>algo</var>
consist of.  Note that this value is always larger than that of the
public key.  Return 0 for an unknown algorithm.
</p>
</dd>
<dt> <code>GCRYCTL_GET_ALGO_NSIGN</code></dt>
<dd><p>Return the number of elements a signature created with the algorithm
<var>algo</var> consists of.  Return 0 for an unknown algorithm or for an
algorithm not capable of creating signatures.
</p>
</dd>
<dt> <code>GCRYCTL_GET_ALGO_NENCR</code></dt>
<dd><p>Return the number of elements a encrypted message created with the algorithm
<var>algo</var> consists of.  Return 0 for an unknown algorithm or for an
algorithm not capable of encryption.
</p></dd>
</dl>

<p>Please note that parameters not required should be passed as <code>NULL</code>.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fpk_005fctl"></a><u>Function:</u> gcry_error_t <b>gcry_pk_ctl</b><i> (int <var>cmd</var>, void *<var>buffer</var>, size_t <var>buflen</var>)</i></dt>
<dd>
<p>This is a general purpose function to perform certain control
operations.  <var>cmd</var> controls what is to be done. The return value is
0 for success or an error code.  Currently supported values for
<var>cmd</var> are:
</p>
<dl compact="compact">
<dt> <code>GCRYCTL_DISABLE_ALGO</code></dt>
<dd><p>Disable the algorithm given as an algorithm id in <var>buffer</var>.
<var>buffer</var> must point to an <code>int</code> variable with the algorithm
id and <var>buflen</var> must have the value <code>sizeof (int)</code>.  This
function is not thread safe and should thus be used before any other
threads are started.
</p>
</dd>
</dl>
</dd></dl>

<p>Libgcrypt also provides a function to generate public key
pairs:
</p>
<dl>
<dt><a name="index-gcry_005fpk_005fgenkey"></a><u>Function:</u> gcry_error_t <b>gcry_pk_genkey</b><i> (gcry_sexp_t *<var>r_key</var>, gcry_sexp_t <var>parms</var>)</i></dt>
<dd>
<p>This function create a new public key pair using information given in
the S-expression <var>parms</var> and stores the private and the public key
in one new S-expression at the address given by <var>r_key</var>.  In case of
an error, <var>r_key</var> is set to <code>NULL</code>.  The return code is 0 for
success or an error code otherwise.
</p>
<p>Here is an example for <var>parms</var> to create an 2048 bit RSA key:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (rsa
    (nbits 4:2048)))
</pre></td></tr></table>

<p>To create an Elgamal key, substitute &quot;elg&quot; for &quot;rsa&quot; and to create a DSA
key use &quot;dsa&quot;.  Valid ranges for the key length depend on the
algorithms; all commonly used key lengths are supported.  Currently
supported parameters are:
</p>
<dl compact="compact">
<dt> <code>nbits</code></dt>
<dd><p>This is always required to specify the length of the key.  The
argument is a string with a number in C-notation.  The value should be
a multiple of 8.  Note that the S-expression syntax requires that a
number is prefixed with its string length; thus the <code>4:</code> in the
above example.
</p>
</dd>
<dt> <code>curve <var>name</var></code></dt>
<dd><p>For ECC a named curve may be used instead of giving the number of
requested bits.  This allows to request a specific curve to override a
default selection Libgcrypt would have taken if <code>nbits</code> has been
given.  The available names are listed with the description of the ECC
public key parameters.
</p>
</dd>
<dt> <code>rsa-use-e <var>value</var></code></dt>
<dd><p>This is only used with RSA to give a hint for the public exponent. The
<var>value</var> will be used as a base to test for a usable exponent. Some
values are special:
</p>
<dl compact="compact">
<dt> &lsquo;<samp>0</samp>&rsquo;</dt>
<dd><p>Use a secure and fast value.  This is currently the number 41.
</p></dd>
<dt> &lsquo;<samp>1</samp>&rsquo;</dt>
<dd><p>Use a value as required by some crypto policies.  This is currently
the number 65537.
</p></dd>
<dt> &lsquo;<samp>2</samp>&rsquo;</dt>
<dd><p>Reserved
</p></dd>
<dt> &lsquo;<samp>&gt; 2</samp>&rsquo;</dt>
<dd><p>Use the given value.
</p></dd>
</dl>

<p>If this parameter is not used, Libgcrypt uses for historic reasons
65537.  Note that the value must fit into a 32 bit unsigned variable
and that the usual C prefixes are considered (e.g. 017 gives 15).
</p>

</dd>
<dt> <code>qbits <var>n</var></code></dt>
<dd><p>This is only meanigful for DSA keys.  If it is given, the DSA key is
generated with a Q parameter of size <var>n</var> bits.  If it is not given
or zero, Q is deduced from <var>nbits</var> in this way:
</p><dl compact="compact">
<dt> &lsquo;<samp>512 &lt;= N &lt;= 1024</samp>&rsquo;</dt>
<dd><p>Q = 160
</p></dd>
<dt> &lsquo;<samp>N = 2048</samp>&rsquo;</dt>
<dd><p>Q = 224
</p></dd>
<dt> &lsquo;<samp>N = 3072</samp>&rsquo;</dt>
<dd><p>Q = 256
</p></dd>
<dt> &lsquo;<samp>N = 7680</samp>&rsquo;</dt>
<dd><p>Q = 384
</p></dd>
<dt> &lsquo;<samp>N = 15360</samp>&rsquo;</dt>
<dd><p>Q = 512
</p></dd>
</dl>
<p>Note that in this case only the values for N, as given in the table,
are allowed.  When specifying Q, all values of N in the range 512 to
15680 are valid as long as they are multiples of 8.
</p>
</dd>
<dt> <code>domain <var>list</var></code></dt>
<dd><p>This is only meaningful for DLP algorithms.  If specified, keys are
generated with domain parameters taken from this list.  The exact
format of this parameter depends on the actual algorithm.  It is
currently only implemented for DSA using this format:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (dsa
    (domain
      (p <var>p-mpi</var>)
      (q <var>q-mpi</var>)
      (g <var>q-mpi</var>))))
</pre></td></tr></table>

<p><code>nbits</code> and <code>qbits</code> may not be specified because they are
derived from the domain parameters.
</p>
</dd>
<dt> <code>derive-parms <var>list</var></code></dt>
<dd><p>This is currently only implemented for RSA and DSA keys.  It is not
allowed to use this together with a <code>domain</code> specification.  If
given, it is used to derive the keys using the given parameters.
</p>
<p>If given for an RSA key, the X9.31 key generation algorithm is used.
If given for a DSA key, the FIPS 186 algorithm is used even if
libgcrypt is not in FIPS mode.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (rsa
    (nbits 4:1024)
    (rsa-use-e 1:3)
    (derive-parms
      (Xp1 #1A1916DDB29B4EB7EB6732E128#)
      (Xp2 #192E8AAC41C576C822D93EA433#)
      (Xp  #D8CD81F035EC57EFE822955149D3BFF70C53520D
            769D6D76646C7A792E16EBD89FE6FC5B605A6493
            39DFC925A86A4C6D150B71B9EEA02D68885F5009
            B98BD984#)
      (Xq1 #1A5CF72EE770DE50CB09ACCEA9#)
      (Xq2 #134E4CAA16D2350A21D775C404#)
      (Xq  #CC1092495D867E64065DEE3E7955F2EBC7D47A2D
            7C9953388F97DDDC3E1CA19C35CA659EDC2FC325
            6D29C2627479C086A699A49C4C9CEE7EF7BD1B34
            321DE34A#))))
</pre></td></tr></table>

<table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (dsa
    (nbits 4:1024)
    (derive-parms
      (seed <var>seed-mpi</var>))))
</pre></td></tr></table>

</dd>
<dt> <code>test-parms <var>list</var></code></dt>
<dd><p>This is currently only implemented for RSA keys.  If given, the
libgcrypt will not generate parameter, but tests whether the p,q is
probably prime.  Returns key with zeroes.
</p>
<p>The FIPS key generation algorithm is used even if libgcrypt is not
in FIPS mode.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (rsa
    (nbits 4:1024)
    (rsa-use-e 1:3)
    (test-parms
      (e 5:65537)
      (p #00bbccabcee15d343944a47e492d4b1f4de79633e2
          0cbb46f7d2d6813392a807ad048cf77528edd19f77
          e7453f25173b9dcb70423afa2037aae147b81a33d5
          41fc58f875eff1e852ab55e2e09a3debfbc151b3b0
          d17fef6f74d81fca14fbae531418e211ef818592af
          70de5cec3b92795cc3578572bf456099cd8727150e
          523261#)
      (q #00ca87ecf2883f4ed00a9ec65abdeba81d28edbfcc
          34ecc563d587f166b52d42bfbe22bbc095b0b8426a
          2f8bbc55baaa8859b42cbc376ed3067db3ef7b135b
          63481322911ebbd7014db83aa051e0ca2dbf302b75
          cd37f2ae8df90e134226e92f6353a284b28bb30af0
          bbf925b345b955328379866ebac11d55bc80fe84f1
          05d415#)

</pre></td></tr></table>


</dd>
<dt> <code>flags <var>flaglist</var></code></dt>
<dd><p>This is preferred way to define flags.  <var>flaglist</var> may contain any
number of flags.  See above for a specification of these flags.
</p>
<p>Here is an example on how to create a key using curve Ed25519 with the
ECDSA signature algorithm.  Note that the use of ECDSA with that curve
is in general not recommended.
</p><table><tr><td>&nbsp;</td><td><pre class="example">(genkey
  (ecc
    (flags transient-key)))
</pre></td></tr></table>

</dd>
<dt> <code>transient-key</code></dt>
<dt> <code>use-x931</code></dt>
<dt> <code>use-fips186</code></dt>
<dt> <code>use-fips186-2</code></dt>
<dd><p>These are deprecated ways to set a flag with that name; see above for
a description of each flag.
</p>

</dd>
</dl>

<p>The key pair is returned in a format depending on the algorithm.  Both
private and public keys are returned in one container and may be
accompanied by some miscellaneous information.
</p>
<p>Here are two examples: the first for Elgamal and the second for
elliptic curve key generation:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(key-data
  (public-key
    (elg
      (p <var>p-mpi</var>)
      (g <var>g-mpi</var>)
      (y <var>y-mpi</var>)))
  (private-key
    (elg
      (p <var>p-mpi</var>)
      (g <var>g-mpi</var>)
      (y <var>y-mpi</var>)
      (x <var>x-mpi</var>)))
  (misc-key-info
    (pm1-factors <var>n1 n2 ... nn</var>))
</pre></td></tr></table>

<table><tr><td>&nbsp;</td><td><pre class="example">(key-data
  (public-key
    (ecc
      (curve Ed25519)
      (flags eddsa)
      (q <var>q-value</var>)))
  (private-key
    (ecc
      (curve Ed25519)
      (flags eddsa)
      (q <var>q-value</var>)
      (d <var>d-value</var>))))
</pre></td></tr></table>

<p>As you can see, some of the information is duplicated, but this
provides an easy way to extract either the public or the private key.
Note that the order of the elements is not defined, e.g. the private
key may be stored before the public key. <var>n1 n2 ... nn</var> is a list
of prime numbers used to composite <var>p-mpi</var>; this is in general not
a very useful information and only available if the key generation
algorithm provides them.
</p></dd></dl>


<p>Future versions of Libgcrypt will have extended versions of the public
key interface which will take an additional context to allow for
pre-computations, special operations, and other optimization.  As a
first step a new function is introduced to help using the ECC
algorithms in new ways:
</p>
<dl>
<dt><a name="index-gcry_005fpubkey_005fget_005fsexp"></a><u>Function:</u> gcry_error_t <b>gcry_pubkey_get_sexp</b><i> (gcry_sexp_t *<var>r_sexp</var>,  int <var>mode</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Return an S-expression representing the context <var>ctx</var>.  Depending
on the state of that context, the S-expression may either be a public
key, a private key or any other object used with public key
operations.  On success 0 is returned and a new S-expression is stored
at <var>r_sexp</var>; on error an error code is returned and <code>NULL</code> is stored
at <var>r_sexp</var>.  <var>mode</var> must be one of:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>Decide what to return depending on the context.  For example if the
private key parameter is available, a private key is returned; if not, a
public key is returned.
</p>
</dd>
<dt> <code>GCRY_PK_GET_PUBKEY</code></dt>
<dd><p>Return the public key even if the context has the private key
parameter.
</p>
</dd>
<dt> <code>GCRY_PK_GET_SECKEY</code></dt>
<dd><p>Return the private key or the error <code>GPG_ERR_NO_SECKEY</code> if it is
not possible.
</p></dd>
</dl>

<p>As of now this function supports only certain ECC operations because a
context object is right now only defined for ECC.  Over time this
function will be extended to cover more algorithms.
</p>
</dd></dl>





<hr size="6">
<a name="Hashing"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#General-public_002dkey-related-Functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Available-hash-algorithms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Public-Key-cryptography" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Hashing-1"></a>
<h1 class="chapter">7. Hashing</h1>

<p>Libgcrypt provides an easy to use and consistent interface for hashing.
Hashing is buffered and several hash algorithms can be updated at once.
It is possible to compute a HMAC using the same routines.  The
programming model follows an open/process/close paradigm and is in that
similar to other building blocks provided by Libgcrypt.
</p>
<p>For convenience reasons, a few cyclic redundancy check value operations
are also supported.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   List of hash algorithms supported by the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  List of functions related to hashing.
</td></tr>
</table>

<hr size="6">
<a name="Available-hash-algorithms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hashing" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Working-with-hash-algorithms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Hashing" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Available-hash-algorithms-1"></a>
<h2 class="section">7.1 Available hash algorithms</h2>

<a name="index-SHA_002d1"></a>
<a name="index-SHA_002d224_002c-SHA_002d256_002c-SHA_002d384_002c-SHA_002d512_002c-SHA_002d512_002f224_002c-SHA_002d512_002f256"></a>
<a name="index-SHA3_002d224_002c-SHA3_002d256_002c-SHA3_002d384_002c-SHA3_002d512_002c-SHAKE128_002c-SHAKE256"></a>
<a name="index-RIPE_002dMD_002d160"></a>
<a name="index-MD2_002c-MD4_002c-MD5"></a>
<a name="index-TIGER_002c-TIGER1_002c-TIGER2"></a>
<a name="index-HAVAL"></a>
<a name="index-SM3"></a>
<a name="index-Whirlpool"></a>
<a name="index-BLAKE2b_002d512_002c-BLAKE2b_002d384_002c-BLAKE2b_002d256_002c-BLAKE2b_002d160"></a>
<a name="index-BLAKE2s_002d256_002c-BLAKE2s_002d224_002c-BLAKE2s_002d160_002c-BLAKE2s_002d128"></a>
<a name="index-CRC32"></a>
<dl compact="compact">
<dt> <code>GCRY_MD_NONE</code></dt>
<dd><p>This is not a real algorithm but used by some functions as an error
return value.  This constant is guaranteed to have the value <code>0</code>.
</p>
</dd>
<dt> <code>GCRY_MD_SHA1</code></dt>
<dd><p>This is the SHA-1 algorithm which yields a message digest of 20 bytes.
Note that SHA-1 begins to show some weaknesses and it is suggested to
fade out its use if strong cryptographic properties are required.
</p>
</dd>
<dt> <code>GCRY_MD_RMD160</code></dt>
<dd><p>This is the 160 bit version of the RIPE message digest (RIPE-MD-160).
Like SHA-1 it also yields a digest of 20 bytes.  This algorithm shares a
lot of design properties with SHA-1 and thus it is advisable not to use
it for new protocols.
</p>
</dd>
<dt> <code>GCRY_MD_MD5</code></dt>
<dd><p>This is the well known MD5 algorithm, which yields a message digest of
16 bytes.  Note that the MD5 algorithm has severe weaknesses, for
example it is easy to compute two messages yielding the same hash
(collision attack).  The use of this algorithm is only justified for
non-cryptographic application.
</p>

</dd>
<dt> <code>GCRY_MD_MD4</code></dt>
<dd><p>This is the MD4 algorithm, which yields a message digest of 16 bytes.
This algorithm has severe weaknesses and should not be used.
</p>
</dd>
<dt> <code>GCRY_MD_MD2</code></dt>
<dd><p>This is a reserved identifier for MD-2; there is no implementation yet.
This algorithm has severe weaknesses and should not be used.
</p>
</dd>
<dt> <code>GCRY_MD_TIGER</code></dt>
<dd><p>This is the TIGER/192 algorithm which yields a message digest of 24
bytes.  Actually this is a variant of TIGER with a different output
print order as used by GnuPG up to version 1.3.2.
</p>
</dd>
<dt> <code>GCRY_MD_TIGER1</code></dt>
<dd><p>This is the TIGER variant as used by the NESSIE project.  It uses the
most commonly used output print order.
</p>
</dd>
<dt> <code>GCRY_MD_TIGER2</code></dt>
<dd><p>This is another variant of TIGER with a different padding scheme.
</p>

</dd>
<dt> <code>GCRY_MD_HAVAL</code></dt>
<dd><p>This is an reserved value for the HAVAL algorithm with 5 passes and 160
bits. It yields a message digest of 20 bytes.  Note that there is no
implementation yet available.
</p>
</dd>
<dt> <code>GCRY_MD_SHA224</code></dt>
<dd><p>This is the SHA-224 algorithm which yields a message digest of 28 bytes.
See Change Notice 1 for FIPS 180-2 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA256</code></dt>
<dd><p>This is the SHA-256 algorithm which yields a message digest of 32 bytes.
See FIPS 180-2 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA384</code></dt>
<dd><p>This is the SHA-384 algorithm which yields a message digest of 48 bytes.
See FIPS 180-2 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA512</code></dt>
<dd><p>This is the SHA-512 algorithm which yields a message digest of 64 bytes.
See FIPS 180-2 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA512_224</code></dt>
<dd><p>This is the SHA-512/224 algorithm which yields a message digest of 28 bytes.
See FIPS 180-4 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA512_256</code></dt>
<dd><p>This is the SHA-512/256 algorithm which yields a message digest of 32 bytes.
See FIPS 180-4 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA3_224</code></dt>
<dd><p>This is the SHA3-224 algorithm which yields a message digest of 28 bytes.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA3_256</code></dt>
<dd><p>This is the SHA3-256 algorithm which yields a message digest of 32 bytes.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA3_384</code></dt>
<dd><p>This is the SHA3-384 algorithm which yields a message digest of 48 bytes.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHA3_512</code></dt>
<dd><p>This is the SHA3-512 algorithm which yields a message digest of 64 bytes.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHAKE128</code></dt>
<dd><p>This is the SHAKE128 extendable-output function (XOF) algorithm with 128 bit
security strength.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SHAKE256</code></dt>
<dd><p>This is the SHAKE256 extendable-output function (XOF) algorithm with 256 bit
security strength.
See FIPS 202 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_CRC32</code></dt>
<dd><p>This is the ISO 3309 and ITU-T V.42 cyclic redundancy check.  It yields
an output of 4 bytes.  Note that this is not a hash algorithm in the
cryptographic sense.
</p>
</dd>
<dt> <code>GCRY_MD_CRC32_RFC1510</code></dt>
<dd><p>This is the above cyclic redundancy check function, as modified by RFC
1510.  It yields an output of 4 bytes.  Note that this is not a hash
algorithm in the cryptographic sense.
</p>
</dd>
<dt> <code>GCRY_MD_CRC24_RFC2440</code></dt>
<dd><p>This is the OpenPGP cyclic redundancy check function.  It yields an
output of 3 bytes.  Note that this is not a hash algorithm in the
cryptographic sense.
</p>
</dd>
<dt> <code>GCRY_MD_WHIRLPOOL</code></dt>
<dd><p>This is the Whirlpool algorithm which yields a message digest of 64
bytes.
</p>
</dd>
<dt> <code>GCRY_MD_GOSTR3411_94</code></dt>
<dd><p>This is the hash algorithm described in GOST R 34.11-94 which yields a
message digest of 32 bytes.
</p>
</dd>
<dt> <code>GCRY_MD_STRIBOG256</code></dt>
<dd><p>This is the 256-bit version of hash algorithm described in GOST R 34.11-2012
which yields a message digest of 32 bytes.
</p>
</dd>
<dt> <code>GCRY_MD_STRIBOG512</code></dt>
<dd><p>This is the 512-bit version of hash algorithm described in GOST R 34.11-2012
which yields a message digest of 64 bytes.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2B_512</code></dt>
<dd><p>This is the BLAKE2b-512 algorithm which yields a message digest of 64 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2B_384</code></dt>
<dd><p>This is the BLAKE2b-384 algorithm which yields a message digest of 48 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2B_256</code></dt>
<dd><p>This is the BLAKE2b-256 algorithm which yields a message digest of 32 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2B_160</code></dt>
<dd><p>This is the BLAKE2b-160 algorithm which yields a message digest of 20 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2S_256</code></dt>
<dd><p>This is the BLAKE2s-256 algorithm which yields a message digest of 32 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2S_224</code></dt>
<dd><p>This is the BLAKE2s-224 algorithm which yields a message digest of 28 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2S_160</code></dt>
<dd><p>This is the BLAKE2s-160 algorithm which yields a message digest of 20 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_BLAKE2S_128</code></dt>
<dd><p>This is the BLAKE2s-128 algorithm which yields a message digest of 16 bytes.
See RFC 7693 for the specification.
</p>
</dd>
<dt> <code>GCRY_MD_SM3</code></dt>
<dd><p>This is the SM3 algorithm which yields a message digest of 32 bytes.
</p>
</dd>
</dl>

<hr size="6">
<a name="Working-with-hash-algorithms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Available-hash-algorithms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Hashing" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Working-with-hash-algorithms-1"></a>
<h2 class="section">7.2 Working with hash algorithms</h2>

<p>To use most of these function it is necessary to create a context;
this is done using:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fopen"></a><u>Function:</u> gcry_error_t <b>gcry_md_open</b><i> (gcry_md_hd_t *<var>hd</var>, int <var>algo</var>, unsigned int <var>flags</var>)</i></dt>
<dd>
<p>Create a message digest object for algorithm <var>algo</var>.  <var>flags</var>
may be given as an bitwise OR of constants described below.  <var>algo</var>
may be given as <code>0</code> if the algorithms to use are later set using
<code>gcry_md_enable</code>. <var>hd</var> is guaranteed to either receive a valid
handle or <code>NULL</code>.
</p>
<p>For a list of supported algorithms, see <a href="#Available-hash-algorithms">Available hash algorithms</a>.
</p>
<p>The flags allowed for <var>mode</var> are:
</p>
<dl compact="compact">
<dt> <code>GCRY_MD_FLAG_SECURE</code></dt>
<dd><p>Allocate all buffers and the resulting digest in &quot;secure memory&quot;.  Use
this if the hashed data is highly confidential.
</p>
</dd>
<dt> <code>GCRY_MD_FLAG_HMAC</code></dt>
<dd><a name="index-HMAC"></a>
<p>Turn the algorithm into a HMAC message authentication algorithm.  This
only works if just one algorithm is enabled for the handle and that
algorithm is not an extendable-output function.  Note that the function
<code>gcry_md_setkey</code> must be used to set the MAC key.  The size of the
MAC is equal to the message digest of the underlying hash algorithm.
If you want CBC message authentication codes based on a cipher,
see <a href="#Working-with-cipher-handles">Working with cipher handles</a>.
</p>
</dd>
<dt> <code>GCRY_MD_FLAG_BUGEMU1</code></dt>
<dd><a name="index-bug-emulation"></a>
<p>Versions of Libgcrypt before 1.6.0 had a bug in the Whirlpool code
which led to a wrong result for certain input sizes and write
patterns.  Using this flag emulates that bug.  This may for example be
useful for applications which use Whirlpool as part of their key
generation.  It is strongly suggested to use this flag only if really
needed; and if possible, the data should be re-processed using the
regular Whirlpool algorithm.
</p>
<p>Note that this flag works for the entire hash context.  If need
arises, it may be used to enable bug emulation for other hash
algorithms.  Thus you should not use this flag for a multi-algorithm
hash context.
</p>

</dd>
</dl>

<p>You may use the function <code>gcry_md_is_enabled</code> to later check
whether an algorithm has been enabled.
</p>
</dd></dl>

<p>If you want to calculate several hash algorithms at the same time, you
have to use the following function right after the <code>gcry_md_open</code>:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fenable"></a><u>Function:</u> gcry_error_t <b>gcry_md_enable</b><i> (gcry_md_hd_t <var>h</var>, int <var>algo</var>)</i></dt>
<dd>
<p>Add the message digest algorithm <var>algo</var> to the digest object
described by handle <var>h</var>.  Duplicated enabling of algorithms is
detected and ignored.
</p></dd></dl>

<p>If the flag <code>GCRY_MD_FLAG_HMAC</code> was used, the key for the MAC must
be set using the function:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fsetkey"></a><u>Function:</u> gcry_error_t <b>gcry_md_setkey</b><i> (gcry_md_hd_t <var>h</var>, const void *<var>key</var>, size_t <var>keylen</var>)</i></dt>
<dd>
<p>For use with the HMAC feature or BLAKE2 keyed hash, set the MAC key to
the value of <var>key</var> of length <var>keylen</var> bytes.  For HMAC, there
is no restriction on the length of the key.  For keyed BLAKE2b hash,
length of the key must be in the range 1 to 64 bytes.  For keyed
BLAKE2s hash, length of the key must be in the range 1 to 32 bytes.
</p>
</dd></dl>


<p>After you are done with the hash calculation, you should release the
resources by using:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fclose"></a><u>Function:</u> void <b>gcry_md_close</b><i> (gcry_md_hd_t <var>h</var>)</i></dt>
<dd>
<p>Release all resources of hash context <var>h</var>.  <var>h</var> should not be
used after a call to this function.  A <code>NULL</code> passed as <var>h</var> is
ignored.  The function also zeroises all sensitive information
associated with this handle.
</p>

</dd></dl>

<p>Often you have to do several hash operations using the same algorithm.
To avoid the overhead of creating and releasing context, a reset function
is provided:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005freset"></a><u>Function:</u> void <b>gcry_md_reset</b><i> (gcry_md_hd_t <var>h</var>)</i></dt>
<dd>
<p>Reset the current context to its initial state.  This is effectively
identical to a close followed by an open and enabling all currently
active algorithms.
</p></dd></dl>


<p>Often it is necessary to start hashing some data and then continue to
hash different data.  To avoid hashing the same data several times (which
might not even be possible if the data is received from a pipe), a
snapshot of the current hash context can be taken and turned into a new
context:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fcopy"></a><u>Function:</u> gcry_error_t <b>gcry_md_copy</b><i> (gcry_md_hd_t *<var>handle_dst</var>, gcry_md_hd_t <var>handle_src</var>)</i></dt>
<dd>
<p>Create a new digest object as an exact copy of the object described by
handle <var>handle_src</var> and store it in <var>handle_dst</var>.  The context
is not reset and you can continue to hash data using this context and
independently using the original context.
</p></dd></dl>


<p>Now that we have prepared everything to calculate hashes, it is time to
see how it is actually done.  There are two ways for this: one to
update the hash with a block of memory and one macro to update the hash
by just one character.  Both methods can be used on the same hash context.
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fwrite"></a><u>Function:</u> void <b>gcry_md_write</b><i> (gcry_md_hd_t <var>h</var>, const void *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p>Pass <var>length</var> bytes of the data in <var>buffer</var> to the digest object
with handle <var>h</var> to update the digest values. This
function should be used for large blocks of data.  If this function is
used after the context has been finalized, it will keep on pushing
the data through the algorithm specific transform function and change
the context; however the results are not meaningful and this feature
is only available to mitigate timing attacks.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmd_005fputc"></a><u>Function:</u> void <b>gcry_md_putc</b><i> (gcry_md_hd_t <var>h</var>, int <var>c</var>)</i></dt>
<dd>
<p>Pass the byte in <var>c</var> to the digest object with handle <var>h</var> to
update the digest value.  This is an efficient function, implemented as
a macro to buffer the data before an actual update.
</p></dd></dl>

<p>The semantics of the hash functions do not provide for reading out intermediate
message digests because the calculation must be finalized first.  This
finalization may for example include the number of bytes hashed in the
message digest or some padding.
</p>
<dl>
<dt><a name="index-gcry_005fmd_005ffinal"></a><u>Function:</u> void <b>gcry_md_final</b><i> (gcry_md_hd_t <var>h</var>)</i></dt>
<dd>
<p>Finalize the message digest calculation.  This is not really needed
because <code>gcry_md_read</code> and <code>gcry_md_extract</code> do this implicitly.
After this has been done no further updates (by means of <code>gcry_md_write</code>
or <code>gcry_md_putc</code>) should be done; However, to mitigate timing
attacks it is sometimes useful to keep on updating the context after
having stored away the actual digest.  Only the first call to this function
has an effect. It is implemented as a macro.
</p></dd></dl>

<p>The way to read out the calculated message digest is by using the
function:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fread"></a><u>Function:</u> unsigned char * <b>gcry_md_read</b><i> (gcry_md_hd_t <var>h</var>, int <var>algo</var>)</i></dt>
<dd>
<p><code>gcry_md_read</code> returns the message digest after finalizing the
calculation.  This function may be used as often as required but it will
always return the same value for one handle.  The returned message digest
is allocated within the message context and therefore valid until the
handle is released or reset-ed (using <code>gcry_md_close</code> or
<code>gcry_md_reset</code>) or it has been updated as a mitigation measure
against timing attacks.  <var>algo</var> may be given as 0 to return the only
enabled message digest or it may specify one of the enabled algorithms.
The function does return <code>NULL</code> if the requested algorithm has not
been enabled.
</p></dd></dl>

<p>The way to read output of extendable-output function is by using the
function:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fextract"></a><u>Function:</u> gpg_err_code_t <b>gcry_md_extract</b><i> (gcry_md_hd_t <var>h</var>,   int <var>algo</var>, void *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p><code>gcry_mac_read</code> returns output from extendable-output function.
This function may be used as often as required to generate more output
byte stream from the algorithm.  Function extracts the new output bytes
to <var>buffer</var> of the length <var>length</var>.  Buffer will be fully
populated with new output.  <var>algo</var> may be given as 0 to return the only
enabled message digest or it may specify one of the enabled algorithms.
The function does return non-zero value if the requested algorithm has not
been enabled.
</p></dd></dl>

<p>Because it is often necessary to get the message digest of blocks of
memory, two fast convenience function are available for this task:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fhash_005fbuffers"></a><u>Function:</u> gpg_err_code_t <b>gcry_md_hash_buffers</b><i> (   int <var>algo</var>, unsigned int <var>flags</var>,   void *<var>digest</var>,   const gcry_buffer_t *<var>iov</var>, int <var>iovcnt</var> )</i></dt>
<dd>
<p><code>gcry_md_hash_buffers</code> is a shortcut function to calculate a
message digest from several buffers.  This function does not require a
context and immediately returns the message digest of the data
described by <var>iov</var> and <var>iovcnt</var>.  <var>digest</var> must be
allocated by the caller, large enough to hold the message digest
yielded by the the specified algorithm <var>algo</var>.  This required size
may be obtained by using the function <code>gcry_md_get_algo_dlen</code>.
</p>
<p><var>iov</var> is an array of buffer descriptions with <var>iovcnt</var> items.
The caller should zero out the structures in this array and for each
array item set the fields <code>.data</code> to the address of the data to
be hashed, <code>.len</code> to number of bytes to be hashed.  If <var>.off</var>
is also set, the data is taken starting at <var>.off</var> bytes from the
begin of the buffer.  The field <code>.size</code> is not used.
</p>
<p>The only supported flag value for <var>flags</var> is
<var>GCRY_MD_FLAG_HMAC</var> which turns this function into a HMAC
function; the first item in <var>iov</var> is then used as the key.
</p>
<p>On success the function returns 0 and stores the resulting hash or MAC
at <var>digest</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmd_005fhash_005fbuffer"></a><u>Function:</u> void <b>gcry_md_hash_buffer</b><i> (int <var>algo</var>, void *<var>digest</var>, const void *<var>buffer</var>, size_t <var>length</var>);</i></dt>
<dd>
<p><code>gcry_md_hash_buffer</code> is a shortcut function to calculate a message
digest of a buffer.  This function does not require a context and
immediately returns the message digest of the <var>length</var> bytes at
<var>buffer</var>.  <var>digest</var> must be allocated by the caller, large
enough to hold the message digest yielded by the specified algorithm
<var>algo</var>.  This required size may be obtained by using the function
<code>gcry_md_get_algo_dlen</code>.
</p>
<p>Note that in contrast to <code>gcry_md_hash_buffers</code> this function
will abort the process if an unavailable algorithm is used.
</p></dd></dl>


<p>Hash algorithms are identified by internal algorithm numbers (see
<code>gcry_md_open</code> for a list).  However, in most applications they are
used by names, so two functions are available to map between string
representations and hash algorithm identifiers.
</p>
<dl>
<dt><a name="index-gcry_005fmd_005falgo_005fname"></a><u>Function:</u> const char * <b>gcry_md_algo_name</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Map the digest algorithm id <var>algo</var> to a string representation of the
algorithm name.  For unknown algorithms this function returns the
string <code>&quot;?&quot;</code>.  This function should not be used to test for the
availability of an algorithm.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmd_005fmap_005fname"></a><u>Function:</u> int <b>gcry_md_map_name</b><i> (const char *<var>name</var>)</i></dt>
<dd>
<p>Map the algorithm with <var>name</var> to a digest algorithm identifier.
Returns 0 if the algorithm name is not known.  Names representing
<acronym>ASN.1</acronym> object identifiers are recognized if the <acronym>IETF</acronym>
dotted format is used and the OID is prefixed with either &quot;<code>oid.</code>&quot;
or &quot;<code>OID.</code>&quot;.  For a list of supported OIDs, see the source code at
&lsquo;<tt>cipher/md.c</tt>&rsquo;. This function should not be used to test for the
availability of an algorithm.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmd_005fget_005fasnoid"></a><u>Function:</u> gcry_error_t <b>gcry_md_get_asnoid</b><i> (int <var>algo</var>, void *<var>buffer</var>, size_t *<var>length</var>)</i></dt>
<dd>
<p>Return an DER encoded ASN.1 OID for the algorithm <var>algo</var> in the
user allocated <var>buffer</var>. <var>length</var> must point to variable with
the available size of <var>buffer</var> and receives after return the
actual size of the returned OID.  The returned error code may be
<code>GPG_ERR_TOO_SHORT</code> if the provided buffer is too short to receive
the OID; it is possible to call the function with <code>NULL</code> for
<var>buffer</var> to have it only return the required size.  The function
returns 0 on success.
</p>
</dd></dl>


<p>To test whether an algorithm is actually available for use, the
following macro should be used:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005ftest_005falgo"></a><u>Function:</u> gcry_error_t <b>gcry_md_test_algo</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>The macro returns 0 if the algorithm <var>algo</var> is available for use.
</p></dd></dl>

<p>If the length of a message digest is not known, it can be retrieved
using the following function:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fget_005falgo_005fdlen"></a><u>Function:</u> unsigned int <b>gcry_md_get_algo_dlen</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Retrieve the length in bytes of the digest yielded by algorithm
<var>algo</var>.  This is often used prior to <code>gcry_md_read</code> to allocate
sufficient memory for the digest.
</p></dd></dl>


<p>In some situations it might be hard to remember the algorithm used for
the ongoing hashing. The following function might be used to get that
information:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fget_005falgo"></a><u>Function:</u> int <b>gcry_md_get_algo</b><i> (gcry_md_hd_t <var>h</var>)</i></dt>
<dd>
<p>Retrieve the algorithm used with the handle <var>h</var>.  Note that this
does not work reliable if more than one algorithm is enabled in <var>h</var>.
</p></dd></dl>

<p>The following macro might also be useful:
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fis_005fsecure"></a><u>Function:</u> int <b>gcry_md_is_secure</b><i> (gcry_md_hd_t <var>h</var>)</i></dt>
<dd>
<p>This function returns true when the digest object <var>h</var> is allocated
in &quot;secure memory&quot;; i.e. <var>h</var> was created with the
<code>GCRY_MD_FLAG_SECURE</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmd_005fis_005fenabled"></a><u>Function:</u> int <b>gcry_md_is_enabled</b><i> (gcry_md_hd_t <var>h</var>, int <var>algo</var>)</i></dt>
<dd>
<p>This function returns true when the algorithm <var>algo</var> has been
enabled for the digest object <var>h</var>.
</p></dd></dl>



<p>Tracking bugs related to hashing is often a cumbersome task which
requires to add a lot of printf statements into the code.
Libgcrypt provides an easy way to avoid this.  The actual data
hashed can be written to files on request.
</p>
<dl>
<dt><a name="index-gcry_005fmd_005fdebug"></a><u>Function:</u> void <b>gcry_md_debug</b><i> (gcry_md_hd_t <var>h</var>, const char *<var>suffix</var>)</i></dt>
<dd>
<p>Enable debugging for the digest object with handle <var>h</var>.  This
creates files named &lsquo;<tt>dbgmd-&lt;n&gt;.&lt;string&gt;</tt>&rsquo; while doing the
actual hashing.  <var>suffix</var> is the string part in the filename.  The
number is a counter incremented for each new hashing.  The data in the
file is the raw data as passed to <code>gcry_md_write</code> or
<code>gcry_md_putc</code>.  If <code>NULL</code> is used for <var>suffix</var>, the
debugging is stopped and the file closed.  This is only rarely required
because <code>gcry_md_close</code> implicitly stops debugging.
</p></dd></dl>



<hr size="6">
<a name="Message-Authentication-Codes"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Working-with-hash-algorithms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Available-MAC-algorithms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Hashing" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Key-Derivation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Message-Authentication-Codes-1"></a>
<h1 class="chapter">8. Message Authentication Codes</h1>

<p>Libgcrypt provides an easy to use and consistent interface for generating
Message Authentication Codes (MAC). MAC generation is buffered and interface
similar to the one used with hash algorithms. The programming model follows
an open/process/close paradigm and is in that similar to other building blocks
provided by Libgcrypt.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   List of MAC algorithms supported by the library.
</td></tr>
<tr><td align="left" valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  List of functions related to MAC algorithms.
</td></tr>
</table>

<hr size="6">
<a name="Available-MAC-algorithms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Working-with-MAC-algorithms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Key-Derivation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Available-MAC-algorithms-1"></a>
<h2 class="section">8.1 Available MAC algorithms</h2>

<a name="index-HMAC_002dSHA_002d1"></a>
<a name="index-HMAC_002dSHA_002d224_002c-HMAC_002dSHA_002d256_002c-HMAC_002dSHA_002d384_002c-HMAC_002dSHA_002d512"></a>
<a name="index-HMAC_002dSHA_002d512_002f224_002c-HMAC_002dSHA_002d512_002f256"></a>
<a name="index-HMAC_002dSHA3_002d224_002c-HMAC_002dSHA3_002d256_002c-HMAC_002dSHA3_002d384_002c-HMAC_002dSHA3_002d512"></a>
<a name="index-HMAC_002dRIPE_002dMD_002d160"></a>
<a name="index-HMAC_002dMD2_002c-HMAC_002dMD4_002c-HMAC_002dMD5"></a>
<a name="index-HMAC_002dTIGER1"></a>
<a name="index-HMAC_002dSM3"></a>
<a name="index-HMAC_002dWhirlpool"></a>
<a name="index-HMAC_002dStribog_002d256_002c-HMAC_002dStribog_002d512"></a>
<a name="index-HMAC_002dGOSTR_002d3411_002d94"></a>
<a name="index-HMAC_002dBLAKE2s_002c-HMAC_002dBLAKE2b"></a>
<dl compact="compact">
<dt> <code>GCRY_MAC_NONE</code></dt>
<dd><p>This is not a real algorithm but used by some functions as an error
return value.  This constant is guaranteed to have the value <code>0</code>.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA256</code></dt>
<dd><p>This is keyed-hash message authentication code (HMAC) message authentication
algorithm based on the SHA-256 hash algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA224</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-224 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA512</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-512 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA384</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-384 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA3_256</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA3-256 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA3_224</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA3-224 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA3_512</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA3-512 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA3_384</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA3-384 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA512_224</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-512/224 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA512_256</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-512/256 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SHA1</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SHA-1 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_MD5</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the MD5 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_MD4</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the MD4 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_RMD160</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the RIPE-MD-160 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_WHIRLPOOL</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the WHIRLPOOL hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_GOSTR3411_94</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the GOST R 34.11-94 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_STRIBOG256</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the 256-bit hash
algorithm described in GOST R 34.11-2012.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_STRIBOG512</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the 512-bit hash
algorithm described in GOST R 34.11-2012.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2B_512</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2b-512 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2B_384</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2b-384 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2B_256</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2b-256 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2B_160</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2b-160 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2S_256</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2s-256 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2S_224</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2s-224 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2S_160</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2s-160 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_BLAKE2S_128</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the BLAKE2s-128 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_HMAC_SM3</code></dt>
<dd><p>This is HMAC message authentication algorithm based on the SM3 hash
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_AES</code></dt>
<dd><p>This is CMAC (Cipher-based MAC) message authentication algorithm based on
the AES block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_3DES</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the three-key EDE
Triple-DES block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_CAMELLIA</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the Camellia block cipher
algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_CAST5</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the CAST128-5
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_BLOWFISH</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the Blowfish
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_TWOFISH</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the Twofish
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_SERPENT</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the Serpent
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_SEED</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the SEED
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_RFC2268</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the Ron&rsquo;s Cipher 2
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_IDEA</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the IDEA
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_GOST28147</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the GOST 28147-89
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_CMAC_SM4</code></dt>
<dd><p>This is CMAC message authentication algorithm based on the SM4
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_GMAC_AES</code></dt>
<dd><p>This is GMAC (GCM mode based MAC) message authentication algorithm based on
the AES block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_GMAC_CAMELLIA</code></dt>
<dd><p>This is GMAC message authentication algorithm based on the Camellia
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_GMAC_TWOFISH</code></dt>
<dd><p>This is GMAC message authentication algorithm based on the Twofish
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_GMAC_SERPENT</code></dt>
<dd><p>This is GMAC message authentication algorithm based on the Serpent
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_GMAC_SEED</code></dt>
<dd><p>This is GMAC message authentication algorithm based on the SEED
block cipher algorithm.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305</code></dt>
<dd><p>This is plain Poly1305 message authentication algorithm, used with
one-time key.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305_AES</code></dt>
<dd><p>This is Poly1305-AES message authentication algorithm, used with
key and one-time nonce.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305_CAMELLIA</code></dt>
<dd><p>This is Poly1305-Camellia message authentication algorithm, used with
key and one-time nonce.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305_TWOFISH</code></dt>
<dd><p>This is Poly1305-Twofish message authentication algorithm, used with
key and one-time nonce.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305_SERPENT</code></dt>
<dd><p>This is Poly1305-Serpent message authentication algorithm, used with
key and one-time nonce.
</p>
</dd>
<dt> <code>GCRY_MAC_POLY1305_SEED</code></dt>
<dd><p>This is Poly1305-SEED message authentication algorithm, used with
key and one-time nonce.
</p>
</dd>
<dt> <code>GCRY_MAC_GOST28147_IMIT</code></dt>
<dd><p>This is MAC construction defined in GOST 28147-89 (see RFC 5830 Section 8).
</p>
</dd>
</dl>

<hr size="6">
<a name="Working-with-MAC-algorithms"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Available-MAC-algorithms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Key-Derivation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Key-Derivation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Working-with-MAC-algorithms-1"></a>
<h2 class="section">8.2 Working with MAC algorithms</h2>

<p>To use most of these function it is necessary to create a context;
this is done using:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fopen"></a><u>Function:</u> gcry_error_t <b>gcry_mac_open</b><i> (gcry_mac_hd_t *<var>hd</var>, int <var>algo</var>, unsigned int <var>flags</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Create a MAC object for algorithm <var>algo</var>. <var>flags</var> may be given as a
bitwise OR of constants described below. <var>hd</var> is guaranteed to either
receive a valid handle or <code>NULL</code>. <var>ctx</var> is context object to associate MAC
object with. <var>ctx</var> maybe set to <code>NULL</code>.
</p>
<p>For a list of supported algorithms, see <a href="#Available-MAC-algorithms">Available MAC algorithms</a>.
</p>
<p>The flags allowed for <var>mode</var> are:
</p>
<dl compact="compact">
<dt> <code>GCRY_MAC_FLAG_SECURE</code></dt>
<dd><p>Allocate all buffers and the resulting MAC in &quot;secure memory&quot;.  Use this if the
MAC data is highly confidential.
</p>
</dd>
</dl>

</dd></dl>


<p>In order to use a handle for performing MAC algorithm operations, a
&lsquo;key&rsquo; has to be set first:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fsetkey"></a><u>Function:</u> gcry_error_t <b>gcry_mac_setkey</b><i> (gcry_mac_hd_t <var>h</var>, const void *<var>key</var>, size_t <var>keylen</var>)</i></dt>
<dd>
<p>Set the MAC key to the value of <var>key</var> of length <var>keylen</var> bytes. With
HMAC algorithms, there is no restriction on the length of the key. With CMAC
algorithms, the length of the key is restricted to those supported by the
underlying block cipher.
</p></dd></dl>


<p>GMAC algorithms and Poly1305-with-cipher algorithms need initialization vector to be set,
which can be performed with function:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fsetiv"></a><u>Function:</u> gcry_error_t <b>gcry_mac_setiv</b><i> (gcry_mac_hd_t <var>h</var>, const void *<var>iv</var>, size_t <var>ivlen</var>)</i></dt>
<dd>
<p>Set the IV to the value of <var>iv</var> of length <var>ivlen</var> bytes.
</p></dd></dl>


<p>After you are done with the MAC calculation, you should release the resources
by using:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fclose"></a><u>Function:</u> void <b>gcry_mac_close</b><i> (gcry_mac_hd_t <var>h</var>)</i></dt>
<dd>
<p>Release all resources of MAC context <var>h</var>.  <var>h</var> should not be
used after a call to this function.  A <code>NULL</code> passed as <var>h</var> is
ignored.  The function also clears all sensitive information associated
with this handle.
</p></dd></dl>


<p>Often you have to do several MAC operations using the same algorithm.
To avoid the overhead of creating and releasing context, a reset function
is provided:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005freset"></a><u>Function:</u> gcry_error_t <b>gcry_mac_reset</b><i> (gcry_mac_hd_t <var>h</var>)</i></dt>
<dd>
<p>Reset the current context to its initial state. This is effectively identical
to a close followed by an open and setting same key.
</p>
<p>Note that gcry_mac_reset is implemented as a macro.
</p></dd></dl>


<p>Now that we have prepared everything to calculate MAC, it is time to
see how it is actually done.
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fwrite"></a><u>Function:</u> gcry_error_t <b>gcry_mac_write</b><i> (gcry_mac_hd_t <var>h</var>, const void *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p>Pass <var>length</var> bytes of the data in <var>buffer</var> to the MAC object
with handle <var>h</var> to update the MAC values.  If this function is
used after the context has been finalized, it will keep on pushing the
data through the algorithm specific transform function and thereby
change the context; however the results are not meaningful and this
feature is only available to mitigate timing attacks.
</p></dd></dl>

<p>The way to read out the calculated MAC is by using the function:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fread"></a><u>Function:</u> gcry_error_t <b>gcry_mac_read</b><i> (gcry_mac_hd_t <var>h</var>, void *<var>buffer</var>, size_t *<var>length</var>)</i></dt>
<dd>
<p><code>gcry_mac_read</code> returns the MAC after finalizing the calculation.
Function copies the resulting MAC value to <var>buffer</var> of the length
<var>length</var>. If <var>length</var> is larger than length of resulting MAC value,
then length of MAC is returned through <var>length</var>.
</p></dd></dl>

<p>To compare existing MAC value with recalculated MAC, one is to use the function:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fverify"></a><u>Function:</u> gcry_error_t <b>gcry_mac_verify</b><i> (gcry_mac_hd_t <var>h</var>, void *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p><code>gcry_mac_verify</code> finalizes MAC calculation and compares result with
<var>length</var> bytes of data in <var>buffer</var>. Error code <code>GPG_ERR_CHECKSUM</code>
is returned if the MAC value in the buffer <var>buffer</var> does not match
the MAC calculated in object <var>h</var>.
</p></dd></dl>


<p>In some situations it might be hard to remember the algorithm used for
the MAC calculation. The following function might be used to get that
information:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fget_005falgo"></a><u>Function:</u> int <b>gcry_mac_get_algo</b><i> (gcry_mac_hd_t <var>h</var>)</i></dt>
<dd>
<p>Retrieve the algorithm used with the handle <var>h</var>.
</p></dd></dl>



<p>MAC algorithms are identified by internal algorithm numbers (see
<code>gcry_mac_open</code> for a list).  However, in most applications they are
used by names, so two functions are available to map between string
representations and MAC algorithm identifiers.
</p>
<dl>
<dt><a name="index-gcry_005fmac_005falgo_005fname"></a><u>Function:</u> const char * <b>gcry_mac_algo_name</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Map the MAC algorithm id <var>algo</var> to a string representation of the
algorithm name.  For unknown algorithms this function returns the
string <code>&quot;?&quot;</code>.  This function should not be used to test for the
availability of an algorithm.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmac_005fmap_005fname"></a><u>Function:</u> int <b>gcry_mac_map_name</b><i> (const char *<var>name</var>)</i></dt>
<dd>
<p>Map the algorithm with <var>name</var> to a MAC algorithm identifier.
Returns 0 if the algorithm name is not known. This function should not
be used to test for the availability of an algorithm.
</p></dd></dl>


<p>To test whether an algorithm is actually available for use, the
following macro should be used:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005ftest_005falgo"></a><u>Function:</u> gcry_error_t <b>gcry_mac_test_algo</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>The macro returns 0 if the MAC algorithm <var>algo</var> is available for use.
</p></dd></dl>


<p>If the length of a message digest is not known, it can be retrieved
using the following function:
</p>
<dl>
<dt><a name="index-gcry_005fmac_005fget_005falgo_005fmaclen"></a><u>Function:</u> unsigned int <b>gcry_mac_get_algo_maclen</b><i> (int <var>algo</var>)</i></dt>
<dd>
<p>Retrieve the length in bytes of the MAC yielded by algorithm <var>algo</var>.
This is often used prior to <code>gcry_mac_read</code> to allocate sufficient memory
for the MAC value. On error <code>0</code> is returned.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmac_005fget_005falgo_005fkeylen"></a><u>Function:</u> unsigned int <b>gcry_mac_get_algo_keylen</b><i> (<var>algo</var>)</i></dt>
<dd>
<p>This function returns length of the key for MAC algorithm <var>algo</var>.  If
the algorithm supports multiple key lengths, the default supported key
length is returned.  On error <code>0</code> is returned.  The key length is
returned as number of octets.
</p></dd></dl>



<hr size="6">
<a name="Key-Derivation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Working-with-MAC-algorithms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Message-Authentication-Codes" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Key-Derivation-1"></a>
<h1 class="chapter">9. Key Derivation</h1>

<p><acronym>Libgcypt</acronym> provides a general purpose function to derive keys
from strings.
</p>
<dl>
<dt><a name="index-gcry_005fkdf_005fderive"></a><u>Function:</u> gpg_error_t <b>gcry_kdf_derive</b><i> (             const void *<var>passphrase</var>, size_t <var>passphraselen</var>,             int <var>algo</var>, int <var>subalgo</var>,             const void *<var>salt</var>, size_t <var>saltlen</var>,             unsigned long <var>iterations</var>,             size_t <var>keysize</var>, void *<var>keybuffer</var> )</i></dt>
<dd>

<p>Derive a key from a passphrase.  <var>keysize</var> gives the requested
size of the key in octets.  <var>keybuffer</var> is a caller provided
buffer filled on success with the derived key.  The input passphrase
is taken from <var>passphrase</var> which is an arbitrary memory buffer of
<var>passphraselen</var> octets.  <var>algo</var> specifies the KDF algorithm to
use; see below.  <var>subalgo</var> specifies an algorithm used internally
by the KDF algorithms; this is usually a hash algorithm but certain
KDF algorithms may use it differently.  <var>salt</var> is a salt of length
<var>saltlen</var> octets, as needed by most KDF algorithms.
<var>iterations</var> is a positive integer parameter to most KDFs.
</p>
<p>On success 0 is returned; on failure an error code.
</p>
<p>Currently supported KDFs (parameter <var>algo</var>):
</p>
<dl compact="compact">
<dt> <code>GCRY_KDF_SIMPLE_S2K</code></dt>
<dd><p>The OpenPGP simple S2K algorithm (cf. RFC4880).  Its use is strongly
deprecated.  <var>salt</var> and <var>iterations</var> are not needed and may be
passed as <code>NULL</code>/<code>0</code>.
</p>
</dd>
<dt> <code>GCRY_KDF_SALTED_S2K</code></dt>
<dd><p>The OpenPGP salted S2K algorithm (cf. RFC4880).  Usually not used.
<var>iterations</var> is not needed and may be passed as <code>0</code>.  <var>saltlen</var>
must be given as 8.
</p>
</dd>
<dt> <code>GCRY_KDF_ITERSALTED_S2K</code></dt>
<dd><p>The OpenPGP iterated+salted S2K algorithm (cf. RFC4880).  This is the
default for most OpenPGP applications.  <var>saltlen</var> must be given as
8.  Note that OpenPGP defines a special encoding of the
<var>iterations</var>; however this function takes the plain decoded
iteration count.
</p>
</dd>
<dt> <code>GCRY_KDF_PBKDF2</code></dt>
<dd><p>The PKCS#5 Passphrase Based Key Derivation Function number 2.
</p>
</dd>
<dt> <code>GCRY_KDF_SCRYPT</code></dt>
<dd><p>The SCRYPT Key Derivation Function.  The subalgorithm is used to specify
the CPU/memory cost parameter N, and the number of iterations
is used for the parallelization parameter p.  The block size is fixed
at 8 in the current implementation.
</p>
</dd>
</dl>
</dd></dl>


<hr size="6">
<a name="Random-Numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Key-Derivation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Quality-of-random-numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Key-Derivation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Random-Numbers-1"></a>
<h1 class="chapter">10. Random Numbers</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Quality-of-random-numbers">10.1 Quality of random numbers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   Libgcrypt uses different quality levels.
</td></tr>
<tr><td align="left" valign="top"><a href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   How to retrieve random numbers.
</td></tr>
</table>

<hr size="6">
<a name="Quality-of-random-numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Random-Numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Retrieving-random-numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Quality-of-random-numbers-1"></a>
<h2 class="section">10.1 Quality of random numbers</h2>

<p><acronym>Libgcypt</acronym> offers random numbers of different quality levels:
</p>
<dl>
<dt><a name="index-gcry_005frandom_005flevel_005ft"></a><u>Data type:</u> <b>gcry_random_level_t</b></dt>
<dd><p>The constants for the random quality levels are of this enum type.
</p></dd></dl>

<dl compact="compact">
<dt> <code>GCRY_WEAK_RANDOM</code></dt>
<dd><p>For all functions, except for <code>gcry_mpi_randomize</code>, this level maps
to <code>GCRY_STRONG_RANDOM</code>.  If you do not want this, consider using
<code>gcry_create_nonce</code>.
</p></dd>
<dt> <code>GCRY_STRONG_RANDOM</code></dt>
<dd><p>Use this level for session keys and similar purposes.
</p></dd>
<dt> <code>GCRY_VERY_STRONG_RANDOM</code></dt>
<dd><p>Use this level for long term key material.
</p></dd>
</dl>

<hr size="6">
<a name="Retrieving-random-numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Quality-of-random-numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Retrieving-random-numbers-1"></a>
<h2 class="section">10.2 Retrieving random numbers</h2>

<dl>
<dt><a name="index-gcry_005frandomize"></a><u>Function:</u> void <b>gcry_randomize</b><i> (unsigned char *<var>buffer</var>, size_t <var>length</var>, enum gcry_random_level <var>level</var>)</i></dt>
<dd>
<p>Fill <var>buffer</var> with <var>length</var> random bytes using a random quality
as defined by <var>level</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005frandom_005fbytes"></a><u>Function:</u> void * <b>gcry_random_bytes</b><i> (size_t <var>nbytes</var>, enum gcry_random_level <var>level</var>)</i></dt>
<dd>
<p>Convenience function to allocate a memory block consisting of
<var>nbytes</var> fresh random bytes using a random quality as defined by
<var>level</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005frandom_005fbytes_005fsecure"></a><u>Function:</u> void * <b>gcry_random_bytes_secure</b><i> (size_t <var>nbytes</var>, enum gcry_random_level <var>level</var>)</i></dt>
<dd>
<p>Convenience function to allocate a memory block consisting of
<var>nbytes</var> fresh random bytes using a random quality as defined by
<var>level</var>.  This function differs from <code>gcry_random_bytes</code> in
that the returned buffer is allocated in a &ldquo;secure&rdquo; area of the
memory.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcreate_005fnonce"></a><u>Function:</u> void <b>gcry_create_nonce</b><i> (unsigned char *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p>Fill <var>buffer</var> with <var>length</var> unpredictable bytes.  This is
commonly called a nonce and may also be used for initialization
vectors and padding.  This is an extra function nearly independent of
the other random function for 3 reasons: It better protects the
regular random generator&rsquo;s internal state, provides better performance
and does not drain the precious entropy pool.
</p>
</dd></dl>



<hr size="6">
<a name="S_002dexpressions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Retrieving-random-numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-types-for-S_002dexpressions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Random-Numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="S_002dexpressions-1"></a>
<h1 class="chapter">11. S-expressions</h1>

<p>S-expressions are used by the public key functions to pass complex data
structures around.  These LISP like objects are used by some
cryptographic protocols (cf. RFC-2692) and Libgcrypt provides functions
to parse and construct them.  For detailed information, see
<cite>Ron Rivest, code and description of S-expressions,
<a href="http://theory.lcs.mit.edu/~rivest/sexp.html">http://theory.lcs.mit.edu/~rivest/sexp.html</a></cite>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Data-types-for-S_002dexpressions">11.1 Data types for S-expressions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Data types related to S-expressions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  How to work with S-expressions.
</td></tr>
</table>

<hr size="6">
<a name="Data-types-for-S_002dexpressions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#S_002dexpressions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Working-with-S_002dexpressions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Data-types-for-S_002dexpressions-1"></a>
<h2 class="section">11.1 Data types for S-expressions</h2>

<dl>
<dt><a name="index-gcry_005fsexp_005ft"></a><u>Data type:</u> <b>gcry_sexp_t</b></dt>
<dd><p>The <code>gcry_sexp_t</code> type describes an object with the Libgcrypt internal
representation of an S-expression.
</p></dd></dl>

<hr size="6">
<a name="Working-with-S_002dexpressions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Data-types-for-S_002dexpressions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Working-with-S_002dexpressions-1"></a>
<h2 class="section">11.2 Working with S-expressions</h2>

<p>There are several functions to create an Libgcrypt S-expression object
from its external representation or from a string template.  There is
also a function to convert the internal representation back into one of
the external formats:
</p>

<dl>
<dt><a name="index-gcry_005fsexp_005fnew"></a><u>Function:</u> gcry_error_t <b>gcry_sexp_new</b><i> (gcry_sexp_t *<var>r_sexp</var>, const void *<var>buffer</var>, size_t <var>length</var>, int <var>autodetect</var>)</i></dt>
<dd>
<p>This is the generic function to create an new S-expression object from
its external representation in <var>buffer</var> of <var>length</var> bytes.  On
success the result is stored at the address given by <var>r_sexp</var>.
With <var>autodetect</var> set to 0, the data in <var>buffer</var> is expected to
be in canonized format, with <var>autodetect</var> set to 1 the function parses any of
the defined external formats.  If <var>buffer</var> does not hold a valid
S-expression, an error code is returned and <var>r_sexp</var> set to
<code>NULL</code>.
Note that the caller is responsible for releasing the newly allocated
S-expression using <code>gcry_sexp_release</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fcreate"></a><u>Function:</u> gcry_error_t <b>gcry_sexp_create</b><i> (gcry_sexp_t *<var>r_sexp</var>, void *<var>buffer</var>, size_t <var>length</var>, int <var>autodetect</var>, void (*<var>freefnc</var>)(void*))</i></dt>
<dd>
<p>This function is identical to <code>gcry_sexp_new</code> but has an extra
argument <var>freefnc</var>, which, when not set to <code>NULL</code>, is expected
to be a function to release the <var>buffer</var>; most likely the standard
<code>free</code> function is used for this argument.  This has the effect of
transferring the ownership of <var>buffer</var> to the created object in
<var>r_sexp</var>.  The advantage of using this function is that Libgcrypt
might decide to directly use the provided buffer and thus avoid extra
copying.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fsscan"></a><u>Function:</u> gcry_error_t <b>gcry_sexp_sscan</b><i> (gcry_sexp_t *<var>r_sexp</var>, size_t *<var>erroff</var>, const char *<var>buffer</var>, size_t <var>length</var>)</i></dt>
<dd>
<p>This is another variant of the above functions.  It behaves nearly
identical but provides an <var>erroff</var> argument which will receive the
offset into the buffer where the parsing stopped on error.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fbuild"></a><u>Function:</u> gcry_error_t <b>gcry_sexp_build</b><i> (gcry_sexp_t *<var>r_sexp</var>, size_t *<var>erroff</var>, const char *<var>format</var>, ...)</i></dt>
<dd>
<p>This function creates an internal S-expression from the string template
<var>format</var> and stores it at the address of <var>r_sexp</var>. If there is a
parsing error, the function returns an appropriate error code and stores
the offset into <var>format</var> where the parsing stopped in <var>erroff</var>.
The function supports a couple of printf-like formatting characters and
expects arguments for some of these escape sequences right after
<var>format</var>.  The following format characters are defined:
</p>
<dl compact="compact">
<dt> &lsquo;<samp>%m</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>gcry_mpi_t</code> and a copy of
its value is inserted into the resulting S-expression.  The MPI is
stored as a signed integer.
</p></dd>
<dt> &lsquo;<samp>%M</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>gcry_mpi_t</code> and a copy of
its value is inserted into the resulting S-expression.  The MPI is
stored as an unsigned integer.
</p></dd>
<dt> &lsquo;<samp>%s</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>char *</code> and that
string is inserted into the resulting S-expression.
</p></dd>
<dt> &lsquo;<samp>%d</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>int</code> and its value is
inserted into the resulting S-expression.
</p></dd>
<dt> &lsquo;<samp>%u</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>unsigned int</code> and
its value is inserted into the resulting S-expression.
</p></dd>
<dt> &lsquo;<samp>%b</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>int</code> directly
followed by an argument of type <code>char *</code>.  This represents a
buffer of given length to be inserted into the resulting S-expression.
</p></dd>
<dt> &lsquo;<samp>%S</samp>&rsquo;</dt>
<dd><p>The next argument is expected to be of type <code>gcry_sexp_t</code> and a
copy of that S-expression is embedded in the resulting S-expression.
The argument needs to be a regular S-expression, starting with a
parenthesis.
</p>
</dd>
</dl>

<p>No other format characters are defined and would return an error.  Note
that the format character &lsquo;<samp>%%</samp>&rsquo; does not exists, because a percent
sign is not a valid character in an S-expression.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005frelease"></a><u>Function:</u> void <b>gcry_sexp_release</b><i> (gcry_sexp_t <var>sexp</var>)</i></dt>
<dd>
<p>Release the S-expression object <var>sexp</var>.  If the S-expression is
stored in secure memory, it explicitly zeroises that memory; note that
this is done in addition to the zeroisation always done when freeing
secure memory.
</p></dd></dl>


<p>The next 2 functions are used to convert the internal representation
back into a regular external S-expression format and to show the
structure for debugging.
</p>
<dl>
<dt><a name="index-gcry_005fsexp_005fsprint"></a><u>Function:</u> size_t <b>gcry_sexp_sprint</b><i> (gcry_sexp_t <var>sexp</var>, int <var>mode</var>, char *<var>buffer</var>, size_t <var>maxlength</var>)</i></dt>
<dd>
<p>Copies the S-expression object <var>sexp</var> into <var>buffer</var> using the
format specified in <var>mode</var>.  <var>maxlength</var> must be set to the
allocated length of <var>buffer</var>.  The function returns the actual
length of valid bytes put into <var>buffer</var> or 0 if the provided buffer
is too short.  Passing <code>NULL</code> for <var>buffer</var> returns the required
length for <var>buffer</var>.  For convenience reasons an extra byte with
value 0 is appended to the buffer.
</p>
<p>The following formats are supported:
</p>
<dl compact="compact">
<dt> <code>GCRYSEXP_FMT_DEFAULT</code></dt>
<dd><p>Returns a convenient external S-expression representation.
</p>
</dd>
<dt> <code>GCRYSEXP_FMT_CANON</code></dt>
<dd><p>Return the S-expression in canonical format.
</p>
</dd>
<dt> <code>GCRYSEXP_FMT_BASE64</code></dt>
<dd><p>Not currently supported.
</p>
</dd>
<dt> <code>GCRYSEXP_FMT_ADVANCED</code></dt>
<dd><p>Returns the S-expression in advanced format.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fdump"></a><u>Function:</u> void <b>gcry_sexp_dump</b><i> (gcry_sexp_t <var>sexp</var>)</i></dt>
<dd>
<p>Dumps <var>sexp</var> in a format suitable for debugging to Libgcrypt&rsquo;s
logging stream.
</p></dd></dl>

<p>Often canonical encoding is used in the external representation.  The
following function can be used to check for valid encoding and to learn
the length of the S-expression.
</p>
<dl>
<dt><a name="index-gcry_005fsexp_005fcanon_005flen"></a><u>Function:</u> size_t <b>gcry_sexp_canon_len</b><i> (const unsigned char *<var>buffer</var>, size_t <var>length</var>, size_t *<var>erroff</var>, int *<var>errcode</var>)</i></dt>
<dd>
<p>Scan the canonical encoded <var>buffer</var> with implicit length values and
return the actual length this S-expression uses.  For a valid S-expression
it should never return 0.  If <var>length</var> is not 0, the maximum
length to scan is given; this can be used for syntax checks of
data passed from outside.  <var>errcode</var> and <var>erroff</var> may both be
passed as <code>NULL</code>.
</p>
</dd></dl>


<p>There are functions to parse S-expressions and retrieve elements:
</p>
<dl>
<dt><a name="index-gcry_005fsexp_005ffind_005ftoken"></a><u>Function:</u> gcry_sexp_t <b>gcry_sexp_find_token</b><i> (const gcry_sexp_t <var>list</var>, const char *<var>token</var>, size_t <var>toklen</var>)</i></dt>
<dd>
<p>Scan the S-expression for a sublist with a type (the car of the list)
matching the string <var>token</var>.  If <var>toklen</var> is not 0, the token is
assumed to be raw memory of this length.  The function returns a newly
allocated S-expression consisting of the found sublist or <code>NULL</code>
when not found.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fsexp_005flength"></a><u>Function:</u> int <b>gcry_sexp_length</b><i> (const gcry_sexp_t <var>list</var>)</i></dt>
<dd>
<p>Return the length of the <var>list</var>.  For a valid S-expression this
should be at least 1.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fsexp_005fnth"></a><u>Function:</u> gcry_sexp_t <b>gcry_sexp_nth</b><i> (const gcry_sexp_t <var>list</var>, int <var>number</var>)</i></dt>
<dd>
<p>Create and return a new S-expression from the element with index <var>number</var> in
<var>list</var>.  Note that the first element has the index 0.  If there is
no such element, <code>NULL</code> is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fcar"></a><u>Function:</u> gcry_sexp_t <b>gcry_sexp_car</b><i> (const gcry_sexp_t <var>list</var>)</i></dt>
<dd>
<p>Create and return a new S-expression from the first element in
<var>list</var>; this is called the &quot;type&quot; and should always exist per
S-expression specification and in general be a string.  <code>NULL</code> is
returned in case of a problem.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fcdr"></a><u>Function:</u> gcry_sexp_t <b>gcry_sexp_cdr</b><i> (const gcry_sexp_t <var>list</var>)</i></dt>
<dd>
<p>Create and return a new list form all elements except for the first one.
Note that this function may return an invalid S-expression because it
is not guaranteed that the type exists and is a string.  However, for
parsing a complex S-expression it might be useful for intermediate
lists.  Returns <code>NULL</code> on error.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fsexp_005fnth_005fdata"></a><u>Function:</u> const char * <b>gcry_sexp_nth_data</b><i> (const gcry_sexp_t <var>list</var>, int <var>number</var>, size_t *<var>datalen</var>)</i></dt>
<dd>
<p>This function is used to get data from a <var>list</var>.  A pointer to the
actual data with index <var>number</var> is returned and the length of this
data will be stored to <var>datalen</var>.  If there is no data at the given
index or the index represents another list, <code>NULL</code> is returned.
<strong>Caution:</strong> The returned pointer is valid as long as <var>list</var> is
not modified or released.
</p>
<p>Here is an example on how to extract and print the surname (Meier) from
the S-expression &lsquo;<samp>(Name Otto Meier (address Burgplatz 3))</samp>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">size_t len;
const char *name;

name = gcry_sexp_nth_data (list, 2, &amp;len);
printf (&quot;my name is %.*s\n&quot;, (int)len, name);
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fnth_005fbuffer"></a><u>Function:</u> void * <b>gcry_sexp_nth_buffer</b><i> (const gcry_sexp_t <var>list</var>, int <var>number</var>, size_t *<var>rlength</var>)</i></dt>
<dd>
<p>This function is used to get data from a <var>list</var>.  A malloced
buffer with the actual data at list index <var>number</var> is returned and
the length of this buffer will be stored to <var>rlength</var>.  If there
is no data at the given index or the index represents another list,
<code>NULL</code> is returned.  The caller must release the result using
<code>gcry_free</code>.
</p>
<p>Here is an example on how to extract and print the CRC value from the
S-expression &lsquo;<samp>(hash crc32 #23ed00d7)</samp>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">size_t len;
char *value;

value = gcry_sexp_nth_buffer (list, 2, &amp;len);
if (value)
  fwrite (value, len, 1, stdout);
gcry_free (value);
</pre></td></tr></table>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fnth_005fstring"></a><u>Function:</u> char * <b>gcry_sexp_nth_string</b><i> (gcry_sexp_t <var>list</var>, int <var>number</var>)</i></dt>
<dd>
<p>This function is used to get and convert data from a <var>list</var>. The
data is assumed to be a Nul terminated string.  The caller must
release this returned value using <code>gcry_free</code>.  If there is
no data at the given index, the index represents a list or the value
can&rsquo;t be converted to a string, <code>NULL</code> is returned.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fnth_005fmpi"></a><u>Function:</u> gcry_mpi_t <b>gcry_sexp_nth_mpi</b><i> (gcry_sexp_t <var>list</var>, int <var>number</var>, int <var>mpifmt</var>)</i></dt>
<dd>
<p>This function is used to get and convert data from a <var>list</var>. This
data is assumed to be an MPI stored in the format described by
<var>mpifmt</var> and returned as a standard Libgcrypt MPI.  The caller must
release this returned value using <code>gcry_mpi_release</code>.  If there is
no data at the given index, the index represents a list or the value
can&rsquo;t be converted to an MPI, <code>NULL</code> is returned.  If you use
this function to parse results of a public key function, you most
likely want to use <code>GCRYMPI_FMT_USG</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fsexp_005fextract_005fparam"></a><u>Function:</u> gpg_error_t <b>gcry_sexp_extract_param</b><i> (   gcry_sexp_t <var>sexp</var>,   const char *<var>path</var>,   const char *<var>list</var>, ...)</i></dt>
<dd>
<p>Extract parameters from an S-expression using a list of parameter
names.  The names of these parameters are specified in <var>list</var>.  White
space between the parameter names are ignored. Some special characters
and character sequences may be given to control the conversion:
</p>
<dl compact="compact">
<dt> &lsquo;<samp>+</samp>&rsquo;</dt>
<dd><p>Switch to unsigned integer format (<code>GCRYMPI_FMT_USG</code>).  This is the
default mode.
</p></dd>
<dt> &lsquo;<samp>-</samp>&rsquo;</dt>
<dd><p>Switch to standard signed format (<code>GCRYMPI_FMT_STD</code>).
</p></dd>
<dt> &lsquo;<samp>/</samp>&rsquo;</dt>
<dd><p>Switch to opaque MPI format.  The resulting MPIs may not be used for
computations; see <code>gcry_mpi_get_opaque</code> for details.
</p></dd>
<dt> &lsquo;<samp>&amp;</samp>&rsquo;</dt>
<dd><p>Switch to buffer descriptor mode.  See below for details.
</p></dd>
<dt> &lsquo;<samp>%s</samp>&rsquo;</dt>
<dd><p>Switch to string mode.  The expected argument is the address of a
<code>char *</code> variable; the caller must release that value.  If the
parameter was marked optional and is not found, <code>NULL</code> is stored.
</p></dd>
<dt> &lsquo;<samp>%#s</samp>&rsquo;</dt>
<dd><p>Switch to multi string mode.  The expected argument is the address of a
<code>char *</code> variable; the caller must release that value.  If the
parameter was marked optional and is not found, <code>NULL</code> is stored.  A
multi string takes all values, assumes they are strings and
concatenates them using a space as delimiter.  In case a value is
actually another list, this is not further parsed but a <code>()</code> is
inserted in place of that sublist.
</p></dd>
<dt> &lsquo;<samp>%u</samp>&rsquo;</dt>
<dd><p>Switch to unsigned integer mode. The expected argument is address of
a <code>unsigned int</code> variable.
</p></dd>
<dt> &lsquo;<samp>%lu</samp>&rsquo;</dt>
<dd><p>Switch to unsigned long integer mode. The expected argument is address of
a <code>unsigned long</code> variable.
</p></dd>
<dt> &lsquo;<samp>%d</samp>&rsquo;</dt>
<dd><p>Switch to signed integer mode. The expected argument is address of
a <code>int</code> variable.
</p></dd>
<dt> &lsquo;<samp>%ld</samp>&rsquo;</dt>
<dd><p>Switch to signed long integer mode. The expected argument is address of
a <code>long</code> variable.
</p></dd>
<dt> &lsquo;<samp>%zu</samp>&rsquo;</dt>
<dd><p>Switch to size_t mode. The expected argument is address of
a <code>size_t</code> variable.
</p></dd>
<dt> &lsquo;<samp>?</samp>&rsquo;</dt>
<dd><p>If immediately following a parameter letter (no white space allowed),
that parameter is considered optional.
</p></dd>
</dl>

<p>In general, parameter names are single letters.  To use a string for a
parameter name, enclose the name in single quotes.
</p>
<p>Unless in buffer descriptor mode, for each parameter name a pointer to
an <code>gcry_mpi_t</code> variable is expected that must be set to
<code>NULL</code> prior to invoking this function, and finally a <code>NULL</code>
is expected.  For example
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">  gcry_sexp_extract_param (key, NULL, &quot;n/x+e d-'foo'&quot;,
                           &amp;mpi_n, &amp;mpi_x, &amp;mpi_e, &amp;mpi_d, &amp;mpi_foo, NULL)
</pre></td></tr></table>

<p>stores the parameter &rsquo;n&rsquo; from <var>key</var> as an unsigned MPI into
<var>mpi_n</var>, the parameter &rsquo;x&rsquo; as an opaque MPI into <var>mpi_x</var>, the
parameters &rsquo;e&rsquo; and &rsquo;d&rsquo; again as an unsigned MPI into <var>mpi_e</var> and
<var>mpi_d</var> and finally the parameter &rsquo;foo&rsquo; as a signed MPI into
<var>mpi_foo</var>.
</p>
<p><var>path</var> is an optional string used to locate a token.  The
exclamation mark separated tokens are used via
<code>gcry_sexp_find_token</code> to find a start point inside the
S-expression.
</p>
<p>In buffer descriptor mode a pointer to a <code>gcry_buffer_t</code>
descriptor is expected instead of a pointer to an MPI.  The caller may
use two different operation modes here: If the <var>data</var> field of the
provided descriptor is <code>NULL</code>, the function allocates a new
buffer and stores it at <var>data</var>; the other fields are set
accordingly with <var>off</var> set to 0.  If <var>data</var> is not
<code>NULL</code>, the function assumes that the <var>data</var>, <var>size</var>, and
<var>off</var> fields specify a buffer where to put the value of the
respective parameter; on return the <var>len</var> field receives the
number of bytes copied to that buffer; in case the buffer is too
small, the function immediately returns with an error code (and
<var>len</var> is set to 0).
</p>
<p>The function returns 0 on success.  On error an error code is
returned, all passed MPIs that might have been allocated up to this
point are deallocated and set to <code>NULL</code>, and all passed buffers
are either truncated if the caller supplied the buffer, or deallocated
if the function allocated the buffer.
</p></dd></dl>


<hr size="6">
<a name="MPI-library"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Working-with-S_002dexpressions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Data-types" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#S_002dexpressions" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="MPI-library-1"></a>
<h1 class="chapter">12. MPI library</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Data-types">12.1 Data types</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  MPI related data types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             First steps with MPI numbers.
</td></tr>
<tr><td align="left" valign="top"><a href="#MPI-formats">12.3 MPI formats</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 External representation of MPIs.
</td></tr>
<tr><td align="left" valign="top"><a href="#Calculations">12.4 Calculations</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Performing MPI calculations.
</td></tr>
<tr><td align="left" valign="top"><a href="#Comparisons">12.5 Comparisons</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 How to compare MPI values.
</td></tr>
<tr><td align="left" valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           How to access single bits of MPI values.
</td></tr>
<tr><td align="left" valign="top"><a href="#EC-functions">12.7 EC functions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Elliptic curve related functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Miscellaneous MPI functions.
</td></tr>
</table>

<p>Public key cryptography is based on mathematics with large numbers.  To
implement the public key functions, a library for handling these large
numbers is required.  Because of the general usefulness of such a
library, its interface is exposed by Libgcrypt.
In the context of Libgcrypt and in most other applications, these large
numbers are called MPIs (multi-precision-integers).
</p>
<hr size="6">
<a name="Data-types"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#MPI-library" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Basic-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Data-types-1"></a>
<h2 class="section">12.1 Data types</h2>

<dl>
<dt><a name="index-gcry_005fmpi_005ft"></a><u>Data type:</u> <b>gcry_mpi_t</b></dt>
<dd><p>This type represents an object to hold an MPI.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005ft"></a><u>Data type:</u> <b>gcry_mpi_point_t</b></dt>
<dd><p>This type represents an object to hold a point for elliptic curve math.
</p></dd></dl>

<hr size="6">
<a name="Basic-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Data-types" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-formats" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Basic-functions-1"></a>
<h2 class="section">12.2 Basic functions</h2>

<p>To work with MPIs, storage must be allocated and released for the
numbers.  This can be done with one of these functions:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fnew"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_new</b><i> (unsigned int <var>nbits</var>)</i></dt>
<dd>
<p>Allocate a new MPI object, initialize it to 0 and initially allocate
enough memory for a number of at least <var>nbits</var>.  This pre-allocation is
only a small performance issue and not actually necessary because
Libgcrypt automatically re-allocates the required memory.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fsnew"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_snew</b><i> (unsigned int <var>nbits</var>)</i></dt>
<dd>
<p>This is identical to <code>gcry_mpi_new</code> but allocates the MPI in the so
called &quot;secure memory&quot; which in turn will take care that all derived
values will also be stored in this &quot;secure memory&quot;.  Use this for highly
confidential data like private key parameters.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fcopy"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_copy</b><i> (const gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Create a new MPI as the exact copy of <var>a</var> but with the constant
and immutable flags cleared.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005frelease"></a><u>Function:</u> void <b>gcry_mpi_release</b><i> (gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Release the MPI <var>a</var> and free all associated resources.  Passing
<code>NULL</code> is allowed and ignored.  When a MPI stored in the &quot;secure
memory&quot; is released, that memory gets wiped out immediately.
</p></dd></dl>

<p>The simplest operations are used to assign a new value to an MPI:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fset"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_set</b><i> (gcry_mpi_t <var>w</var>, const gcry_mpi_t <var>u</var>)</i></dt>
<dd>
<p>Assign the value of <var>u</var> to <var>w</var> and return <var>w</var>.  If
<code>NULL</code> is passed for <var>w</var>, a new MPI is allocated, set to the
value of <var>u</var> and returned.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fui"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_set_ui</b><i> (gcry_mpi_t <var>w</var>, unsigned long <var>u</var>)</i></dt>
<dd>
<p>Assign the value of <var>u</var> to <var>w</var> and return <var>w</var>.  If
<code>NULL</code> is passed for <var>w</var>, a new MPI is allocated, set to the
value of <var>u</var> and returned.  This function takes an <code>unsigned
int</code> as type for <var>u</var> and thus it is only possible to set <var>w</var> to
small values (usually up to the word size of the CPU).
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fget_005fui"></a><u>Function:</u> gcry_error_t <b>gcry_mpi_get_ui</b><i> (unsigned int *<var>w</var>, gcry_mpi_t <var>u</var>)</i></dt>
<dd>
<p>If <var>u</var> is not negative and small enough to be stored in an
<code>unsigned int</code> variable, store its value at <var>w</var>.  If the
value does not fit or is negative, return <code>GPG_ERR_ERANGE</code> and do not
change the value stored at <var>w</var>.  Note that this function returns
an <code>unsigned int</code> so that this value can immediately be used with
the bit test functions.  This is in contrast to the other &quot;_ui&quot;
functions which allow for values up to an <code>unsigned long</code>.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005fswap"></a><u>Function:</u> void <b>gcry_mpi_swap</b><i> (gcry_mpi_t <var>a</var>, gcry_mpi_t <var>b</var>)</i></dt>
<dd>
<p>Swap the values of <var>a</var> and <var>b</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fsnatch"></a><u>Function:</u> void <b>gcry_mpi_snatch</b><i> (gcry_mpi_t <var>w</var>,                                   const gcry_mpi_t <var>u</var>)</i></dt>
<dd>
<p>Set <var>u</var> into <var>w</var> and release <var>u</var>.  If <var>w</var> is
<code>NULL</code>, only <var>u</var> will be released.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fneg"></a><u>Function:</u> void <b>gcry_mpi_neg</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>)</i></dt>
<dd>
<p>Set the sign of <var>w</var> to the negative of <var>u</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fabs"></a><u>Function:</u> void <b>gcry_mpi_abs</b><i> (gcry_mpi_t <var>w</var>)</i></dt>
<dd>
<p>Clear the sign of <var>w</var>.
</p></dd></dl>


<hr size="6">
<a name="MPI-formats"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Basic-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Calculations" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="MPI-formats-1"></a>
<h2 class="section">12.3 MPI formats</h2>

<p>The following functions are used to convert between an external
representation of an MPI and the internal one of Libgcrypt.
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fscan"></a><u>Function:</u> gcry_error_t <b>gcry_mpi_scan</b><i> (gcry_mpi_t *<var>r_mpi</var>, enum gcry_mpi_format <var>format</var>, const unsigned char *<var>buffer</var>, size_t <var>buflen</var>, size_t *<var>nscanned</var>)</i></dt>
<dd>
<p>Convert the external representation of an integer stored in <var>buffer</var>
with a length of <var>buflen</var> into a newly created MPI returned which
will be stored at the address of <var>r_mpi</var>.  For certain formats the
length argument is not required and should be passed as <code>0</code>. A
<var>buflen</var> larger than 16 MiB will be rejected.  After a
successful operation the variable <var>nscanned</var> receives the number of
bytes actually scanned unless <var>nscanned</var> was given as
<code>NULL</code>. <var>format</var> describes the format of the MPI as stored in
<var>buffer</var>:
</p>
<dl compact="compact">
<dt> <code>GCRYMPI_FMT_STD</code></dt>
<dd><p>2-complement stored without a length header.  Note that
<code>gcry_mpi_print</code> stores a <code>0</code> as a string of zero length.
</p>
</dd>
<dt> <code>GCRYMPI_FMT_PGP</code></dt>
<dd><p>As used by OpenPGP (only defined as unsigned). This is basically
<code>GCRYMPI_FMT_STD</code> with a 2 byte big endian length header.
A length header indicating a length of more than 16384 is not allowed.
</p>
</dd>
<dt> <code>GCRYMPI_FMT_SSH</code></dt>
<dd><p>As used in the Secure Shell protocol.  This is <code>GCRYMPI_FMT_STD</code>
with a 4 byte big endian header.
</p>
</dd>
<dt> <code>GCRYMPI_FMT_HEX</code></dt>
<dd><p>Stored as a string with each byte of the MPI encoded as 2 hex digits.
Negative numbers are prefixed with a minus sign and in addition the
high bit is always zero to make clear that an explicit sign ist used.
When using this format, <var>buflen</var> must be zero.
</p>
</dd>
<dt> <code>GCRYMPI_FMT_USG</code></dt>
<dd><p>Simple unsigned integer.
</p></dd>
</dl>

<p>Note that all of the above formats store the integer in big-endian
format (MSB first).  Leading zeroes are stripped unless they are
required to keep a value positive.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005fprint"></a><u>Function:</u> gcry_error_t <b>gcry_mpi_print</b><i> (enum gcry_mpi_format <var>format</var>, unsigned char *<var>buffer</var>, size_t <var>buflen</var>, size_t *<var>nwritten</var>, const gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Convert the MPI <var>a</var> into an external representation described by
<var>format</var> (see above) and store it in the provided <var>buffer</var>
which has a usable length of at least <var>buflen</var> bytes. If
<var>nwritten</var> is not <code>NULL</code>, it will receive the number of bytes
actually stored in <var>buffer</var> after a successful operation.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005faprint"></a><u>Function:</u> gcry_error_t <b>gcry_mpi_aprint</b><i> (enum gcry_mpi_format <var>format</var>, unsigned char **<var>buffer</var>, size_t *<var>nbytes</var>, const gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Convert the MPI <var>a</var> into an external representation described by
<var>format</var> (see above) and store it in a newly allocated buffer which
address will be stored in the variable <var>buffer</var> points to.  The
number of bytes stored in this buffer will be stored in the variable
<var>nbytes</var> points to, unless <var>nbytes</var> is <code>NULL</code>.
</p>
<p>Even if <var>nbytes</var> is zero, the function allocates at least one byte
and store a zero there.  Thus with formats <code>GCRYMPI_FMT_STD</code> and
<code>GCRYMPI_FMT_USG</code> the caller may safely set a returned length of
0 to 1 to represent a zero as a 1 byte string.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fdump"></a><u>Function:</u> void <b>gcry_mpi_dump</b><i> (const gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Dump the value of <var>a</var> in a format suitable for debugging to
Libgcrypt&rsquo;s logging stream.  Note that one leading space but no trailing
space or linefeed will be printed.  It is okay to pass <code>NULL</code> for
<var>a</var>.
</p></dd></dl>


<hr size="6">
<a name="Calculations"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#MPI-formats" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Comparisons" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Calculations-1"></a>
<h2 class="section">12.4 Calculations</h2>

<p>Basic arithmetic operations:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fadd"></a><u>Function:</u> void <b>gcry_mpi_add</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> + <var>v</var></em>.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005fadd_005fui"></a><u>Function:</u> void <b>gcry_mpi_add_ui</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, unsigned long <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> + <var>v</var></em>.  Note that <var>v</var> is an unsigned integer.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005faddm"></a><u>Function:</u> void <b>gcry_mpi_addm</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>, gcry_mpi_t <var>m</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> + <var>v</var> \bmod <var>m</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fsub"></a><u>Function:</u> void <b>gcry_mpi_sub</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> - <var>v</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fsub_005fui"></a><u>Function:</u> void <b>gcry_mpi_sub_ui</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, unsigned long <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> - <var>v</var></em>.  <var>v</var> is an unsigned integer.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fsubm"></a><u>Function:</u> void <b>gcry_mpi_subm</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>, gcry_mpi_t <var>m</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> - <var>v</var> \bmod <var>m</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fmul"></a><u>Function:</u> void <b>gcry_mpi_mul</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> * <var>v</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fmul_005fui"></a><u>Function:</u> void <b>gcry_mpi_mul_ui</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, unsigned long <var>v</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> * <var>v</var></em>.  <var>v</var> is an unsigned integer.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fmulm"></a><u>Function:</u> void <b>gcry_mpi_mulm</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, gcry_mpi_t <var>v</var>, gcry_mpi_t <var>m</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> * <var>v</var> \bmod <var>m</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fmul_005f2exp"></a><u>Function:</u> void <b>gcry_mpi_mul_2exp</b><i> (gcry_mpi_t <var>w</var>, gcry_mpi_t <var>u</var>, unsigned long <var>e</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>u</var> * 2^e</em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fdiv"></a><u>Function:</u> void <b>gcry_mpi_div</b><i> (gcry_mpi_t <var>q</var>, gcry_mpi_t <var>r</var>, gcry_mpi_t <var>dividend</var>, gcry_mpi_t <var>divisor</var>, int <var>round</var>)</i></dt>
<dd>
<p><em><var>q</var> = <var>dividend</var> / <var>divisor</var></em>, <em><var>r</var> =
<var>dividend</var> \bmod <var>divisor</var></em>.  <var>q</var> and <var>r</var> may be passed
as <code>NULL</code>.  <var>round</var> is either negative for floored division
(rounds towards the next lower integer) or zero for truncated division
(rounds towards zero).
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fmod"></a><u>Function:</u> void <b>gcry_mpi_mod</b><i> (gcry_mpi_t <var>r</var>, gcry_mpi_t <var>dividend</var>, gcry_mpi_t <var>divisor</var>)</i></dt>
<dd>
<p><em><var>r</var> = <var>dividend</var> \bmod <var>divisor</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpowm"></a><u>Function:</u> void <b>gcry_mpi_powm</b><i> (gcry_mpi_t <var>w</var>, const gcry_mpi_t <var>b</var>, const gcry_mpi_t <var>e</var>, const gcry_mpi_t <var>m</var>)</i></dt>
<dd>
<p><em><var>w</var> = <var>b</var>^e \bmod <var>m</var></em>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fgcd"></a><u>Function:</u> int <b>gcry_mpi_gcd</b><i> (gcry_mpi_t <var>g</var>, gcry_mpi_t <var>a</var>, gcry_mpi_t <var>b</var>)</i></dt>
<dd>
<p>Set <var>g</var> to the greatest common divisor of <var>a</var> and <var>b</var>.
Return true if <var>g</var> is 1.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005finvm"></a><u>Function:</u> int <b>gcry_mpi_invm</b><i> (gcry_mpi_t <var>x</var>, gcry_mpi_t <var>a</var>, gcry_mpi_t <var>m</var>)</i></dt>
<dd>
<p>Set <var>x</var> to the multiplicative inverse of <em><var>a</var> \bmod <var>m</var></em>.
Return true if the inverse exists.
</p></dd></dl>


<hr size="6">
<a name="Comparisons"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Calculations" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Bit-manipulations" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Comparisons-1"></a>
<h2 class="section">12.5 Comparisons</h2>

<p>The next 2 functions are used to compare MPIs:
</p>

<dl>
<dt><a name="index-gcry_005fmpi_005fcmp"></a><u>Function:</u> int <b>gcry_mpi_cmp</b><i> (const gcry_mpi_t <var>u</var>, const gcry_mpi_t <var>v</var>)</i></dt>
<dd>
<p>Compare the multi-precision-integers number <var>u</var> and <var>v</var>,
returning 0 for equality, a positive value for <var>u</var> &gt; <var>v</var> and a
negative for <var>u</var> &lt; <var>v</var>.  If both numbers are opaque values
(cf. <code>gcry_mpi_set_opaque</code>), the comparison is done by checking the bit
sizes using memcmp.  If only one number is an opaque value, the opaque
value is less than the other number.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fcmp_005fui"></a><u>Function:</u> int <b>gcry_mpi_cmp_ui</b><i> (const gcry_mpi_t <var>u</var>, unsigned long <var>v</var>)</i></dt>
<dd>
<p>Compare the multi-precision-integers number <var>u</var> with the unsigned
integer <var>v</var>, returning 0 for equality, a positive value for <var>u</var> &gt;
<var>v</var> and a negative for <var>u</var> &lt; <var>v</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fis_005fneg"></a><u>Function:</u> int <b>gcry_mpi_is_neg</b><i> (const gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Return 1 if <var>a</var> is less than zero; return 0 if zero or positive.
</p></dd></dl>


<hr size="6">
<a name="Bit-manipulations"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Comparisons" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#EC-functions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Bit-manipulations-1"></a>
<h2 class="section">12.6 Bit manipulations</h2>

<p>There are a couple of functions to get information on arbitrary bits
in an MPI and to set or clear them:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fget_005fnbits"></a><u>Function:</u> unsigned int <b>gcry_mpi_get_nbits</b><i> (gcry_mpi_t <var>a</var>)</i></dt>
<dd>
<p>Return the number of bits required to represent <var>a</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005ftest_005fbit"></a><u>Function:</u> int <b>gcry_mpi_test_bit</b><i> (gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Return true if bit number <var>n</var> (counting from 0) is set in <var>a</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fbit"></a><u>Function:</u> void <b>gcry_mpi_set_bit</b><i> (gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Set bit number <var>n</var> in <var>a</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fclear_005fbit"></a><u>Function:</u> void <b>gcry_mpi_clear_bit</b><i> (gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Clear bit number <var>n</var> in <var>a</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fhighbit"></a><u>Function:</u> void <b>gcry_mpi_set_highbit</b><i> (gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Set bit number <var>n</var> in <var>a</var> and clear all bits greater than <var>n</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fclear_005fhighbit"></a><u>Function:</u> void <b>gcry_mpi_clear_highbit</b><i> (gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Clear bit number <var>n</var> in <var>a</var> and all bits greater than <var>n</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005frshift"></a><u>Function:</u> void <b>gcry_mpi_rshift</b><i> (gcry_mpi_t <var>x</var>, gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Shift the value of <var>a</var> by <var>n</var> bits to the right and store the
result in <var>x</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005flshift"></a><u>Function:</u> void <b>gcry_mpi_lshift</b><i> (gcry_mpi_t <var>x</var>, gcry_mpi_t <var>a</var>, unsigned int <var>n</var>)</i></dt>
<dd>
<p>Shift the value of <var>a</var> by <var>n</var> bits to the left and store the
result in <var>x</var>.
</p></dd></dl>

<hr size="6">
<a name="EC-functions"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Bit-manipulations" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Miscellaneous" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="EC-functions-1"></a>
<h2 class="section">12.7 EC functions</h2>

<p>Libgcrypt provides an API to access low level functions used by its
elliptic curve implementation.  These functions allow to implement
elliptic curve methods for which no explicit support is available.
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fnew"></a><u>Function:</u> gcry_mpi_point_t <b>gcry_mpi_point_new</b><i> (unsigned int <var>nbits</var>)</i></dt>
<dd>
<p>Allocate a new point object, initialize it to 0, and allocate enough
memory for a points of at least <var>nbits</var>.  This pre-allocation
yields only a small performance win and is not really necessary
because Libgcrypt automatically re-allocates the required memory.
Using 0 for <var>nbits</var> is usually the right thing to do.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005frelease"></a><u>Function:</u> void <b>gcry_mpi_point_release</b><i> (gcry_mpi_point_t <var>point</var>)</i></dt>
<dd>
<p>Release <var>point</var> and free all associated resources.  Passing
<code>NULL</code> is allowed and ignored.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fcopy"></a><u>Function:</u> gcry_mpi_point_t <b>gcry_mpi_point_copy</b><i> (gcry_mpi_point_t <var>point</var>)</i></dt>
<dd>
<p>Allocate and return a new point object and initialize it with
<var>point</var>.  If <var>point</var> is <code>NULL</code>, the function is identical to
<code>gcry_mpi_point_new(0)</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fget"></a><u>Function:</u> void <b>gcry_mpi_point_get</b><i> (gcry_mpi_t <var>x</var>,  gcry_mpi_t <var>y</var>, gcry_mpi_t <var>z</var>,  gcry_mpi_point_t <var>point</var>)</i></dt>
<dd>
<p>Store the projective coordinates from <var>point</var> into the MPIs
<var>x</var>, <var>y</var>, and <var>z</var>.  If a coordinate is not required,
<code>NULL</code> may be used for <var>x</var>, <var>y</var>, or <var>z</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fsnatch_005fget"></a><u>Function:</u> void <b>gcry_mpi_point_snatch_get</b><i> (gcry_mpi_t <var>x</var>,  gcry_mpi_t <var>y</var>, gcry_mpi_t <var>z</var>,  gcry_mpi_point_t <var>point</var>)</i></dt>
<dd>
<p>Store the projective coordinates from <var>point</var> into the MPIs
<var>x</var>, <var>y</var>, and <var>z</var>.  If a coordinate is not required,
<code>NULL</code> may be used for <var>x</var>, <var>y</var>, or <var>z</var>.  The object
<var>point</var> is then released.  Using this function instead of
<code>gcry_mpi_point_get</code> and <code>gcry_mpi_point_release</code> has the
advantage of avoiding some extra memory allocations and copies.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fset"></a><u>Function:</u> gcry_mpi_point_t <b>gcry_mpi_point_set</b><i> (  gcry_mpi_point_t <var>point</var>,  gcry_mpi_t <var>x</var>, gcry_mpi_t <var>y</var>, gcry_mpi_t <var>z</var>)</i></dt>
<dd>
<p>Store the projective coordinates from <var>x</var>, <var>y</var>, and <var>z</var>
into <var>point</var>.  If a coordinate is given as <code>NULL</code>, the value
0 is used.  If <code>NULL</code> is used for <var>point</var>, a new point object
is allocated and returned.  Returns <var>point</var> or the newly allocated
point object.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fpoint_005fsnatch_005fset"></a><u>Function:</u> gcry_mpi_point_t <b>gcry_mpi_point_snatch_set</b><i> (  gcry_mpi_point_t <var>point</var>,  gcry_mpi_t <var>x</var>, gcry_mpi_t <var>y</var>, gcry_mpi_t <var>z</var>)</i></dt>
<dd>
<p>Store the projective coordinates from <var>x</var>, <var>y</var>, and <var>z</var>
into <var>point</var>.  If a coordinate is given as <code>NULL</code>, the value
0 is used.  If <code>NULL</code> is used for <var>point</var>, a new point object
is allocated and returned.  The MPIs <var>x</var>, <var>y</var>, and <var>z</var> are
released.  Using this function instead of <code>gcry_mpi_point_set</code>
and 3 calls to <code>gcry_mpi_release</code> has the advantage of avoiding
some extra memory allocations and copies.  Returns <var>point</var> or the
newly allocated point object.
</p></dd></dl>

<p><a name="gcry_005fmpi_005fec_005fnew"></a>
</p><dl>
<dt><a name="index-gcry_005fmpi_005fec_005fnew"></a><u>Function:</u> gpg_error_t <b>gcry_mpi_ec_new</b><i> (gcry_ctx_t *<var>r_ctx</var>,  gcry_sexp_t <var>keyparam</var>, const char *<var>curvename</var>)</i></dt>
<dd>
<p>Allocate a new context for elliptic curve operations.  If
<var>keyparam</var> is given, it specifies the parameters of the curve
(see <a href="#ecc_005fkeyparam">ecc_keyparam</a>).  If <var>curvename</var> is given in addition to
<var>keyparam</var> and the key parameters do not include a named curve
reference, the string <var>curvename</var> is used to fill in missing
parameters.  If only <var>curvename</var> is given, the context is
initialized for this named curve.
</p>
<p>If a parameter specifying a point (e.g. <code>g</code> or <code>q</code>) is not
found, the parser looks for a non-encoded point by appending
<code>.x</code>, <code>.y</code>, and <code>.z</code> to the parameter name and looking
them all up to create a point.  A parameter with the suffix <code>.z</code>
is optional and defaults to 1.
</p>
<p>On success the function returns 0 and stores the new context object at
<var>r_ctx</var>; this object eventually needs to be released
(see <a href="#gcry_005fctx_005frelease">gcry_ctx_release</a>).  On error the function stores <code>NULL</code> at
<var>r_ctx</var> and returns an error code.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fget_005fmpi"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_ec_get_mpi</b><i> (  const char *<var>name</var>, gcry_ctx_t <var>ctx</var>, int <var>copy</var>)</i></dt>
<dd>
<p>Return the MPI with <var>name</var> from the context <var>ctx</var>.  If not
found, <code>NULL</code> is returned.  If the returned MPI may later be
modified, it is suggested to pass <code>1</code> to <var>copy</var>, so that the
function guarantees that a modifiable copy of the MPI is returned.  If
<code>0</code> is used for <var>copy</var>, this function may return a constant
flagged MPI.  In any case <code>gcry_mpi_release</code> needs to be called
to release the result.  For valid names, see <a href="#ecc_005fkeyparam">ecc_keyparam</a>.  If the
public key <code>q</code> is requested but only the private key <code>d</code> is
available, <code>q</code> will be recomputed on the fly.  If a point
parameter is requested, it is returned as an uncompressed
encoded point unless these special names are used:
</p><dl compact="compact">
<dt> <var>q@eddsa</var></dt>
<dd><p>Return an EdDSA style compressed point.  This is only supported for
Twisted Edwards curves.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fget_005fpoint"></a><u>Function:</u> gcry_mpi_point_t <b>gcry_mpi_ec_get_point</b><i> (  const char *<var>name</var>, gcry_ctx_t <var>ctx</var>, int <var>copy</var>)</i></dt>
<dd>
<p>Return the point with <var>name</var> from the context <var>ctx</var>.  If not
found, <code>NULL</code> is returned.  If the returned MPI may later be
modified, it is suggested to pass <code>1</code> to <var>copy</var>, so that the
function guarantees that a modifiable copy of the MPI is returned.  If
<code>0</code> is used for <var>copy</var>, this function may return a constant
flagged point.  In any case <code>gcry_mpi_point_release</code> needs to be
called to release the result.  If the public key <code>q</code> is requested
but only the private key <code>d</code> is available, <code>q</code> will be
recomputed on the fly.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fset_005fmpi"></a><u>Function:</u> gpg_error_t <b>gcry_mpi_ec_set_mpi</b><i> (  const char *<var>name</var>, gcry_mpi_t <var>newvalue</var>,  gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Store the MPI <var>newvalue</var> at <var>name</var> into the context <var>ctx</var>.
On success <code>0</code> is returned; on error an error code.  Valid names
are the MPI parameters of an elliptic curve (see <a href="#ecc_005fkeyparam">ecc_keyparam</a>).
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fset_005fpoint"></a><u>Function:</u> gpg_error_t <b>gcry_mpi_ec_set_point</b><i> (  const char *<var>name</var>, gcry_mpi_point_t <var>newvalue</var>,  gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Store the point <var>newvalue</var> at <var>name</var> into the context
<var>ctx</var>.  On success <code>0</code> is returned; on error an error code.
Valid names are the point parameters of an elliptic curve
(see <a href="#ecc_005fkeyparam">ecc_keyparam</a>).
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fdecode_005fpoint"></a><u>Function:</u> gpg_err_code_t <b>gcry_mpi_ec_decode_point</b><i> (  mpi_point_t <var>result</var>, gcry_mpi_t <var>value</var>,  gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Decode the point given as an MPI in <var>value</var> and store at
<var>result</var>.  To decide which encoding is used the function takes a
context <var>ctx</var> which can be created with <code>gcry_mpi_ec_new</code>.
If <code>NULL</code> is given for the context, the function assumes a 0x04
prefixed uncompressed encoding.  On error an error code is returned
and <var>result</var> might be changed.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fget_005faffine"></a><u>Function:</u> int <b>gcry_mpi_ec_get_affine</b><i> (  gcry_mpi_t <var>x</var>, gcry_mpi_t <var>y</var>,  gcry_mpi_point_t <var>point</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Compute the affine coordinates from the projective coordinates in
<var>point</var> and store them into <var>x</var> and <var>y</var>.  If one
coordinate is not required, <code>NULL</code> may be passed to <var>x</var> or
<var>y</var>.  <var>ctx</var> is the context object which has been created using
<code>gcry_mpi_ec_new</code>. Returns 0 on success or not 0 if <var>point</var>
is at infinity.
</p>
<p>Note that you can use <code>gcry_mpi_ec_set_point</code> with the value
<code>GCRYMPI_CONST_ONE</code> for <var>z</var> to convert affine coordinates
back into projective coordinates.
</p>
</dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fdup"></a><u>Function:</u> void <b>gcry_mpi_ec_dup</b><i> (  gcry_mpi_point_t <var>w</var>, gcry_mpi_point_t <var>u</var>,  gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Double the point <var>u</var> of the elliptic curve described by <var>ctx</var>
and store the result into <var>w</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fadd"></a><u>Function:</u> void <b>gcry_mpi_ec_add</b><i> (  gcry_mpi_point_t <var>w</var>, gcry_mpi_point_t <var>u</var>,  gcry_mpi_point_t <var>v</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Add the points <var>u</var> and <var>v</var> of the elliptic curve described by
<var>ctx</var> and store the result into <var>w</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fsub"></a><u>Function:</u> void <b>gcry_mpi_ec_sub</b><i> (  gcry_mpi_point_t <var>w</var>, gcry_mpi_point_t <var>u</var>,  gcry_mpi_point_t <var>v</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Subtracts the point <var>v</var> from the point <var>u</var> of the elliptic
curve described by <var>ctx</var> and store the result into <var>w</var>. Only
Twisted Edwards curves are supported for now.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fmul"></a><u>Function:</u> void <b>gcry_mpi_ec_mul</b><i> (  gcry_mpi_point_t <var>w</var>, gcry_mpi_t <var>n</var>,  gcry_mpi_point_t <var>u</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Multiply the point <var>u</var> of the elliptic curve described by
<var>ctx</var> by <var>n</var> and store the result into <var>w</var>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fec_005fcurve_005fpoint"></a><u>Function:</u> int <b>gcry_mpi_ec_curve_point</b><i> (  gcry_mpi_point_t <var>point</var>, gcry_ctx_t <var>ctx</var>)</i></dt>
<dd>
<p>Return true if <var>point</var> is on the elliptic curve described by
<var>ctx</var>.
</p></dd></dl>


<hr size="6">
<a name="Miscellaneous"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#EC-functions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Miscellaneous-1"></a>
<h2 class="section">12.8 Miscellaneous</h2>

<p>An MPI data type is allowed to be &ldquo;misused&rdquo; to store an arbitrary
value.  Two functions implement this kludge:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fopaque"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_set_opaque</b><i> (gcry_mpi_t <var>a</var>, void *<var>p</var>, unsigned int <var>nbits</var>)</i></dt>
<dd>
<p>Store <var>nbits</var> of the value <var>p</var> points to in <var>a</var> and mark
<var>a</var> as an opaque value (i.e. an value that can&rsquo;t be used for any
math calculation and is only used to store an arbitrary bit pattern in
<var>a</var>).  Ownership of <var>p</var> is taken by this function and thus the
user may not dereference the passed value anymore.  It is required
that the memory referenced by <var>p</var> has been allocated in a way
that <code>gcry_free</code> is able to release it.
</p>
<p>WARNING: Never use an opaque MPI for actual math operations.  The only
valid functions are <code>gcry_mpi_get_opaque</code> and <code>gcry_mpi_release</code>.  Use
<code>gcry_mpi_scan</code> to convert a string of arbitrary bytes into an MPI.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fopaque_005fcopy"></a><u>Function:</u> gcry_mpi_t <b>gcry_mpi_set_opaque_copy</b><i> (gcry_mpi_t <var>a</var>, const void *<var>p</var>, unsigned int <var>nbits</var>)</i></dt>
<dd>
<p>Same as <code>gcry_mpi_set_opaque</code> but ownership of <var>p</var> is not
taken; instead a copy of <var>p</var> is used.
</p></dd></dl>


<dl>
<dt><a name="index-gcry_005fmpi_005fget_005fopaque"></a><u>Function:</u> void * <b>gcry_mpi_get_opaque</b><i> (gcry_mpi_t <var>a</var>, unsigned int *<var>nbits</var>)</i></dt>
<dd>
<p>Return a pointer to an opaque value stored in <var>a</var> and return its
size in <var>nbits</var>.  Note that the returned pointer is still owned by
<var>a</var> and that the function should never be used for an non-opaque
MPI.
</p></dd></dl>

<p>Each MPI has an associated set of flags for special purposes.  The
currently defined flags are:
</p>
<dl compact="compact">
<dt> <code>GCRYMPI_FLAG_SECURE</code></dt>
<dd><p>Setting this flag converts <var>a</var> into an MPI stored in &quot;secure
memory&quot;.  Clearing this flag is not allowed.
</p></dd>
<dt> <code>GCRYMPI_FLAG_OPAQUE</code></dt>
<dd><p>This is an internal flag, indicating that an opaque value and not an
integer is stored.  This is an read-only flag; it may not be set or
cleared.
</p></dd>
<dt> <code>GCRYMPI_FLAG_IMMUTABLE</code></dt>
<dd><p>If this flag is set, the MPI is marked as immutable.  Setting or
changing the value of that MPI is ignored and an error message is
logged.  The flag is sometimes useful for debugging.
</p></dd>
<dt> <code>GCRYMPI_FLAG_CONST</code></dt>
<dd><p>If this flag is set, the MPI is marked as a constant and as immutable
Setting or changing the value of that MPI is ignored and an error
message is logged.  Such an MPI will never be deallocated and may thus
be used without copying.  Note that using <code>gcry_mpi_copy</code> will return a
copy of that constant with this and the immutable flag cleared.  A few
commonly used constants are pre-defined and accessible using the
macros <code>GCRYMPI_CONST_ONE</code>, <code>GCRYMPI_CONST_TWO</code>,
<code>GCRYMPI_CONST_THREE</code>, <code>GCRYMPI_CONST_FOUR</code>, and
<code>GCRYMPI_CONST_EIGHT</code>.
</p></dd>
<dt> <code>GCRYMPI_FLAG_USER1</code></dt>
<dt> <code>GCRYMPI_FLAG_USER2</code></dt>
<dt> <code>GCRYMPI_FLAG_USER3</code></dt>
<dt> <code>GCRYMPI_FLAG_USER4</code></dt>
<dd><p>These flags are reserved for use by the application.
</p></dd>
</dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fset_005fflag"></a><u>Function:</u> void <b>gcry_mpi_set_flag</b><i> (gcry_mpi_t <var>a</var>,  enum gcry_mpi_flag <var>flag</var>)</i></dt>
<dd>
<p>Set the <var>flag</var> for the MPI <var>a</var>.  The only allowed flags are
<code>GCRYMPI_FLAG_SECURE</code>, <code>GCRYMPI_FLAG_IMMUTABLE</code>, and
<code>GCRYMPI_FLAG_CONST</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fclear_005fflag"></a><u>Function:</u> void <b>gcry_mpi_clear_flag</b><i> (gcry_mpi_t <var>a</var>,  enum gcry_mpi_flag <var>flag</var>)</i></dt>
<dd>
<p>Clear <var>flag</var> for the multi-precision-integers <var>a</var>.  The only
allowed flag is <code>GCRYMPI_FLAG_IMMUTABLE</code> but only if
<code>GCRYMPI_FLAG_CONST</code> is not set.  If <code>GCRYMPI_FLAG_CONST</code> is
set, clearing <code>GCRYMPI_FLAG_IMMUTABLE</code> will simply be ignored.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmpi_005fget_005fflag"></a><u>Function:</u> int <b>gcry_mpi_get_flag</b><i> (gcry_mpi_t <var>a</var>,  enum gcry_mpi_flag <var>flag</var>)</i></dt>
<dd>
<p>Return true if <var>flag</var> is set for <var>a</var>.
</p></dd></dl>


<p>To put a random value into an MPI, the following convenience function
may be used:
</p>
<dl>
<dt><a name="index-gcry_005fmpi_005frandomize"></a><u>Function:</u> void <b>gcry_mpi_randomize</b><i> (gcry_mpi_t <var>w</var>, unsigned int <var>nbits</var>, enum gcry_random_level <var>level</var>)</i></dt>
<dd>
<p>Set the multi-precision-integers <var>w</var> to a random non-negative number of
<var>nbits</var>, using random data quality of level <var>level</var>.  In case
<var>nbits</var> is not a multiple of a byte, <var>nbits</var> is rounded up to
the next byte boundary.  When using a <var>level</var> of
<code>GCRY_WEAK_RANDOM</code>, this function makes use of
<code>gcry_create_nonce</code>.
</p></dd></dl>

<hr size="6">
<a name="Prime-numbers"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Miscellaneous" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Generation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#MPI-library" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Prime-numbers-1"></a>
<h1 class="chapter">13. Prime numbers</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Generation">13.1 Generation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  Generation of new prime numbers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Checking">13.2 Checking</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Checking if a given number is prime.
</td></tr>
</table>

<hr size="6">
<a name="Generation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Prime-numbers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Checking" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Generation-1"></a>
<h2 class="section">13.1 Generation</h2>

<dl>
<dt><a name="index-gcry_005fprime_005fgenerate"></a><u>Function:</u> gcry_error_t <b>gcry_prime_generate</b><i> (gcry_mpi_t *<var>prime</var>,unsigned int <var>prime_bits</var>, unsigned int <var>factor_bits</var>, gcry_mpi_t **<var>factors</var>, gcry_prime_check_func_t <var>cb_func</var>, void *<var>cb_arg</var>, gcry_random_level_t <var>random_level</var>, unsigned int <var>flags</var>)</i></dt>
<dd>
<p>Generate a new prime number of <var>prime_bits</var> bits and store it in
<var>prime</var>.  If <var>factor_bits</var> is non-zero, one of the prime factors
of (<var>prime</var> - 1) / 2 must be <var>factor_bits</var> bits long.  If
<var>factors</var> is non-zero, allocate a new, <code>NULL</code>-terminated array
holding the prime factors and store it in <var>factors</var>.  <var>flags</var>
might be used to influence the prime number generation process.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fprime_005fgroup_005fgenerator"></a><u>Function:</u> gcry_error_t <b>gcry_prime_group_generator</b><i> (gcry_mpi_t *<var>r_g</var>, gcry_mpi_t <var>prime</var>, gcry_mpi_t *<var>factors</var>, gcry_mpi_t <var>start_g</var>)</i></dt>
<dd>
<p>Find a generator for <var>prime</var> where the factorization of
(<var>prime</var> - 1) is in the <code>NULL</code> terminated array <var>factors</var>.
Return the generator as a newly allocated MPI in <var>r_g</var>.  If
<var>start_g</var> is not <code>NULL</code>, use this as the start for the search.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fprime_005frelease_005ffactors"></a><u>Function:</u> void <b>gcry_prime_release_factors</b><i> (gcry_mpi_t *<var>factors</var>)</i></dt>
<dd>
<p>Convenience function to release the <var>factors</var> array.
</p></dd></dl>

<hr size="6">
<a name="Checking"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Generation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Checking-1"></a>
<h2 class="section">13.2 Checking</h2>

<dl>
<dt><a name="index-gcry_005fprime_005fcheck"></a><u>Function:</u> gcry_error_t <b>gcry_prime_check</b><i> (gcry_mpi_t <var>p</var>, unsigned int <var>flags</var>)</i></dt>
<dd>
<p>Check whether the number <var>p</var> is prime.  Returns zero in case <var>p</var>
is indeed a prime, returns <code>GPG_ERR_NO_PRIME</code> in case <var>p</var> is
not a prime and a different error code in case something went horribly
wrong.
</p></dd></dl>

<hr size="6">
<a name="Utilities"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Checking" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Memory-allocation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Prime-numbers" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Utilities-1"></a>
<h1 class="chapter">14. Utilities</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   Functions related to memory allocation.
</td></tr>
<tr><td align="left" valign="top"><a href="#Context-management">14.2 Context management</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Functions related to context management.
</td></tr>
<tr><td align="left" valign="top"><a href="#Buffer-description">14.3 Buffer description</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  A data type to describe buffers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Config-reporting">14.4 How to check Libgcrypt&rsquo;s configuration.</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>


<hr size="6">
<a name="Memory-allocation"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Utilities" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Context-management" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Utilities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Memory-allocation-1"></a>
<h2 class="section">14.1 Memory allocation</h2>

<dl>
<dt><a name="index-gcry_005fmalloc"></a><u>Function:</u> void * <b>gcry_malloc</b><i> (size_t <var>n</var>)</i></dt>
<dd>
<p>This function tries to allocate <var>n</var> bytes of memory.  On success
it returns a pointer to the memory area, in an out-of-core condition,
it returns <code>NULL</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fmalloc_005fsecure"></a><u>Function:</u> void * <b>gcry_malloc_secure</b><i> (size_t <var>n</var>)</i></dt>
<dd><p>Like <code>gcry_malloc</code>, but uses secure memory.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcalloc"></a><u>Function:</u> void * <b>gcry_calloc</b><i> (size_t <var>n</var>, size_t <var>m</var>)</i></dt>
<dd>
<p>This function allocates a cleared block of memory (i.e. initialized with
zero bytes) long enough to contain a vector of <var>n</var> elements, each of
size <var>m</var> bytes.  On success it returns a pointer to the memory
block; in an out-of-core condition, it returns <code>NULL</code>.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005fcalloc_005fsecure"></a><u>Function:</u> void * <b>gcry_calloc_secure</b><i> (size_t <var>n</var>, size_t <var>m</var>)</i></dt>
<dd><p>Like <code>gcry_calloc</code>, but uses secure memory.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005frealloc"></a><u>Function:</u> void * <b>gcry_realloc</b><i> (void *<var>p</var>, size_t <var>n</var>)</i></dt>
<dd>
<p>This function tries to resize the memory area pointed to by <var>p</var> to
<var>n</var> bytes.  On success it returns a pointer to the new memory
area, in an out-of-core condition, it returns <code>NULL</code>.  Depending on
whether the memory pointed to by <var>p</var> is secure memory or not,
<code>gcry_realloc</code> tries to use secure memory as well.
</p></dd></dl>

<dl>
<dt><a name="index-gcry_005ffree"></a><u>Function:</u> void <b>gcry_free</b><i> (void *<var>p</var>)</i></dt>
<dd><p>Release the memory area pointed to by <var>p</var>.
</p></dd></dl>


<hr size="6">
<a name="Context-management"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Memory-allocation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Buffer-description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Utilities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Context-management-1"></a>
<h2 class="section">14.2 Context management</h2>

<p>Some function make use of a context object.  As of now, there are only
a few math functions. However, future versions of Libgcrypt may make
more use of this context object.
</p>
<dl>
<dt><a name="index-gcry_005fctx_005ft"></a><u>Data type:</u> <b>gcry_ctx_t</b></dt>
<dd><p>This type is used to refer to the general purpose context object.
</p></dd></dl>

<p><a name="gcry_005fctx_005frelease"></a>
</p><dl>
<dt><a name="index-gcry_005fctx_005frelease"></a><u>Function:</u> void <b>gcry_ctx_release</b><i> (gcry_ctx_t <var>ctx</var>)</i></dt>
<dd><p>Release the context object <var>ctx</var> and all associated resources.  A
<code>NULL</code> passed as <var>ctx</var> is ignored.
</p></dd></dl>

<hr size="6">
<a name="Buffer-description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Context-management" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Config-reporting" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Utilities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Buffer-description-1"></a>
<h2 class="section">14.3 Buffer description</h2>

<p>To help hashing non-contiguous areas of memory, a general purpose data
type is defined:
</p>
<dl>
<dt><a name="index-gcry_005fbuffer_005ft"></a><u>Data type:</u> <b>gcry_buffer_t</b></dt>
<dd><p>This type is a structure to describe a buffer.  The user should make
sure that this structure is initialized to zero.  The available fields
of this structure are:
</p>
<dl compact="compact">
<dt> <code>.size</code></dt>
<dd><p>  This is either 0 for no information available or indicates the
  allocated length of the buffer.
  </p></dd>
<dt> <code>.off</code></dt>
<dd><p>  This is the offset into the buffer.
  </p></dd>
<dt> <code>.len</code></dt>
<dd><p>  This is the valid length of the buffer starting at <code>.off</code>.
  </p></dd>
<dt> <code>.data</code></dt>
<dd><p>  This is the address of the buffer.
  </p></dd>
</dl>
</dd></dl>

<hr size="6">
<a name="Config-reporting"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Buffer-description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Utilities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Utilities" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="How-to-check-Libgcrypt_0027s-configuration_002e"></a>
<h2 class="section">14.4 How to check Libgcrypt&rsquo;s configuration.</h2>

<p>Although <code>GCRYCTL_PRINT_CONFIG</code> can be used to print
configuration options, it is sometimes necessary to check them in a
program.  This can be accomplished by using this function:
</p>
<dl>
<dt><a name="index-gcry_005fget_005fconfig"></a><u>Function:</u> char * <b>gcry_get_config</b><i>              (int <var>mode</var>,              const char *<var>what</var>)</i></dt>
<dd>
<p>This function returns a malloced string with colon delimited configure
options.  With a value of 0 for <var>mode</var> this string resembles the
output of <code>GCRYCTL_PRINT_CONFIG</code>.  However, if <var>what</var> is not
<code>NULL</code>, only the line where the first field (e.g. &quot;cpu-arch&quot;) matches
<var>what</var> is returned.
</p>
<p>Other values than 0 for <var>mode</var> are not defined.  The caller shall
free the string using <code>gcry_free</code>.  On error <code>NULL</code> is returned and
<code>ERRNO</code> is set; if a value for <var>what</var> is unknown, <code>ERRNO</code> will be set to 0.
</p></dd></dl>


<hr size="6">
<a name="Tools"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Config-reporting" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#hmac256" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Utilities" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tools-1"></a>
<h1 class="chapter">15. Tools</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#hmac256">15.1 A HMAC-SHA-256 tool</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> A standalone HMAC-SHA-256 implementation
</td></tr>
</table>


<hr size="6">
<a name="hmac256"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Tools" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Tools" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tools" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="A-HMAC_002dSHA_002d256-tool"></a>
<h2 class="section">15.1 A HMAC-SHA-256 tool</h2>




<p>This is a standalone HMAC-SHA-256 implementation used to compute an
HMAC-SHA-256 message authentication code.  The tool has originally
been developed as a second implementation for Libgcrypt to allow
comparing against the primary implementation and to be used for
internal consistency checks.  It should not be used for sensitive data
because no mechanisms to clear the stack etc are used.
</p>
<p>The code has been written in a highly portable manner and requires
only a few standard definitions to be provided in a config.h file.
</p>
<p><code>hmac256</code> is commonly invoked as
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">hmac256 &quot;This is my key&quot; foo.txt
</pre></td></tr></table>

<p>This compute the MAC on the file &lsquo;<tt>foo.txt</tt>&rsquo; using the key given on
the command line.
</p>

<p><code>hmac256</code> understands these options:
</p>
<dl compact="compact">
<dt> <code>--binary</code></dt>
<dd><p>Print the MAC as a binary string.  The default is to print the MAC
encoded as lower case hex digits.
</p>
</dd>
<dt> <code>--version</code></dt>
<dd><p>Print version of the program and exit.
</p>
</dd>
</dl>




<hr size="6">
<a name="Configuration"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#hmac256" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Tools" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Configuration-files-and-environment-variables"></a>
<h1 class="chapter">16. Configuration files and environment variables</h1>

<p>This chapter describes which files and environment variables can be
used to change the behaviour of Libgcrypt.
</p>
<p>The environment variables considered by Libgcrypt are:
</p>
<dl compact="compact">
<dt> <code>LIBGCRYPT_FORCE_FIPS_MODE</code></dt>
<dd><a name="index-LIBGCRYPT_005fFORCE_005fFIPS_005fMODE"></a>
<p>By setting this variable to any value, Libgcrypt is put into FIPS mode
at initialization time (see <a href="#enabling-fips-mode">enabling fips mode</a>).
</p>
</dd>
<dt> <code>GCRYPT_BARRETT</code></dt>
<dd><a name="index-GCRYPT_005fBARRETT"></a>
<p>By setting this variable to any value a different algorithm for
modular reduction is used for ECC.
</p>
</dd>
<dt> <code>GCRYPT_RNDUNIX_DBG</code></dt>
<dt> <code>GCRYPT_RNDUNIX_DBGALL</code></dt>
<dd><a name="index-GCRYPT_005fRNDUNIX_005fDBG"></a>
<a name="index-GCRYPT_005fRNDUNIX_005fDBGALL"></a>
<p>These two environment variables are used to enable debug output for
the rndunix entropy gatherer, which is used on systems lacking a
/dev/random device.  The value of <code>GCRYPT_RNDUNIX_DBG</code> is a file
name or <code>-</code> for stdout.  Debug output is the written to this
file.  Setting <code>GCRYPT_RNDUNIX_DBGALL</code> to any value will make the debug
output more verbose.
</p>
</dd>
<dt> <code>GCRYPT_RNDW32_NOPERF</code></dt>
<dd><a name="index-GCRYPT_005fRNDW32_005fNOPERF"></a>
<p>Setting this environment variable on Windows to any value disables
the use of performance data (<code>HKEY_PERFORMANCE_DATA</code>) as source
for entropy.  On some older Windows systems this could help to speed
up the creation of random numbers but also decreases the amount of
data used to init the random number generator.
</p>
</dd>
<dt> <code>GCRYPT_RNDW32_DBG</code></dt>
<dd><a name="index-GCRYPT_005fRNDW32_005fDBG"></a>
<p>Setting the value of this variable to a positive integer logs
information about the Windows entropy gatherer using the standard log
interface.
</p>

</dd>
<dt> <code>HOME</code></dt>
<dd><a name="index-HOME"></a>
<p>This is used to locate the socket to connect to the EGD random
daemon.  The EGD can be used on system without a /dev/random to speed
up the random number generator.  It is not needed on the majority of
today&rsquo;s operating systems, and support for EGD requires the use of a
configure option at build time.
</p>
</dd>
</dl>

<p>The files which Libgcrypt uses to retrieve system information and the
files which can be created by the user to modify Libgcrypt&rsquo;s behavior
are:
</p>
<dl compact="compact">
<dt> &lsquo;<tt>/etc/gcrypt/hwf.deny</tt>&rsquo;</dt>
<dd><a name="index-_002fetc_002fgcrypt_002fhwf_002edeny"></a>
<p>This file can be used to disable the use of hardware based
optimizations, see <a href="#hardware-features">hardware features</a>.
</p>

</dd>
<dt> &lsquo;<tt>/etc/gcrypt/random.conf</tt>&rsquo;</dt>
<dd><a name="index-_002fetc_002fgcrypt_002frandom_002econf"></a>
<p>This file can be used to globally change parameters of the random
generator.  The file is a simple text file where empty lines and
lines with the first non white-space character being &rsquo;#&rsquo; are
ignored.  Supported options are
</p>
<dl compact="compact">
<dt> &lsquo;<tt>disable-jent</tt>&rsquo;</dt>
<dd><a name="index-disable_002djent"></a>
<p>Disable the use of the jitter based entropy generator.
</p>
</dd>
<dt> &lsquo;<tt>only-urandom</tt>&rsquo;</dt>
<dd><a name="index-only_002durandom"></a>
<p>Always use the non-blocking /dev/urandom or the respective system call
instead of the blocking /dev/random.  If Libgcrypt is used early in
the boot process of the system, this option should only be used if the
system also supports the getrandom system call.
</p>
</dd>
</dl>

</dd>
<dt> &lsquo;<tt>/etc/gcrypt/fips_enabled</tt>&rsquo;</dt>
<dt> &lsquo;<tt>/proc/sys/crypto/fips_enabled</tt>&rsquo;</dt>
<dd><a name="index-_002fetc_002fgcrypt_002ffips_005fenabled"></a>
<a name="index-fips_005fenabled"></a>
<p>On Linux these files are used to enable FIPS mode, see <a href="#enabling-fips-mode">enabling fips mode</a>.
</p>
</dd>
<dt> &lsquo;<tt>/proc/cpuinfo</tt>&rsquo;</dt>
<dt> &lsquo;<tt>/proc/self/auxv</tt>&rsquo;</dt>
<dd><a name="index-_002fproc_002fcpuinfo"></a>
<a name="index-_002fproc_002fself_002fauxv"></a>
<p>On Linux running on the ARM architecture, these files are used to read
hardware capabilities of the CPU.
</p>
</dd>
</dl>


<hr size="6">
<a name="Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Configuration" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public_002dKey-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Configuration" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Architecture-1"></a>
<h1 class="chapter">17. Architecture</h1>

<p>This chapter describes the internal architecture of Libgcrypt.
</p>
<p>Libgcrypt is a function library written in ISO C-90.  Any compliant
compiler should be able to build Libgcrypt as long as the target is
either a POSIX platform or compatible to the API used by Windows NT.
Provisions have been taken so that the library can be directly used from
C++ applications; however building with a C++ compiler is not supported.
</p>
<p>Building Libgcrypt is done by using the common <code>./configure &amp;&amp; make</code>
approach.  The configure command is included in the source distribution,
and as a portable shell script it works on any Unix-alike system.  The
result of running the configure script are a C header file
(&lsquo;<tt>config.h</tt>&rsquo;), customized Makefiles, the setup of symbolic links and
a few other things.  After that the make tool builds and optionally
installs the library and the documentation.  See the files
&lsquo;<tt>INSTALL</tt>&rsquo; and &lsquo;<tt>README</tt>&rsquo; in the source distribution on how to do
this.
</p>
<p>Libgcrypt is developed using a Subversion<a name="DOCF3" href="#FOOT3">(3)</a> repository.  Although all released
versions are tagged in this repository, they should not be used to build
production versions of Libgcrypt.  Instead released tarballs should be
used.  These tarballs are available from several places with the master
copy at &lt;<code>ftp://ftp.gnupg.org/gcrypt/libgcrypt/</code>&gt;.
Announcements of new releases are posted to the
&lt;<code>gnupg-announce@gnupg.org</code>&gt; mailing list<a name="DOCF4" href="#FOOT4">(4)</a>.
</p>

<div class="float"><a name="fig_003asubsystems"></a>

 <img src="libgcrypt-modules.jpg" alt="Libgcrypt subsystems">
</div><p><strong>Figure 17.1: Libgcrypt subsystems
</strong>
</p>
<p>Libgcrypt consists of several subsystems (see <a href="#fig_003asubsystems">fig:subsystems</a>) and
all these subsystems provide a public API; this includes the helper
subsystems like the one for S-expressions.  The API style depends on the
subsystem; in general an open-use-close approach is implemented.  The
open returns a handle to a context used for all further operations on
this handle, several functions may then be used on this handle, and a
final close function releases all resources associated with the handle.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Public_002dKey-Subsystem-Architecture">17.1 Public-Key Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              About public keys.
</td></tr>
<tr><td align="left" valign="top"><a href="#Symmetric-Encryption-Subsystem-Architecture">17.2 Symmetric Encryption Subsystem Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    About standard ciphers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Hashing-and-MACing-Subsystem-Architecture">17.3 Hashing and MACing Subsystem Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      About hashing.
</td></tr>
<tr><td align="left" valign="top"><a href="#Multi_002dPrecision_002dInteger-Subsystem-Architecture">17.4 Multi-Precision-Integer Subsystem Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> About big integers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Prime_002dNumber_002dGenerator-Subsystem-Architecture">17.5 Prime-Number-Generator Subsystem Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  About prime numbers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Random_002dNumber-Subsystem-Architecture">17.6 Random-Number Subsystem Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           About random stuff.
</td></tr>
</table>



<hr size="6">
<a name="Public_002dKey-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-Encryption-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Public_002dKey-Architecture"></a>
<h2 class="section">17.1 Public-Key Architecture</h2>

<p>Because public key cryptography is almost always used to process small
amounts of data (hash values or session keys), the interface is not
implemented using the open-use-close paradigm, but with single
self-contained functions.  Due to the wide variety of parameters
required by different algorithms, S-expressions - as flexible way to
convey these parameters - are used.  There is a set of helper functions
to work with these S-expressions.
</p>
<p>Aside from functions to register new algorithms, map algorithms names to
algorithms identifiers and to lookup properties of a key, the
following main functions are available:
</p>
<dl compact="compact">
<dt> <code>gcry_pk_encrypt</code></dt>
<dd><p>Encrypt data using a public key.
</p>
</dd>
<dt> <code>gcry_pk_decrypt</code></dt>
<dd><p>Decrypt data using a private key.
</p>
</dd>
<dt> <code>gcry_pk_sign</code></dt>
<dd><p>Sign data using a private key.
</p>
</dd>
<dt> <code>gcry_pk_verify</code></dt>
<dd><p>Verify that a signature matches the data.
</p>
</dd>
<dt> <code>gcry_pk_testkey</code></dt>
<dd><p>Perform a consistency over a public or private key.
</p>
</dd>
<dt> <code>gcry_pk_genkey</code></dt>
<dd><p>Create a new public/private key pair.
</p>
</dd>
</dl>

<p>All these functions
lookup the module implementing the algorithm and pass the actual work
to that module.  The parsing of the S-expression input and the
construction of S-expression for the return values is done by the high
level code (&lsquo;<tt>cipher/pubkey.c</tt>&rsquo;).  Thus the internal interface
between the algorithm modules and the high level functions passes data
in a custom format.
</p>
<p>By default Libgcrypt uses a blinding technique for RSA decryption to
mitigate real world timing attacks over a network: Instead of using
the RSA decryption directly, a blinded value <em>y = x r^e \bmod n</em>
is decrypted and the unblinded value <em>x&rsquo; = y&rsquo; r^-1 \bmod n</em>
returned.  The blinding value <em>r</em> is a random value with the size
of the modulus <em>n</em> and generated with <code>GCRY_WEAK_RANDOM</code>
random level.
</p>
<a name="index-X9_002e31-1"></a>
<a name="index-FIPS-186-1"></a>
<p>The algorithm used for RSA and DSA key generation depends on whether
Libgcrypt is operating in standard or in FIPS mode.  In standard mode
an algorithm based on the Lim-Lee prime number generator is used.  In
FIPS mode RSA keys are generated as specified in ANSI X9.31 (1998) and
DSA keys as specified in FIPS 186-2.
</p>


<hr size="6">
<a name="Symmetric-Encryption-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Public_002dKey-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hashing-and-MACing-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Symmetric-Encryption-Subsystem-Architecture-1"></a>
<h2 class="section">17.2 Symmetric Encryption Subsystem Architecture</h2>

<p>The interface to work with symmetric encryption algorithms is made up
of functions from the <code>gcry_cipher_</code> name space.  The
implementation follows the open-use-close paradigm and uses registered
algorithm modules for the actual work.  Unless a module implements
optimized cipher mode implementations, the high level code
(&lsquo;<tt>cipher/cipher.c</tt>&rsquo;) implements the modes and calls the core
algorithm functions to process each block.
</p>
<p>The most important functions are:
</p>
<dl compact="compact">
<dt> <code>gcry_cipher_open</code></dt>
<dd><p>Create a new instance to encrypt or decrypt using a specified
algorithm and mode.
</p>
</dd>
<dt> <code>gcry_cipher_close</code></dt>
<dd><p>Release an instance.
</p>
</dd>
<dt> <code>gcry_cipher_setkey</code></dt>
<dd><p>Set a key to be used for encryption or decryption.
</p>
</dd>
<dt> <code>gcry_cipher_setiv</code></dt>
<dd><p>Set an initialization vector to be used for encryption or decryption.
</p>
</dd>
<dt> <code>gcry_cipher_encrypt</code></dt>
<dt> <code>gcry_cipher_decrypt</code></dt>
<dd><p>Encrypt or decrypt data.  These functions may be called with arbitrary
amounts of data and as often as needed to encrypt or decrypt all data.
</p>
<p>There is no strict alignment requirements for data, but the best
performance can be archived if data is aligned to cacheline boundary.
</p>
</dd>
</dl>

<p>There are also functions to query properties of algorithms or context,
like block length, key length, map names or to enable features like
padding methods.
</p>


<hr size="6">
<a name="Hashing-and-MACing-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Symmetric-Encryption-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Multi_002dPrecision_002dInteger-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Hashing-and-MACing-Subsystem-Architecture-1"></a>
<h2 class="section">17.3 Hashing and MACing Subsystem Architecture</h2>

<p>The interface to work with message digests and CRC algorithms is made
up of functions from the <code>gcry_md_</code> name space.  The
implementation follows the open-use-close paradigm and uses registered
algorithm modules for the actual work.  Although CRC algorithms are
not considered cryptographic hash algorithms, they share enough
properties so that it makes sense to handle them in the same way.
It is possible to use several algorithms at once with one context and
thus compute them all on the same data.
</p>
<p>The most important functions are:
</p>
<dl compact="compact">
<dt> <code>gcry_md_open</code></dt>
<dd><p>Create a new message digest instance and optionally enable one
algorithm.  A flag may be used to turn the message digest algorithm
into a HMAC algorithm.
</p>
</dd>
<dt> <code>gcry_md_enable</code></dt>
<dd><p>Enable an additional algorithm for the instance.
</p>
</dd>
<dt> <code>gcry_md_setkey</code></dt>
<dd><p>Set the key for the MAC.
</p>
</dd>
<dt> <code>gcry_md_write</code></dt>
<dd><p>Pass more data for computing the message digest to an instance.
</p>
<p>There is no strict alignment requirements for data, but the best
performance can be archived if data is aligned to cacheline boundary.
</p>
</dd>
<dt> <code>gcry_md_putc</code></dt>
<dd><p>Buffered version of <code>gcry_md_write</code> implemented as a macro.
</p>
</dd>
<dt> <code>gcry_md_read</code></dt>
<dd><p>Finalize the computation of the message digest or HMAC and return the
result.
</p>
</dd>
<dt> <code>gcry_md_close</code></dt>
<dd><p>Release an instance
</p>
</dd>
<dt> <code>gcry_md_hash_buffer</code></dt>
<dd><p>Convenience function to directly compute a message digest over a
memory buffer without the need to create an instance first.
</p>
</dd>
</dl>

<p>There are also functions to query properties of algorithms or the
instance, like enabled algorithms, digest length, map algorithm names.
It is also possible to reset an instance or to copy the current state
of an instance at any time.  Debug functions to write the hashed data
to files are available as well.
</p>


<hr size="6">
<a name="Multi_002dPrecision_002dInteger-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hashing-and-MACing-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Prime_002dNumber_002dGenerator-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Multi_002dPrecision_002dInteger-Subsystem-Architecture-1"></a>
<h2 class="section">17.4 Multi-Precision-Integer Subsystem Architecture</h2>

<p>The implementation of Libgcrypt&rsquo;s big integer computation code is
based on an old release of GNU Multi-Precision Library (GMP).  The
decision not to use the GMP library directly was due to stalled
development at that time and due to security requirements which could
not be provided by the code in GMP.  As GMP does, Libgcrypt provides
high performance assembler implementations of low level code for
several CPUS to gain much better performance than with a generic C
implementation.
</p>
<p>Major features of Libgcrypt&rsquo;s multi-precision-integer code compared to
GMP are:
</p>
<ul>
<li>
Avoidance of stack based allocations to allow protection against
swapping out of sensitive data and for easy zeroing of sensitive
intermediate results.

</li><li>
Optional use of secure memory and tracking of its use so that results
are also put into secure memory.

</li><li>
MPIs are identified by a handle (implemented as a pointer) to give
better control over allocations and to augment them with extra
properties like opaque data.

</li><li>
Removal of unnecessary code to reduce complexity.

</li><li>
Functions specialized for public key cryptography.

</li></ul>



<hr size="6">
<a name="Prime_002dNumber_002dGenerator-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Multi_002dPrecision_002dInteger-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random_002dNumber-Subsystem-Architecture" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Prime_002dNumber_002dGenerator-Subsystem-Architecture-1"></a>
<h2 class="section">17.5 Prime-Number-Generator Subsystem Architecture</h2>

<p>Libgcrypt provides an interface to its prime number generator.  These
functions make use of the internal prime number generator which is
required for the generation for public key pairs.  The plain prime
checking function is exported as well.
</p>
<p>The generation of random prime numbers is based on the Lim and Lee
algorithm to create practically safe primes.<a name="DOCF5" href="#FOOT5">(5)</a>
This algorithm creates a pool of smaller primes, select a few of them
to create candidate primes of the form <em>2 * p_0 * p_1 * ... * p_n
+ 1</em>, tests the candidate for primality and permutates the pool until
a prime has been found.  It is possible to clamp one of the small
primes to a certain size to help DSA style algorithms.  Because most
of the small primes in the pool are not used for the resulting prime
number, they are saved for later use (see <code>save_pool_prime</code> and
<code>get_pool_prime</code> in &lsquo;<tt>cipher/primegen.c</tt>&rsquo;).  The prime
generator optionally supports the finding of an appropriate generator.
</p>
<p>The primality test works in three steps:
</p>
<ol>
<li>
The standard sieve algorithm using the primes up to 4999 is used as a
quick first check.

</li><li>
A Fermat test filters out almost all non-primes.

</li><li>
A 5 round Rabin-Miller test is finally used.  The first round uses a
witness of 2, whereas the next rounds use a random witness.

</li></ol>

<p>To support the generation of RSA and DSA keys in FIPS mode according
to X9.31 and FIPS 186-2, Libgcrypt implements two additional prime
generation functions: <code>_gcry_derive_x931_prime</code> and
<code>_gcry_generate_fips186_2_prime</code>.  These functions are internal
and not available through the public API.
</p>


<hr size="6">
<a name="Random_002dNumber-Subsystem-Architecture"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Prime_002dNumber_002dGenerator-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#CSPRNG-Description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Random_002dNumber-Subsystem-Architecture-1"></a>
<h2 class="section">17.6 Random-Number Subsystem Architecture</h2>

<p>Libgcrypt provides 3 levels or random quality: The level
<code>GCRY_VERY_STRONG_RANDOM</code> usually used for key generation, the
level <code>GCRY_STRONG_RANDOM</code> for all other strong random
requirements and the function <code>gcry_create_nonce</code> which is used
for weaker usages like nonces.  There is also a level
<code>GCRY_WEAK_RANDOM</code> which in general maps to
<code>GCRY_STRONG_RANDOM</code> except when used with the function
<code>gcry_mpi_randomize</code>, where it randomizes a
multi-precision integer using the <code>gcry_create_nonce</code> function.
</p>
<p>There are three distinct random generators available:
</p>
<ul>
<li>
The Continuously Seeded Pseudo Random Number Generator (CSPRNG), which
is based on the classic GnuPG derived big pool implementation.
Implemented in <code>random/random-csprng.c</code> and used by default.
</li><li>
The Deterministic Random Bits Generator (DRBG), based on the
specification by NIST SP800-90A.  Implemented in
<code>random/random-drbg.c</code> and used if Libgcrypt is in FIPS mode,
or Libgcrypt is configured by GCRYCTL_SET_PREFERRED_RNG_TYPE with
GCRY_RNG_TYPE_FIPS.
</li><li>
Direct access to native RNG on the system.  Implemented in
<code>random/random-system.c</code> and used if Libgcrypt is configured by
GCRYCTL_SET_PREFERRED_RNG_TYPE with GCRY_RNG_TYPE_SYSTEM.
</li></ul>

<p>All generators make use of so-called entropy gathering modules:
</p>
<dl compact="compact">
<dt> rndgetentropy</dt>
<dd><p>Uses the operating system provided <code>getentropy</code> function.
</p>
</dd>
<dt> rndoldlinux</dt>
<dd><p>Uses the operating system provided &lsquo;<tt>/dev/random</tt>&rsquo; and
&lsquo;<tt>/dev/urandom</tt>&rsquo; devices.  The &lsquo;<tt>/dev/gcrypt/random.conf</tt>&rsquo;
config option &lsquo;<samp>only-urandom</samp>&rsquo; can be used to inhibit the use of
the blocking &lsquo;<tt>/dev/random</tt>&rsquo; device.
</p>
</dd>
<dt> rndunix</dt>
<dd><p>Runs several operating system commands to collect entropy from sources
like virtual machine and process statistics.  It is a kind of
poor-man&rsquo;s <code>/dev/random</code> implementation.  It is not available in
FIPS mode.
</p>
</dd>
<dt> rndegd</dt>
<dd><p>Uses the operating system provided Entropy Gathering Daemon (EGD).
The EGD basically uses the same algorithms as rndunix does.  However
as a system daemon it keeps on running and thus can serve several
processes requiring entropy input and does not waste collected entropy
if the application does not need all the collected entropy.
</p>
</dd>
<dt> rndw32</dt>
<dd><p>Targeted for the Microsoft Windows OS.  It uses certain properties of
that system and is the only gathering module available for that OS.
</p>
</dd>
<dt> rndhw</dt>
<dd><p>Extra module to collect additional entropy by utilizing a hardware
random number generator.  As of now the supported hardware RNG is
the Padlock engine of VIA (Centaur) CPUs and x86 CPUs with the RDRAND
instruction.
</p>
</dd>
<dt> rndjent</dt>
<dd><p>Extra module to collect additional entropy using a CPU jitter based
approach.  The &lsquo;<tt>/dev/gcrypt/random.conf</tt>&rsquo; config option
&lsquo;<samp>disable-jent</samp>&rsquo; can be used to inhibit the use of this module.
</p>
</dd>
</dl>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#CSPRNG-Description">17.6.1 Description of the CSPRNG</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
<tr><td align="left" valign="top"><a href="#DRBG-Description">17.6.2 Description of the DRBG</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>


<hr size="6">
<a name="CSPRNG-Description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Random_002dNumber-Subsystem-Architecture" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#DRBG-Description" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random_002dNumber-Subsystem-Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Description-of-the-CSPRNG"></a>
<h3 class="subsection">17.6.1 Description of the CSPRNG</h3>

<p>This random number generator is loosely modelled after the one
described in Peter Gutmann&rsquo;s paper &quot;Software Generation of
Practically Strong Random Numbers&quot;.<a name="DOCF6" href="#FOOT6">(6)</a>
</p>
<p>A pool of 600 bytes is used and mixed using the core SHA-1 hash
transform function.  Several extra features are used to make it
robust against a wide variety of attacks and to protect against
failures of subsystems.  The state of the generator may be saved to a
file and initially seeded form a file.
</p>
<p>Depending on how Libgcrypt was build, the generator is able to select
the best working entropy gathering module.  It makes use of the slow
and fast collection methods and requires the pool to be initially seeded
form the slow gatherer or a seed file.  An entropy estimation is used
to mix in enough data from the gather modules before returning the
actual random output.  Process fork detection and protection is
implemented.
</p>

<p>The implementation of the nonce generator (for
<code>gcry_create_nonce</code>) is a straightforward repeated hash design: A
28 byte buffer is initially seeded with the PID and the time in
seconds in the first 20 bytes and with 8 bytes of random taken from
the <code>GCRY_STRONG_RANDOM</code> generator.  Random numbers are then
created by hashing all the 28 bytes with SHA-1 and saving that again
in the first 20 bytes.  The hash is also returned as result.
</p>

<hr size="6">
<a name="DRBG-Description"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#CSPRNG-Description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random_002dNumber-Subsystem-Architecture" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Description-of-the-DRBG"></a>
<h3 class="subsection">17.6.2 Description of the DRBG</h3>

<p>The core of this deterministic random number generator is implemented
according to the document &ldquo;NIST Recommended DRBG Based on ANSI NIST
SP800-90A&rdquo;.  By default, this implementation uses the
DRBG_NOPR_HMACSHA256 variant (HMAC DRBG with DF with SHA256, without
prediction resistance.
</p>
<p>The generator is based on contexts to utilize the same core functions
for all random levels as required by the high-level interface.  All
random generators return their data in 128 bit blocks.  If the caller
requests fewer bits, the extra bits are not used.  The key for each
generator is only set once at the first time a generator context is
used.  The seed value is set along with the key and again after 1000
output blocks.
</p>
<p>On Unix like systems the <code>GCRY_VERY_STRONG_RANDOM</code> and
<code>GCRY_STRONG_RANDOM</code> generators are keyed and seeded using the
rndgetentropy or rndoldlinux module.  With rndoldlinux module, these
generators may block until the OS kernel has collected enough entropy.
When used with Microsoft Windows, the rndw32 module is used instead.
</p>
<p>The generator used for <code>gcry_create_nonce</code> is keyed and seeded
from the <code>GCRY_STRONG_RANDOM</code> generator.  Thus, with rndoldlinux
module, it may also block if the <code>GCRY_STRONG_RANDOM</code> generator
has not yet been used before and thus gets initialized on the first
use by <code>gcry_create_nonce</code>.  This special treatment is justified
by the weaker requirements for a nonce generator and to save precious
kernel entropy for use by the &ldquo;real&rdquo; random generators.
</p>




<hr size="6">
<a name="Self_002dTests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#DRBG-Description" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Architecture" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Description-of-the-Self_002dTests"></a>
<h1 class="appendix">A. Description of the Self-Tests</h1>

<p>In addition to the build time regression test suite, Libgcrypt
implements self-tests to be performed at runtime.  Which self-tests
are actually used depends on the mode Libgcrypt is used in.  In
standard mode a limited set of self-tests is run at the time an
algorithm is first used.  Note that not all algorithms feature a
self-test in standard mode.  The <code>GCRYCTL_SELFTEST</code> control
command may be used to run all implemented self-tests at any time;
this will even run more tests than those run in FIPS mode.
</p>
<p>If any of the self-tests fails, the library immediately returns an
error code to the caller.  If Libgcrypt is in FIPS mode, the self-tests
will be performed within the &ldquo;Self-Test&rdquo; state and any failure puts
the library into the &ldquo;Error&rdquo; state.
</p>
<hr size="6">
<a name="Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Self_002dTests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-Cipher-Algorithm-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">A.1 Power-Up Tests</h2>

<p>Power-up tests are only performed if Libgcrypt is in FIPS mode.
</p>
<hr size="6">
<a name="Symmetric-Cipher-Algorithm-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hash-Algorithm-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.1 Symmetric Cipher Algorithm Power-Up Tests</h3>

<p>The following symmetric encryption algorithm tests are run during
power-up:
</p>
<dl compact="compact">
<dt> AES-128</dt>
<dd><p>A known answer tests is run using one test vector and one test
key with AES in ECB mode. (<code>cipher/rijndael.c:selftest_basic_128</code>)
</p>
</dd>
<dt> AES-192</dt>
<dd><p>A known answer tests is run using one test vector and one test
key with AES in ECB mode. (<code>cipher/rijndael.c:selftest_basic_192</code>)
</p>
</dd>
<dt> AES-256</dt>
<dd><p>A known answer tests is run using one test vector and one test key
with AES in ECB mode. (<code>cipher/rijndael.c:selftest_basic_256</code>)
</p></dd>
</dl>

<hr size="6">
<a name="Hash-Algorithm-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Symmetric-Cipher-Algorithm-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MAC-Algorithm-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.2 Hash Algorithm Power-Up Tests</h3>

<p>The following hash algorithm tests are run during power-up:
</p>
<dl compact="compact">
<dt> SHA-1</dt>
<dd><p>A known answer test using the string <code>&quot;abc&quot;</code> is run.
(<code>cipher/sha1.c:selftests_sha1</code>)
</p></dd>
<dt> SHA-224</dt>
<dd><p>A known answer test using the string <code>&quot;abc&quot;</code> is run.
(<code>cipher/sha256.c:selftests_sha224</code>)
</p></dd>
<dt> SHA-256</dt>
<dd><p>A known answer test using the string <code>&quot;abc&quot;</code> is run.
(<code>cipher/sha256.c:selftests_sha256</code>)
</p></dd>
<dt> SHA-384</dt>
<dd><p>A known answer test using the string <code>&quot;abc&quot;</code> is run.
(<code>cipher/sha512.c:selftests_sha384</code>)
</p></dd>
<dt> SHA-512</dt>
<dd><p>A known answer test using the string <code>&quot;abc&quot;</code> is run.
(<code>cipher/sha512.c:selftests_sha512</code>)
</p></dd>
</dl>

<hr size="6">
<a name="MAC-Algorithm-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hash-Algorithm-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Random-Number-Power_002dUp-Test" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.3 MAC Algorithm Power-Up Tests</h3>

<p>The following MAC algorithm tests are run during power-up:
</p>
<dl compact="compact">
<dt> HMAC SHA-1</dt>
<dd><p>A known answer test using 9 bytes of data and a 64 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha1</code>)
</p></dd>
<dt> HMAC SHA-224</dt>
<dd><p>A known answer test using 28 bytes of data and a 4 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha224</code>)
</p></dd>
<dt> HMAC SHA-256</dt>
<dd><p>A known answer test using 28 bytes of data and a 4 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha256</code>)
</p></dd>
<dt> HMAC SHA-384</dt>
<dd><p>A known answer test using 28 bytes of data and a 4 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha384</code>)
</p></dd>
<dt> HMAC SHA-512</dt>
<dd><p>A known answer test using 28 bytes of data and a 4 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha512</code>)
</p></dd>
<dt> HMAC SHA3-224</dt>
<dt> HMAC SHA3-256</dt>
<dt> HMAC SHA3-384</dt>
<dt> HMAC SHA3-512</dt>
<dd><p>A known answer test using 9 bytes of data and a 20 byte key is run.
(<code>cipher/mac-hmac.c:selftests_sha3</code>)
</p></dd>
<dt> CMAC AES</dt>
<dd><p>A known answer test using 40 bytes of data and a 16 byte key is run.
(<code>cipher/mac-cmac.c:selftests_cmac_aes</code>)
</p></dd>
</dl>

<hr size="6">
<a name="Random-Number-Power_002dUp-Test"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#MAC-Algorithm-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Public-Key-Algorithm-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.4 Random Number Power-Up Test</h3>

<p>The DRNG is tested during power-up this way:
</p>
<ol>
<li>
Requesting one block of random using the public interface to check
general working and the duplicated block detection.
</li><li>
3 know answer tests using pre-defined keys, seed and initial DT
values.  For each test 3 blocks of 16 bytes are requested and compared
to the expected result.  The DT value is incremented for each block.
</li></ol>

<hr size="6">
<a name="Public-Key-Algorithm-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Random-Number-Power_002dUp-Test" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Key-derivation-function-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.5 Public Key Algorithm Power-Up Tests</h3>

<p>The public key algorithms are tested during power-up:
</p>
<dl compact="compact">
<dt> RSA</dt>
<dd><p>A pre-defined 2048 bit RSA key is used and these tests are run
in turn:
</p><ol>
<li>
Conversion of S-expression to internal format.
(<code>cipher/rsa.c:selftests_rsa</code>)
</li><li>
Private key consistency check.
(<code>cipher/rsa.c:selftests_rsa</code>)
</li><li>
A pre-defined 20 byte value is signed with PKCS#1 padding for SHA-256.
The result is verified using the public key against the original data
and against modified data.  (<code>cipher/rsa.c:selftest_sign_2048</code>)
</li><li>
A predefined 66 byte value is encrypted and checked that it matches
reference encyrpted message.  The encrypted result is then
decrypted and checked that it matches the original random value.
(<code>cipher/rsa.c:selftest_encr_2048</code>)
</li></ol>

</dd>
<dt> ECC</dt>
<dd><p>A pre-defined SEC P-256 ECDSA key is used and these tests are run
in turn:
</p><ol>
<li>
Conversion of S-expression to internal format.
(<code>cipher/ecc.c:selftests_ecdsa</code>)
</li><li>
Private key consistency check.
(<code>cipher/ecc.c:selftests_ecdsa</code>)
</li><li>
A pre-defined 32 byte value (SHA-256 digest) is signed.
The result is verified using the public key against the original data
and against modified data.  (<code>cipher/ecc.c:selftest_sign</code>)
</li></ol>
</dd>
</dl>

<hr size="6">
<a name="Key-derivation-function-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Public-Key-Algorithm-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Integrity-Power_002dUp-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.6 Key derivation function Power-Up Tests</h3>

<p>The key derivation functions are tested during power-up:
</p>
<dl compact="compact">
<dt> PBKDF2</dt>
<dd><p>A known answer tests with 8 byte password and 4 byte salt and SHA-1 is used.
(<code>cipher/kdf.c:selftest_pbkdf2</code>)
</p></dd>
</dl>

<hr size="6">
<a name="Integrity-Power_002dUp-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Key-derivation-function-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Conditional-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Power_002dUp-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.1.7 Integrity Power-Up Tests</h3>

<p>The integrity of the Libgcrypt is tested during power-up but only if
checking has been enabled at build time.  The check works by computing
a HMAC SHA-256 checksum over the file used to load Libgcrypt into
memory.  That checksum is compared against a checksum stored inside of
the same file as in the text in the .rodata1 section of the ELF file.
</p>

<hr size="6">
<a name="Conditional-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Integrity-Power_002dUp-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Key_002dPair-Generation-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">A.2 Conditional Tests</h2>

<p>The conditional tests are performed if a certain condition is met.
This may occur at any time; the library does not necessary enter the
&ldquo;Self-Test&rdquo; state to run these tests but will transit to the
&ldquo;Error&rdquo; state if a test failed.
</p>
<hr size="6">
<a name="Key_002dPair-Generation-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Conditional-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Software-Load-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Conditional-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.2.1 Key-Pair Generation Tests</h3>

<p>After an asymmetric key-pair has been generated, Libgcrypt runs a
pair-wise consistency tests on the generated key.  On failure the
generated key is not used, an error code is returned and, if in FIPS
mode, the library is put into the &ldquo;Error&rdquo; state.
</p>
<dl compact="compact">
<dt> RSA</dt>
<dd><p>The test uses a random number 64 bits less the size of the modulus as
plaintext and runs an encryption and decryption operation in turn.  The
encrypted value is checked to not match the plaintext, and the result
of the decryption is checked to match the plaintext.
</p>
<p>A new random number of the same size is generated, signed and verified
to test the correctness of the signing operation.  As a second signing
test, the signature is modified by incrementing its value and then
verified with the expected result that the verification fails.
(<code>cipher/rsa.c:test_keys</code>)
</p></dd>
</dl>


<hr size="6">
<a name="Software-Load-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Key_002dPair-Generation-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Manual-Key-Entry-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Conditional-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.2.2 Software Load Tests</h3>

<p>No code is loaded at runtime.
</p>
<hr size="6">
<a name="Manual-Key-Entry-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Software-Load-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Application-Requested-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Conditional-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.2.3 Manual Key Entry Tests</h3>

<p>A manual key entry feature is not implemented in Libgcrypt.
</p>


<hr size="6">
<a name="Application-Requested-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Manual-Key-Entry-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Symmetric-Cipher-Algorithm-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">A.3 Application Requested Tests</h2>

<p>The application may requests tests at any time by means of the
<code>GCRYCTL_SELFTEST</code> control command.  Note that using these tests
is not FIPS conformant: Although Libgcrypt rejects all application
requests for services while running self-tests, it does not ensure
that no other operations of Libgcrypt are still being executed.  Thus,
in FIPS mode an application requesting self-tests needs to power-cycle
Libgcrypt instead.
</p>
<p>When self-tests are requested, Libgcrypt runs all the tests it does
during power-up as well as a few extra checks as described below.
</p>
<hr size="6">
<a name="Symmetric-Cipher-Algorithm-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Application-Requested-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Hash-Algorithm-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Application-Requested-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.3.1 Symmetric Cipher Algorithm Tests</h3>

<p>The following symmetric encryption algorithm tests are run in addition
to the power-up tests:
</p>
<dl compact="compact">
<dt> AES-128</dt>
<dd><p>A known answer tests with test vectors taken from NIST SP800-38a and
using the high level functions is run for block modes CFB and OFB.
</p>
</dd>
</dl>

<hr size="6">
<a name="Hash-Algorithm-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Symmetric-Cipher-Algorithm-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#MAC-Algorithm-Tests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Application-Requested-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.3.2 Hash Algorithm Tests</h3>

<p>The following hash algorithm tests are run in addition to the
power-up tests:
</p>
<dl compact="compact">
<dt> SHA-1</dt>
<dt> SHA-224</dt>
<dt> SHA-256</dt>
<dd><ol>
<li>
A known answer test using a 56 byte string is run.
</li><li>
A known answer test using a string of one million letters &quot;a&quot; is run.
</li></ol>
<p>(<code>cipher/sha1.c:selftests_sha1</code>,
<code>cipher/sha256.c:selftests_sha224</code>,
<code>cipher/sha256.c:selftests_sha256</code>)
</p></dd>
<dt> SHA-384</dt>
<dt> SHA-512</dt>
<dd><ol>
<li>
A known answer test using a 112 byte string is run.
</li><li>
A known answer test using a string of one million letters &quot;a&quot; is run.
</li></ol>
<p>(<code>cipher/sha512.c:selftests_sha384</code>,
<code>cipher/sha512.c:selftests_sha512</code>)
</p></dd>
</dl>

<hr size="6">
<a name="MAC-Algorithm-Tests"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Hash-Algorithm-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Application-Requested-Tests" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">A.3.3 MAC Algorithm Tests</h3>

<p>The following MAC algorithm tests are run in addition to the power-up
tests:
</p>
<dl compact="compact">
<dt> HMAC SHA-1</dt>
<dd><ol>
<li>
A known answer test using 9 bytes of data and a 20 byte key is run.
</li><li>
A known answer test using 9 bytes of data and a 100 byte key is run.
</li><li>
A known answer test using 9 bytes of data and a 49 byte key is run.
</li></ol>
<p>(<code>cipher/mac-hmac.c:selftests_sha1</code>)
</p></dd>
<dt> HMAC SHA-224</dt>
<dt> HMAC SHA-256</dt>
<dt> HMAC SHA-384</dt>
<dt> HMAC SHA-512</dt>
<dd><ol>
<li>
A known answer test using 9 bytes of data and a 20 byte key is run.
</li><li>
A known answer test using 50 bytes of data and a 20 byte key is run.
</li><li>
A known answer test using 50 bytes of data and a 26 byte key is run.
</li><li>
A known answer test using 54 bytes of data and a 131 byte key is run.
</li><li>
A known answer test using 152 bytes of data and a 131 byte key is run.
</li></ol>
<p>(<code>cipher/mac-hmac.c:selftests_sha224</code>,
<code>cipher/mac-hmac.c:selftests_sha256</code>,
<code>cipher/mac-hmac.c:selftests_sha384</code>,
<code>cipher/mac-hmac.c:selftests_sha512</code>)
</p></dd>
</dl>

<dl compact="compact">
<dt> HMAC SHA3-224</dt>
<dt> HMAC SHA3-256</dt>
<dt> HMAC SHA3-384</dt>
<dt> HMAC SHA3-512</dt>
<dd><ol>
<li>
A known answer test using 28 byte of data and a 4 byte key is run.
</li><li>
A known answer test using 50 byte of data and a 20 byte key is run.
</li><li>
A known answer test using 50 byte of data and a 25 byte key is run.
</li><li>
A known answer test using 20 byte of data and a 20 byte key with truncation is run.
</li><li>
A known answer test using 54 byte of data and a 131 byte key is run.
</li><li>
A known answer test using 54 byte of data and a 147 byte key is run.
</li><li>
A known answer test using 152 byte of data and a 131 byte key is run.
</li><li>
A known answer test using 152 byte of data and a 147 byte key is run.
</li></ol>
<p>(<code>cipher/mac-hmac.c:selftests_sha3</code>,
</p></dd>
</dl>

<dl compact="compact">
<dt> CMAC AES</dt>
<dd><ol>
<li>
A known answer test using 0 byte of data and a 16 byte key is run.
</li><li>
A known answer test using 24 byte of data and a 16 byte key is run.
</li><li>
A known answer test using 64 byte of data and a 32 byte key is run.
</li><li>
A known answer test using 16 byte of data and a 16 byte key is run.
</li><li>
A known answer test using 64 byte of data and a 16 byte key is run.
</li><li>
A known answer test using 0 byte of data and a 24 byte key is run.
</li><li>
A known answer test using 64 byte of data and a 24 byte key is run.
</li><li>
A known answer test using 0 byte of data and a 32 byte key is run.
</li><li>
A known answer test using 16 byte of data and a 32 byte key is run.
</li></ol>
<p>(<code>cipher/mac-cmac.c:selftests_cmac_aes</code>,
</p></dd>
</dl>

<hr size="6">
<a name="FIPS-Mode"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#MAC-Algorithm-Tests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Restrictions-in-FIPS-Mode" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Self_002dTests" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Description-of-the-FIPS-Mode"></a>
<h1 class="appendix">B. Description of the FIPS Mode</h1>

<p>This appendix gives detailed information pertaining to the FIPS mode.
In particular, the changes to the standard mode and the finite state
machine are described.  The self-tests required in this mode are
described in the appendix on self-tests.
</p>
<hr size="6">
<a name="Restrictions-in-FIPS-Mode"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#FIPS-Mode" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Finite-State-Machine" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">B.1 Restrictions in FIPS Mode</h2>

<p>If Libgcrypt is used in FIPS mode, these restrictions are effective:
</p>
<ul>
<li>
The cryptographic algorithms are restricted to this list:

<dl compact="compact">
<dt> GCRY_CIPHER_AES128</dt>
<dd><p>AES 128 bit symmetric encryption.
</p></dd>
<dt> GCRY_CIPHER_AES192</dt>
<dd><p>AES 192 bit symmetric encryption.
</p></dd>
<dt> GCRY_CIPHER_AES256</dt>
<dd><p>AES 256 bit symmetric encryption.
</p></dd>
<dt> GCRY_MD_SHA1</dt>
<dd><p>SHA-1 message digest.
</p></dd>
<dt> GCRY_MD_SHA224</dt>
<dd><p>SHA-224 message digest.
</p></dd>
<dt> GCRY_MD_SHA256</dt>
<dd><p>SHA-256 message digest.
</p></dd>
<dt> GCRY_MD_SHA384</dt>
<dd><p>SHA-384 message digest.
</p></dd>
<dt> GCRY_MD_SHA512</dt>
<dd><p>SHA-512 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_224</dt>
<dd><p>SHA3-224 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_256</dt>
<dd><p>SHA3-256 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_384</dt>
<dd><p>SHA3-384 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_512</dt>
<dd><p>SHA3-512 message digest.
</p></dd>
<dt> GCRY_MD_SHA1,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA-1 message digest.
</p></dd>
<dt> GCRY_MD_SHA224,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA-224 message digest.
</p></dd>
<dt> GCRY_MD_SHA256,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA-256 message digest.
</p></dd>
<dt> GCRY_MD_SHA384,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA-384 message digest.
</p></dd>
<dt> GCRY_MD_SHA512,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA-512 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_224,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA3-224 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_256,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA3-256 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_384,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA3-384 message digest.
</p></dd>
<dt> GCRY_MD_SHA3_512,GCRY_MD_FLAG_HMAC</dt>
<dd><p>HMAC using a SHA3-512 message digest.
</p></dd>
<dt> GCRY_MAC_CMAC_AES</dt>
<dd><p>CMAC using a AES key.
</p></dd>
<dt> GCRY_PK_RSA</dt>
<dd><p>RSA encryption and signing.
</p></dd>
<dt> GCRY_PK_ECC</dt>
<dd><p>ECC encryption and signing.
</p></dd>
</dl>

<p>Note that the CRC algorithms are not considered cryptographic algorithms
and thus are in addition available.
</p>
</li><li>
RSA key generation refuses to create and use a key with a keysize of
less than 2048 bits.

</li><li>
The <code>transient-key</code> flag for RSA key generation is ignored.

</li><li>
Support for the VIA Padlock engine is disabled.

</li><li>
FIPS mode may only be used on systems with a /dev/random device or
with a getentropy syscall. Switching into FIPS mode on other systems
will fail at runtime.

</li><li>
Saving and loading a random seed file is ignored.

</li><li>
The DRBG style random number generator is used in place of the
large-pool-CSPRNG generator.

</li><li>
The command <code>GCRYCTL_ENABLE_QUICK_RANDOM</code> is ignored.

</li><li>
Message digest debugging is disabled.

</li><li>
All debug output related to cryptographic data is suppressed.

</li><li>
On-the-fly self-tests are not performed, instead self-tests are run
before entering operational state.

</li><li>
The function <code>gcry_set_allocation_handler</code> may not be used. In FIPS mode
this function does not have any effect, because FIPS has requirements for
memory zeroization.

</li><li>
The digest algorithm MD5 may not be used.

</li><li>
The signatures using SHA-1 digest algorithm may not be used.

</li><li>
In FIPS mode the command <code>GCRYCTL_DISABLE_SECMEM</code> is ignored.

</li><li>
A handler set by <code>gcry_set_outofcore_handler</code> is ignored.

</li><li>
A handler set by <code>gcry_set_fatalerror_handler</code> is ignored.

</li></ul>

<p>Note that when we speak about disabling FIPS mode, it merely means
that the function <code>gcry_fips_mode_active</code> returns false; it does
not mean that any non FIPS algorithms are allowed.
</p>
<hr size="6">
<a name="FIPS-Finite-State-Machine"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Restrictions-in-FIPS-Mode" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Miscellaneous-Information" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">B.2 FIPS Finite State Machine</h2>

<p>The FIPS mode of Libgcrypt implements a finite state machine (FSM) using
8 states (see <a href="#tbl_003afips_002dstates">tbl:fips-states</a>) and checks at runtime that only valid
transitions (see <a href="#tbl_003afips_002dstate_002dtransitions">tbl:fips-state-transitions</a>) may happen.
</p>
<div class="float"><a name="fig_003afips_002dfsm"></a>

 <img src="fips-fsm.jpg" alt="FIPS FSM Diagram">
</div><p><strong>Figure B.1: FIPS mode state diagram
</strong>
</p>
<div class="float"><a name="tbl_003afips_002dstates"></a>

<p>States used by the FIPS FSM:
</p><dl compact="compact">
<dt> Power-Off</dt>
<dd><p>Libgcrypt is not runtime linked to another application.  This usually
means that the library is not loaded into main memory.  This state is
documentation only.
</p>
</dd>
<dt> Power-On</dt>
<dd><p>Libgcrypt is loaded into memory and API calls may be made.  Compiler
introduced constructor functions may be run.  Note that Libgcrypt does
not implement any arbitrary constructor functions to be called by the
operating system
</p>
</dd>
<dt> Init</dt>
<dd><p>The Libgcrypt initialization functions are performed and the library has
not yet run any self-test.
</p>
</dd>
<dt> Self-Test</dt>
<dd><p>Libgcrypt is performing self-tests.
</p>
</dd>
<dt> Operational</dt>
<dd><p>Libgcrypt is in the operational state and all interfaces may be used.
</p>
</dd>
<dt> Error</dt>
<dd><p>Libgrypt is in the error state.  When calling any FIPS relevant
interfaces they either return an error (<code>GPG_ERR_NOT_OPERATIONAL</code>)
or put Libgcrypt into the Fatal-Error state and won&rsquo;t return.
</p>
</dd>
<dt> Fatal-Error</dt>
<dd><p>Libgcrypt is in a non-recoverable error state and
will automatically transit into the  Shutdown state.
</p>
</dd>
<dt> Shutdown</dt>
<dd><p>Libgcrypt is about to be terminated and removed from the memory. The
application may at this point still run cleanup handlers.
</p>
</dd>
</dl>
</div><p><strong>Table B.1: FIPS mode states
</strong>
</p>

<div class="float"><a name="tbl_003afips_002dstate_002dtransitions"></a>

<p>The valid state transitions (see <a href="#fig_003afips_002dfsm">fig:fips-fsm</a>) are:
</p><dl compact="compact">
<dt> <code>1</code></dt>
<dd><p>Power-Off to Power-On is implicitly done by the OS loading Libgcrypt as
a shared library and having it linked to an application.
</p>
</dd>
<dt> <code>2</code></dt>
<dd><p>Power-On to Init is triggered by the application calling the
Libgcrypt initialization function <code>gcry_check_version</code>.
</p>
</dd>
<dt> <code>3</code></dt>
<dd><p>Init to Self-Test is either triggered by a dedicated API call or implicit
by invoking a Libgrypt service controlled by the FSM.
</p>
</dd>
<dt> <code>4</code></dt>
<dd><p>Self-Test to Operational is triggered after all self-tests passed
successfully.
</p>
</dd>
<dt> <code>5</code></dt>
<dd><p>Operational to Shutdown is an artificial state without any direct action
in Libgcrypt.  When reaching the Shutdown state the library is
deinitialized and can&rsquo;t return to any other state again.
</p>
</dd>
<dt> <code>6</code></dt>
<dd><p>Shutdown to Power-Off is the process of removing Libgcrypt from the
computer&rsquo;s memory.  For obvious reasons the Power-Off state can&rsquo;t be
represented within Libgcrypt and thus this transition is for
documentation only.
</p>
</dd>
<dt> <code>7</code></dt>
<dd><p>Operational to Error is triggered if Libgcrypt detected an application
error which can&rsquo;t be returned to the caller but still allows Libgcrypt
to properly run.  In the Error state all FIPS relevant interfaces return
an error code.
</p>
</dd>
<dt> <code>8</code></dt>
<dd><p>Error to Shutdown is similar to the Operational to Shutdown transition
(5).
</p>
</dd>
<dt> <code>9</code></dt>
<dd><p>Error to Fatal-Error is triggered if Libgrypt detects an fatal error
while already being in Error state.
</p>
</dd>
<dt> <code>10</code></dt>
<dd><p>Fatal-Error to Shutdown is automatically entered by Libgcrypt
after having reported the error.
</p>
</dd>
<dt> <code>11</code></dt>
<dd><p>Power-On to Shutdown is an artificial state to document that Libgcrypt
has not yet been initialized but the process is about to terminate.
</p>
</dd>
<dt> <code>12</code></dt>
<dd><p>Power-On to Fatal-Error will be triggered if certain Libgcrypt functions
are used without having reached the Init state.
</p>
</dd>
<dt> <code>13</code></dt>
<dd><p>Self-Test to Fatal-Error is triggered by severe errors in Libgcrypt while
running self-tests.
</p>
</dd>
<dt> <code>14</code></dt>
<dd><p>Self-Test to Error is triggered by a failed self-test.
</p>
</dd>
<dt> <code>15</code></dt>
<dd><p>Operational to Fatal-Error is triggered if Libcrypt encountered a
non-recoverable error.
</p>
</dd>
<dt> <code>16</code></dt>
<dd><p>Operational to Self-Test is triggered if the application requested to run
the self-tests again.
</p>
</dd>
<dt> <code>17</code></dt>
<dd><p>Error to Self-Test is triggered if the application has requested to run
self-tests to get back into operational state after an error.
</p>
</dd>
<dt> <code>18</code></dt>
<dd><p>Init to Error is triggered by errors in the initialization code.
</p>
</dd>
<dt> <code>19</code></dt>
<dd><p>Init to Fatal-Error is triggered by non-recoverable errors in the
initialization code.
</p>
</dd>
<dt> <code>20</code></dt>
<dd><p>Error to Error is triggered by errors while already in the Error
state.
</p>

</dd>
</dl>
</div><p><strong>Table B.2: FIPS mode state transitions
</strong>
</p>
<hr size="6">
<a name="FIPS-Miscellaneous-Information"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#FIPS-Finite-State-Machine" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">B.3 FIPS Miscellaneous Information</h2>

<p>Libgcrypt does not do any key management on itself; the application
needs to care about it.  Keys which are passed to Libgcrypt should be
allocated in secure memory as available with the functions
<code>gcry_malloc_secure</code> and <code>gcry_calloc_secure</code>.  By calling
<code>gcry_free</code> on this memory, the memory and thus the keys are
overwritten with zero bytes before releasing the memory.
</p>
<p>For use with the random number generator, Libgcrypt generates 3
internal keys which are stored in the encryption contexts used by the
RNG.  These keys are stored in secure memory for the lifetime of the
process.  Application are required to use <code>GCRYCTL_TERM_SECMEM</code>
before process termination.  This will zero out the entire secure
memory and thus also the encryption contexts with these keys.
</p>


<hr size="6">
<a name="Library-Copying"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#FIPS-Miscellaneous-Information" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Copying" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#FIPS-Mode" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Copying" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="GNU-Lesser-General-Public-License"></a>
<h1 class="unnumbered">GNU Lesser General Public License</h1>

<a name="index-LGPL_002c-GNU-Lesser-General-Public-License"></a>
<p align="center"> Version 2.1, February 1999
</p>
<table><tr><td>&nbsp;</td><td><pre class="display">Copyright &copy; 1991, 1999 Free Software Foundation, Inc.
59 Temple Place &ndash; Suite 330, Boston, MA 02111-1307, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

[This is the first released version of the Lesser GPL.  It also counts
as the successor of the GNU Library Public License, version 2, hence the
version number 2.1.]
</pre></td></tr></table>

<a name="Preamble"></a>
<h2 class="heading">Preamble</h2>

<p>  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
Licenses are intended to guarantee your freedom to share and change
free software&mdash;to make sure the software is free for all its users.
</p>
<p>  This license, the Lesser General Public License, applies to some
specially designated software&mdash;typically libraries&mdash;of the Free
Software Foundation and other authors who decide to use it.  You can use
it too, but we suggest you first think carefully about whether this
license or the ordinary General Public License is the better strategy to
use in any particular case, based on the explanations below.
</p>
<p>  When we speak of free software, we are referring to freedom of use,
not price.  Our General Public Licenses are designed to make sure that
you have the freedom to distribute copies of free software (and charge
for this service if you wish); that you receive source code or can get
it if you want it; that you can change the software and use pieces of it
in new free programs; and that you are informed that you can do these
things.
</p>
<p>  To protect your rights, we need to make restrictions that forbid
distributors to deny you these rights or to ask you to surrender these
rights.  These restrictions translate to certain responsibilities for
you if you distribute copies of the library or if you modify it.
</p>
<p>  For example, if you distribute copies of the library, whether gratis
or for a fee, you must give the recipients all the rights that we gave
you.  You must make sure that they, too, receive or can get the source
code.  If you link other code with the library, you must provide
complete object files to the recipients, so that they can relink them
with the library after making changes to the library and recompiling
it.  And you must show them these terms so they know their rights.
</p>
<p>  We protect your rights with a two-step method: (1) we copyright the
library, and (2) we offer you this license, which gives you legal
permission to copy, distribute and/or modify the library.
</p>
<p>  To protect each distributor, we want to make it very clear that
there is no warranty for the free library.  Also, if the library is
modified by someone else and passed on, the recipients should know
that what they have is not the original version, so that the original
author&rsquo;s reputation will not be affected by problems that might be
introduced by others.
</p>
<p>  Finally, software patents pose a constant threat to the existence of
any free program.  We wish to make sure that a company cannot
effectively restrict the users of a free program by obtaining a
restrictive license from a patent holder.  Therefore, we insist that
any patent license obtained for a version of the library must be
consistent with the full freedom of use specified in this license.
</p>
<p>  Most GNU software, including some libraries, is covered by the
ordinary GNU General Public License.  This license, the GNU Lesser
General Public License, applies to certain designated libraries, and
is quite different from the ordinary General Public License.  We use
this license for certain libraries in order to permit linking those
libraries into non-free programs.
</p>
<p>  When a program is linked with a library, whether statically or using
a shared library, the combination of the two is legally speaking a
combined work, a derivative of the original library.  The ordinary
General Public License therefore permits such linking only if the
entire combination fits its criteria of freedom.  The Lesser General
Public License permits more lax criteria for linking other code with
the library.
</p>
<p>  We call this license the <em>Lesser</em> General Public License because it
does <em>Less</em> to protect the user&rsquo;s freedom than the ordinary General
Public License.  It also provides other free software developers Less
of an advantage over competing non-free programs.  These disadvantages
are the reason we use the ordinary General Public License for many
libraries.  However, the Lesser license provides advantages in certain
special circumstances.
</p>
<p>  For example, on rare occasions, there may be a special need to
encourage the widest possible use of a certain library, so that it becomes
a de-facto standard.  To achieve this, non-free programs must be
allowed to use the library.  A more frequent case is that a free
library does the same job as widely used non-free libraries.  In this
case, there is little to gain by limiting the free library to free
software only, so we use the Lesser General Public License.
</p>
<p>  In other cases, permission to use a particular library in non-free
programs enables a greater number of people to use a large body of
free software.  For example, permission to use the GNU C Library in
non-free programs enables many more people to use the whole GNU
operating system, as well as its variant, the GNU/Linux operating
system.
</p>
<p>  Although the Lesser General Public License is Less protective of the
users&rsquo; freedom, it does ensure that the user of a program that is
linked with the Library has the freedom and the wherewithal to run
that program using a modified version of the Library.
</p>
<p>  The precise terms and conditions for copying, distribution and
modification follow.  Pay close attention to the difference between a
&ldquo;work based on the library&rdquo; and a &ldquo;work that uses the library&rdquo;.  The
former contains code derived from the library, whereas the latter must
be combined with the library in order to run.
</p>

<ol>
<li>
This License Agreement applies to any software library or other program
which contains a notice placed by the copyright holder or other
authorized party saying it may be distributed under the terms of this
Lesser General Public License (also called &ldquo;this License&rdquo;).  Each
licensee is addressed as &ldquo;you&rdquo;.

<p>  A &ldquo;library&rdquo; means a collection of software functions and/or data
prepared so as to be conveniently linked with application programs
(which use some of those functions and data) to form executables.
</p>
<p>  The &ldquo;Library&rdquo;, below, refers to any such software library or work
which has been distributed under these terms.  A &ldquo;work based on the
Library&rdquo; means either the Library or any derivative work under
copyright law: that is to say, a work containing the Library or a
portion of it, either verbatim or with modifications and/or translated
straightforwardly into another language.  (Hereinafter, translation is
included without limitation in the term &ldquo;modification&rdquo;.)
</p>
<p>  &ldquo;Source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  For a library, complete source code means
all the source code for all modules it contains, plus any associated
interface definition files, plus the scripts used to control compilation
and installation of the library.
</p>
<p>  Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running a program using the Library is not restricted, and output from
such a program is covered only if its contents constitute a work based
on the Library (independent of the use of the Library in a tool for
writing it).  Whether that is true depends on what the Library does
and what the program that uses the Library does.
</p>
</li><li>
You may copy and distribute verbatim copies of the Library&rsquo;s
complete source code as you receive it, in any medium, provided that
you conspicuously and appropriately publish on each copy an
appropriate copyright notice and disclaimer of warranty; keep intact
all the notices that refer to this License and to the absence of any
warranty; and distribute a copy of this License along with the
Library.

<p>  You may charge a fee for the physical act of transferring a copy,
and you may at your option offer warranty protection in exchange for a
fee.
</p>
</li><li>
You may modify your copy or copies of the Library or any portion
of it, thus forming a work based on the Library, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

<ol>
<li>
The modified work must itself be a software library.

</li><li>
You must cause the files modified to carry prominent notices
stating that you changed the files and the date of any change.

</li><li>
You must cause the whole of the work to be licensed at no
charge to all third parties under the terms of this License.

</li><li>
If a facility in the modified Library refers to a function or a
table of data to be supplied by an application program that uses
the facility, other than as an argument passed when the facility
is invoked, then you must make a good faith effort to ensure that,
in the event an application does not supply such function or
table, the facility still operates, and performs whatever part of
its purpose remains meaningful.

<p>(For example, a function in a library to compute square roots has
a purpose that is entirely well-defined independent of the
application.  Therefore, Subsection 2d requires that any
application-supplied function or table used by this function must
be optional: if the application does not supply it, the square
root function must still compute square roots.)
</p></li></ol>

<p>These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Library,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Library, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote
it.
</p>
<p>Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Library.
</p>
<p>In addition, mere aggregation of another work not based on the Library
with the Library (or with a work based on the Library) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.
</p>
</li><li>
You may opt to apply the terms of the ordinary GNU General Public
License instead of this License to a given copy of the Library.  To do
this, you must alter all the notices that refer to this License, so
that they refer to the ordinary GNU General Public License, version 2,
instead of to this License.  (If a newer version than version 2 of the
ordinary GNU General Public License has appeared, then you can specify
that version instead if you wish.)  Do not make any other change in
these notices.

<p>  Once this change is made in a given copy, it is irreversible for
that copy, so the ordinary GNU General Public License applies to all
subsequent copies and derivative works made from that copy.
</p>
<p>  This option is useful when you wish to copy part of the code of
the Library into a program that is not a library.
</p>
</li><li>
You may copy and distribute the Library (or a portion or
derivative of it, under Section 2) in object code or executable form
under the terms of Sections 1 and 2 above provided that you accompany
it with the complete corresponding machine-readable source code, which
must be distributed under the terms of Sections 1 and 2 above on a
medium customarily used for software interchange.

<p>  If distribution of object code is made by offering access to copy
from a designated place, then offering equivalent access to copy the
source code from the same place satisfies the requirement to
distribute the source code, even though third parties are not
compelled to copy the source along with the object code.
</p>
</li><li>
A program that contains no derivative of any portion of the
Library, but is designed to work with the Library by being compiled or
linked with it, is called a &ldquo;work that uses the Library&rdquo;.  Such a
work, in isolation, is not a derivative work of the Library, and
therefore falls outside the scope of this License.

<p>  However, linking a &ldquo;work that uses the Library&rdquo; with the Library
creates an executable that is a derivative of the Library (because it
contains portions of the Library), rather than a &ldquo;work that uses the
library&rdquo;.  The executable is therefore covered by this License.
Section 6 states terms for distribution of such executables.
</p>
<p>  When a &ldquo;work that uses the Library&rdquo; uses material from a header file
that is part of the Library, the object code for the work may be a
derivative work of the Library even though the source code is not.
Whether this is true is especially significant if the work can be
linked without the Library, or if the work is itself a library.  The
threshold for this to be true is not precisely defined by law.
</p>
<p>  If such an object file uses only numerical parameters, data
structure layouts and accessors, and small macros and small inline
functions (ten lines or less in length), then the use of the object
file is unrestricted, regardless of whether it is legally a derivative
work.  (Executables containing this object code plus portions of the
Library will still fall under Section 6.)
</p>
<p>  Otherwise, if the work is a derivative of the Library, you may
distribute the object code for the work under the terms of Section 6.
Any executables containing that work also fall under Section 6,
whether or not they are linked directly with the Library itself.
</p>
</li><li>
As an exception to the Sections above, you may also combine or
link a &ldquo;work that uses the Library&rdquo; with the Library to produce a
work containing portions of the Library, and distribute that work
under terms of your choice, provided that the terms permit
modification of the work for the customer&rsquo;s own use and reverse
engineering for debugging such modifications.

<p>  You must give prominent notice with each copy of the work that the
Library is used in it and that the Library and its use are covered by
this License.  You must supply a copy of this License.  If the work
during execution displays copyright notices, you must include the
copyright notice for the Library among them, as well as a reference
directing the user to the copy of this License.  Also, you must do one
of these things:
</p>
<ol>
<li>
Accompany the work with the complete corresponding
machine-readable source code for the Library including whatever
changes were used in the work (which must be distributed under
Sections 1 and 2 above); and, if the work is an executable linked
with the Library, with the complete machine-readable &ldquo;work that
uses the Library&rdquo;, as object code and/or source code, so that the
user can modify the Library and then relink to produce a modified
executable containing the modified Library.  (It is understood
that the user who changes the contents of definitions files in the
Library will not necessarily be able to recompile the application
to use the modified definitions.)

</li><li>
Use a suitable shared library mechanism for linking with the Library.  A
suitable mechanism is one that (1) uses at run time a copy of the
library already present on the user&rsquo;s computer system, rather than
copying library functions into the executable, and (2) will operate
properly with a modified version of the library, if the user installs
one, as long as the modified version is interface-compatible with the
version that the work was made with.

</li><li>
Accompany the work with a written offer, valid for at
least three years, to give the same user the materials
specified in Subsection 6a, above, for a charge no more
than the cost of performing this distribution.

</li><li>
If distribution of the work is made by offering access to copy
from a designated place, offer equivalent access to copy the above
specified materials from the same place.

</li><li>
Verify that the user has already received a copy of these
materials or that you have already sent this user a copy.
</li></ol>

<p>  For an executable, the required form of the &ldquo;work that uses the
Library&rdquo; must include any data and utility programs needed for
reproducing the executable from it.  However, as a special exception,
the materials to be distributed need not include anything that is
normally distributed (in either source or binary form) with the major
components (compiler, kernel, and so on) of the operating system on
which the executable runs, unless that component itself accompanies the
executable.
</p>
<p>  It may happen that this requirement contradicts the license
restrictions of other proprietary libraries that do not normally
accompany the operating system.  Such a contradiction means you cannot
use both them and the Library together in an executable that you
distribute.
</p>
</li><li>
You may place library facilities that are a work based on the
Library side-by-side in a single library together with other library
facilities not covered by this License, and distribute such a combined
library, provided that the separate distribution of the work based on
the Library and of the other library facilities is otherwise
permitted, and provided that you do these two things:

<ol>
<li>
Accompany the combined library with a copy of the same work
based on the Library, uncombined with any other library
facilities.  This must be distributed under the terms of the
Sections above.

</li><li>
Give prominent notice with the combined library of the fact
that part of it is a work based on the Library, and explaining
where to find the accompanying uncombined form of the same work.
</li></ol>

</li><li>
You may not copy, modify, sublicense, link with, or distribute
the Library except as expressly provided under this License.  Any
attempt otherwise to copy, modify, sublicense, link with, or
distribute the Library is void, and will automatically terminate your
rights under this License.  However, parties who have received copies,
or rights, from you under this License will not have their licenses
terminated so long as such parties remain in full compliance.

</li><li>
You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Library or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Library (or any work based on the
Library), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Library or works based on it.

</li><li>
Each time you redistribute the Library (or any work based on the
Library), the recipient automatically receives a license from the
original licensor to copy, distribute, link with or modify the Library
subject to these terms and conditions.  You may not impose any further
restrictions on the recipients&rsquo; exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties with
this License.

</li><li>
If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Library at all.  For example, if a patent
license would not permit royalty-free redistribution of the Library by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Library.

<p>If any portion of this section is held invalid or unenforceable under any
particular circumstance, the balance of the section is intended to apply,
and the section as a whole is intended to apply in other circumstances.
</p>
<p>It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.
</p>
<p>This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.
</p>
</li><li>
If the distribution and/or use of the Library is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Library under this License may add
an explicit geographical distribution limitation excluding those countries,
so that distribution is permitted only in or among countries not thus
excluded.  In such case, this License incorporates the limitation as if
written in the body of this License.

</li><li>
The Free Software Foundation may publish revised and/or new
versions of the Lesser General Public License from time to time.
Such new versions will be similar in spirit to the present version,
but may differ in detail to address new problems or concerns.

<p>Each version is given a distinguishing version number.  If the Library
specifies a version number of this License which applies to it and
&ldquo;any later version&rdquo;, you have the option of following the terms and
conditions either of that version or of any later version published by
the Free Software Foundation.  If the Library does not specify a
license version number, you may choose any version ever published by
the Free Software Foundation.
</p>
</li><li>
If you wish to incorporate parts of the Library into other free
programs whose distribution conditions are incompatible with these,
write to the author to ask for permission.  For software which is
copyrighted by the Free Software Foundation, write to the Free
Software Foundation; we sometimes make exceptions for this.  Our
decision will be guided by the two goals of preserving the free status
of all derivatives of our free software and of promoting the sharing
and reuse of software generally.

<p align="center"> NO WARRANTY
</p>
</li><li>
BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO
WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW.
EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR
OTHER PARTIES PROVIDE THE LIBRARY &ldquo;AS IS&rdquo; WITHOUT WARRANTY OF ANY
KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE
LIBRARY IS WITH YOU.  SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME
THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

</li><li>
IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN
WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY
AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU
FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR
CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE
LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES.
</li></ol>



<a name="How-to-Apply-These-Terms-to-Your-New-Libraries"></a>
<h2 class="heading">How to Apply These Terms to Your New Libraries</h2>

<p>  If you develop a new library, and you want it to be of the greatest
possible use to the public, we recommend making it free software that
everyone can redistribute and change.  You can do so by permitting
redistribution under these terms (or, alternatively, under the terms of the
ordinary General Public License).
</p>
<p>  To apply these terms, attach the following notices to the library.  It is
safest to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least the
&ldquo;copyright&rdquo; line and a pointer to where the full notice is found.
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample"><var>one line to give the library's name and an idea of what it does.</var>
Copyright (C) <var>year</var>  <var>name of author</var>

This library is free software; you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation; either version 2.1 of the License, or (at
your option) any later version.

This library is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307,
USA.
</pre></td></tr></table>

<p>Also add information on how to contact you by electronic and paper mail.
</p>
<p>You should also get your employer (if you work as a programmer) or your
school, if any, to sign a &ldquo;copyright disclaimer&rdquo; for the library, if
necessary.  Here is a sample; alter the names:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">Yoyodyne, Inc., hereby disclaims all copyright interest in the library
`Frob' (a library for tweaking knobs) written by James Random Hacker.

<var>signature of Ty Coon</var>, 1 April 1990
Ty Coon, President of Vice
</pre></td></tr></table>

<p>That&rsquo;s all there is to it!
</p>
<hr size="6">
<a name="Copying"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Library-Copying" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Figures-and-Tables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Library-Copying" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Figures-and-Tables" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="GNU-General-Public-License"></a>
<h1 class="unnumbered">GNU General Public License</h1>

<a name="index-GPL_002c-GNU-General-Public-License"></a>
<p align="center"> Version 2, June 1991
</p>
<table><tr><td>&nbsp;</td><td><pre class="display">Copyright &copy; 1989, 1991 Free Software Foundation, Inc.
59 Temple Place &ndash; Suite 330, Boston, MA 02111-1307, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></td></tr></table>

<a name="Preamble-1"></a>
<h2 class="heading">Preamble</h2>

<p>  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software&mdash;to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation&rsquo;s software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.
</p>
<p>  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.
</p>
<p>  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.
</p>
<p>  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.
</p>
<p>  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.
</p>
<p>  Also, for each author&rsquo;s protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors&rsquo; reputations.
</p>
<p>  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone&rsquo;s free use or not licensed at all.
</p>
<p>  The precise terms and conditions for copying, distribution and
modification follow.
</p>

<ol>
<li>
This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The &ldquo;Program&rdquo;, below,
refers to any such program or work, and a &ldquo;work based on the Program&rdquo;
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term &ldquo;modification&rdquo;.)  Each licensee is addressed as &ldquo;you&rdquo;.

<p>Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.
</p>
</li><li>
You may copy and distribute verbatim copies of the Program&rsquo;s
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

<p>You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.
</p>
</li><li>
You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

<ol>
<li>
You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

</li><li>
You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

</li><li>
If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)
</li></ol>

<p>These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.
</p>
<p>Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.
</p>
<p>In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.
</p>
</li><li>
You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

<ol>
<li>
Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

</li><li>
Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

</li><li>
Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)
</li></ol>

<p>The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.
</p>
<p>If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.
</p>
</li><li>
You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

</li><li>
You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

</li><li>
Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients&rsquo; exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

</li><li>
If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

<p>If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.
</p>
<p>It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.
</p>
<p>This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.
</p>
</li><li>
If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

</li><li>
The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

<p>Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and &ldquo;any
later version&rdquo;, you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.
</p>
</li><li>
If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

<p align="center"> NO WARRANTY
</p>
</li><li>
BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

</li><li>
IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.
</li></ol>



<a name="How-to-Apply-These-Terms-to-Your-New-Programs"></a>
<h2 class="heading">How to Apply These Terms to Your New Programs</h2>

<p>  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.
</p>
<p>  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample"><var>one line to give the program's name and an idea of what it does.</var>
Copyright (C) 19<var>yy</var>  <var>name of author</var>

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
</pre></td></tr></table>

<p>Also add information on how to contact you by electronic and paper mail.
</p>
<p>If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">Gnomovision version 69, Copyright (C) 19<var>yy</var> <var>name of author</var>
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details
type `show w'.  This is free software, and you are welcome
to redistribute it under certain conditions; type `show c'
for details.
</pre></td></tr></table>

<p>The hypothetical commands &lsquo;<samp>show w</samp>&rsquo; and &lsquo;<samp>show c</samp>&rsquo; should show
the appropriate parts of the General Public License.  Of course, the
commands you use may be called something other than &lsquo;<samp>show w</samp>&rsquo; and
&lsquo;<samp>show c</samp>&rsquo;; they could even be mouse-clicks or menu items&mdash;whatever
suits your program.
</p>
<p>You should also get your employer (if you work as a programmer) or your
school, if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if
necessary.  Here is a sample; alter the names:
</p>
<table><tr><td>&nbsp;</td><td><pre class="smallexample">Yoyodyne, Inc., hereby disclaims all copyright
interest in the program `Gnomovision'
(which makes passes at compilers) written
by James Hacker.

<var>signature of Ty Coon</var>, 1 April 1989
Ty Coon, President of Vice
</pre></td></tr></table>

<p>This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.
</p>
<hr size="6">
<a name="Figures-and-Tables"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Copying" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Copying" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="List-of-Figures-and-Tables"></a>
<h1 class="unnumbered">List of Figures and Tables</h1>

<dl class="listoffloats">
<dt><a href="#fig_003asubsystems">Figure 17.1</a></dt><dd><p>Libgcrypt subsystems
</p></dd>
<dt><a href="#fig_003afips_002dfsm">Figure B.1</a></dt><dd><p>FIPS mode state diagram
</p></dd>
</dl>

<dl class="listoffloats">
<dt><a href="#tbl_003afips_002dstates">Table B.1</a></dt><dd><p>FIPS mode states
</p></dd>
<dt><a href="#tbl_003afips_002dstate_002dtransitions">Table B.2</a></dt><dd><p>FIPS mode state transitions
</p></dd>
</dl>

<hr size="6">
<a name="Concept-Index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Figures-and-Tables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-Data-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Figures-and-Tables" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Function-and-Data-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Concept-Index-1"></a>
<h1 class="unnumbered">Concept Index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-Index-1_cp_symbol-1" class="summary-letter"><b>/</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_symbol-2" class="summary-letter"><b>3</b></a>
 &nbsp; 
<br>
<a href="#Concept-Index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-X" class="summary-letter"><b>X</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-cp">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_symbol-1">/</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002fetc_002fgcrypt_002ffips_005fenabled">/etc/gcrypt/fips_enabled</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002fetc_002fgcrypt_002fhwf_002edeny">/etc/gcrypt/hwf.deny</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002fetc_002fgcrypt_002frandom_002econf">/etc/gcrypt/random.conf</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002fproc_002fcpuinfo">/proc/cpuinfo</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_002fproc_002fself_002fauxv">/proc/self/auxv</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_symbol-2">3</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-3DES">3DES</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Advanced-Encryption-Standard">Advanced Encryption Standard</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AES">AES</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AES_002dWrap-mode">AES-Wrap mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Arcfour">Arcfour</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-BLAKE2b_002d512_002c-BLAKE2b_002d384_002c-BLAKE2b_002d256_002c-BLAKE2b_002d160">BLAKE2b-512, BLAKE2b-384, BLAKE2b-256, BLAKE2b-160</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-BLAKE2s_002d256_002c-BLAKE2s_002d224_002c-BLAKE2s_002d160_002c-BLAKE2s_002d128">BLAKE2s-256, BLAKE2s-224, BLAKE2s-160, BLAKE2s-128</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Blowfish">Blowfish</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bug-emulation">bug emulation</a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Camellia">Camellia</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CAST5">CAST5</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CBC_002c-Cipher-Block-Chaining-mode">CBC, Cipher Block Chaining mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CBC_002dMAC">CBC-MAC</a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CCM_002c-Counter-with-CBC_002dMAC-mode">CCM, Counter with CBC-MAC mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CFB_002c-Cipher-Feedback-mode">CFB, Cipher Feedback mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ChaCha20">ChaCha20</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cipher-text-stealing">cipher text stealing</a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comp">comp</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CRC32">CRC32</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CTR_002c-Counter-mode">CTR, Counter mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-DES">DES</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-DES_002dEDE">DES-EDE</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Digital-Encryption-Standard">Digital Encryption Standard</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-disable_002djent">disable-jent</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-EAX_002c-EAX-mode">EAX, EAX mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ECB_002c-Electronic-Codebook-mode">ECB, Electronic Codebook mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-EdDSA">EdDSA</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-codes">error codes</a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-codes_002c-list-of">error codes, list of</a></td><td valign="top"><a href="#Error-Sources">3.2.2 Error Sources</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-codes_002c-list-of-1">error codes, list of</a></td><td valign="top"><a href="#Error-Codes">3.2.3 Error Codes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-codes_002c-printing-of">error codes, printing of</a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-sources">error sources</a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-sources_002c-printing-of">error sources, printing of</a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-strings">error strings</a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-values">error values</a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-values_002c-printing-of">error values, printing of</a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-140">FIPS 140</a></td><td valign="top"><a href="#Enabling-FIPS-mode">2.6 How to enable the FIPS mode</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-140-1">FIPS 140</a></td><td valign="top"><a href="#Disabling-FIPS-mode">2.7 How to disable the FIPS mode</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-186">FIPS 186</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-186-1">FIPS 186</a></td><td valign="top"><a href="#Public_002dKey-Subsystem-Architecture">17.1 Public-Key Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-186_002d2">FIPS 186-2</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-mode">FIPS mode</a></td><td valign="top"><a href="#Enabling-FIPS-mode">2.6 How to enable the FIPS mode</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FIPS-mode-1">FIPS mode</a></td><td valign="top"><a href="#Disabling-FIPS-mode">2.7 How to disable the FIPS mode</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fips_005fenabled">fips_enabled</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCM_002c-Galois_002fCounter-Mode">GCM, Galois/Counter Mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCM_002dSIV_002c-GCM_002dSIV-mode_002c-AES_002dGCM_002dSIV">GCM-SIV, GCM-SIV mode, AES-GCM-SIV</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCRYPT_005fBARRETT">GCRYPT_BARRETT</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCRYPT_005fRNDUNIX_005fDBG">GCRYPT_RNDUNIX_DBG</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCRYPT_005fRNDUNIX_005fDBGALL">GCRYPT_RNDUNIX_DBGALL</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCRYPT_005fRNDW32_005fDBG">GCRYPT_RNDW32_DBG</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GCRYPT_005fRNDW32_005fNOPERF">GCRYPT_RNDW32_NOPERF</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GOST-28147_002d89">GOST 28147-89</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GOST-28147_002d89-CryptoPro-keymeshing">GOST 28147-89 CryptoPro keymeshing</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GPL_002c-GNU-General-Public-License">GPL, GNU General Public License</a></td><td valign="top"><a href="#Copying">GNU General Public License</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-hardware-features">hardware features</a></td><td valign="top"><a href="#Hardware-features">2.8 How to disable hardware features</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HAVAL">HAVAL</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC">HMAC</a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dBLAKE2s_002c-HMAC_002dBLAKE2b">HMAC-BLAKE2s, HMAC-BLAKE2b</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dGOSTR_002d3411_002d94">HMAC-GOSTR-3411-94</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dMD2_002c-HMAC_002dMD4_002c-HMAC_002dMD5">HMAC-MD2, HMAC-MD4, HMAC-MD5</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dRIPE_002dMD_002d160">HMAC-RIPE-MD-160</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dSHA_002d1">HMAC-SHA-1</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dSHA_002d224_002c-HMAC_002dSHA_002d256_002c-HMAC_002dSHA_002d384_002c-HMAC_002dSHA_002d512">HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, HMAC-SHA-512</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dSHA_002d512_002f224_002c-HMAC_002dSHA_002d512_002f256">HMAC-SHA-512/224, HMAC-SHA-512/256</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dSHA3_002d224_002c-HMAC_002dSHA3_002d256_002c-HMAC_002dSHA3_002d384_002c-HMAC_002dSHA3_002d512">HMAC-SHA3-224, HMAC-SHA3-256, HMAC-SHA3-384, HMAC-SHA3-512</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dSM3">HMAC-SM3</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dStribog_002d256_002c-HMAC_002dStribog_002d512">HMAC-Stribog-256, HMAC-Stribog-512</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dTIGER1">HMAC-TIGER1</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HMAC_002dWhirlpool">HMAC-Whirlpool</a></td><td valign="top"><a href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HOME">HOME</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-IDEA">IDEA</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-LGPL_002c-GNU-Lesser-General-Public-License">LGPL, GNU Lesser General Public License</a></td><td valign="top"><a href="#Library-Copying">GNU Lesser General Public License</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIBGCRYPT_005fFORCE_005fFIPS_005fMODE">LIBGCRYPT_FORCE_FIPS_MODE</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-MD2_002c-MD4_002c-MD5">MD2, MD4, MD5</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-no_002dblinding">no-blinding</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-no_002dkeytest">no-keytest</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nocomp">nocomp</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-OAEP">OAEP</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-OCB_002c-OCB3">OCB, OCB3</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-OFB_002c-Output-Feedback-mode">OFB, Output Feedback mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-only_002durandom">only-urandom</a></td><td valign="top"><a href="#Configuration">16. Configuration files and environment variables</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-param">param</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PKCS1">PKCS1</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Poly1305-based-AEAD-mode-with-ChaCha20">Poly1305 based AEAD mode with ChaCha20</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PSS">PSS</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-RC2">RC2</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RC4">RC4</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rfc_002d2268">rfc-2268</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RFC6979">RFC6979</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Rijndael">Rijndael</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RIPE_002dMD_002d160">RIPE-MD-160</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Salsa20">Salsa20</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Salsa20_002f12">Salsa20/12</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Seed-_0028cipher_0029">Seed (cipher)</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Serpent">Serpent</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SHA_002d1">SHA-1</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SHA_002d224_002c-SHA_002d256_002c-SHA_002d384_002c-SHA_002d512_002c-SHA_002d512_002f224_002c-SHA_002d512_002f256">SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SHA3_002d224_002c-SHA3_002d256_002c-SHA3_002d384_002c-SHA3_002d512_002c-SHAKE128_002c-SHAKE256">SHA3-224, SHA3-256, SHA3-384, SHA3-512, SHAKE128, SHAKE256</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SIV_002c-SIV-mode">SIV, SIV mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SM3">SM3</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SM4-_0028cipher_0029">SM4 (cipher)</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sync-mode-_0028OpenPGP_0029">sync mode (OpenPGP)</a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-TIGER_002c-TIGER1_002c-TIGER2">TIGER, TIGER1, TIGER2</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-transient_002dkey">transient-key</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Triple_002dDES">Triple-DES</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Twofish">Twofish</a></td><td valign="top"><a href="#Available-ciphers">5.1 Available ciphers</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Whirlpool">Whirlpool</a></td><td valign="top"><a href="#Available-hash-algorithms">7.1 Available hash algorithms</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-X">X</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-X9_002e31">X9.31</a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-X9_002e31-1">X9.31</a></td><td valign="top"><a href="#Public_002dKey-Subsystem-Architecture">17.1 Public-Key Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-XTS_002c-XTS-mode">XTS, XTS mode</a></td><td valign="top"><a href="#Available-cipher-modes">5.2 Available cipher modes</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Concept-Index-1_cp_symbol-1" class="summary-letter"><b>/</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_symbol-2" class="summary-letter"><b>3</b></a>
 &nbsp; 
<br>
<a href="#Concept-Index-1_cp_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-B" class="summary-letter"><b>B</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-C" class="summary-letter"><b>C</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-D" class="summary-letter"><b>D</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-E" class="summary-letter"><b>E</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-F" class="summary-letter"><b>F</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-H" class="summary-letter"><b>H</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-I" class="summary-letter"><b>I</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-L" class="summary-letter"><b>L</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-M" class="summary-letter"><b>M</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-N" class="summary-letter"><b>N</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-O" class="summary-letter"><b>O</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-P" class="summary-letter"><b>P</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-R" class="summary-letter"><b>R</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-S" class="summary-letter"><b>S</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-T" class="summary-letter"><b>T</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-W" class="summary-letter"><b>W</b></a>
 &nbsp; 
<a href="#Concept-Index-1_cp_letter-X" class="summary-letter"><b>X</b></a>
 &nbsp; 
</td></tr></table>

<hr size="6">
<a name="Function-and-Data-Index"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Concept-Index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Function-and-Data-Index-1"></a>
<h1 class="unnumbered">Function and Data Index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Function-and-Data-Index-1_fn_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Function-and-Data-Index-1_fn_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
</td></tr></table>
<table border="0" class="index-fn">
<tr><td></td><th align="left">Index Entry</th><th align="left"> Section</th></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-Data-Index-1_fn_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-AM_005fPATH_005fLIBGCRYPT"><code>AM_PATH_LIBGCRYPT</code></a></td><td valign="top"><a href="#Building-sources-using-Automake">2.3 Building sources using Automake</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
<tr><th><a name="Function-and-Data-Index-1_fn_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fbuffer_005ft"><code>gcry_buffer_t</code></a></td><td valign="top"><a href="#Buffer-description">14.3 Buffer description</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcalloc"><code>gcry_calloc</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcalloc_005fsecure"><code>gcry_calloc_secure</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcheck_005fversion"><code>gcry_check_version</code></a></td><td valign="top"><a href="#Initializing-the-library">2.4 Initializing the library</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005falgo_005finfo"><code>gcry_cipher_algo_info</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005falgo_005fname"><code>gcry_cipher_algo_name</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fauthenticate"><code>gcry_cipher_authenticate</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fchecktag"><code>gcry_cipher_checktag</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fclose"><code>gcry_cipher_close</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fctl"><code>gcry_cipher_ctl</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fdecrypt"><code>gcry_cipher_decrypt</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fencrypt"><code>gcry_cipher_encrypt</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005ffinal"><code>gcry_cipher_final</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fgettag"><code>gcry_cipher_gettag</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fget_005falgo_005fblklen"><code>gcry_cipher_get_algo_blklen</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fget_005falgo_005fkeylen"><code>gcry_cipher_get_algo_keylen</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005finfo"><code>gcry_cipher_info</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fmap_005fname"><code>gcry_cipher_map_name</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fmode_005ffrom_005foid"><code>gcry_cipher_mode_from_oid</code></a></td><td valign="top"><a href="#General-cipher-functions">5.4 General cipher functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fopen"><code>gcry_cipher_open</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005freset"><code>gcry_cipher_reset</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fsetctr"><code>gcry_cipher_setctr</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fsetiv"><code>gcry_cipher_setiv</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fsetkey"><code>gcry_cipher_setkey</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fset_005fdecryption_005ftag"><code>gcry_cipher_set_decryption_tag</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcipher_005fsync"><code>gcry_cipher_sync</code></a></td><td valign="top"><a href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcontrol"><code>gcry_control</code></a></td><td valign="top"><a href="#Controlling-the-library">3.1 Controlling the library</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fcreate_005fnonce"><code>gcry_create_nonce</code></a></td><td valign="top"><a href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fctx_005frelease"><code>gcry_ctx_release</code></a></td><td valign="top"><a href="#Context-management">14.2 Context management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fctx_005ft"><code>gcry_ctx_t</code></a></td><td valign="top"><a href="#Context-management">14.2 Context management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fecc_005fget_005falgo_005fkeylen"><code>gcry_ecc_get_algo_keylen</code></a></td><td valign="top"><a href="#Dedicated-ECC-Functions">6.4 Dedicated functions for elliptic curves.</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fecc_005fmul_005fpoint"><code>gcry_ecc_mul_point</code></a></td><td valign="top"><a href="#Dedicated-ECC-Functions">6.4 Dedicated functions for elliptic curves.</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferror"><code>gcry_error</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferror_005ffrom_005ferrno"><code>gcry_error_from_errno</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferror_005ft"><code>gcry_error_t</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fcode"><code>gcry_err_code</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fcode_005ffrom_005ferrno"><code>gcry_err_code_from_errno</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fcode_005ft"><code>gcry_err_code_t</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fcode_005fto_005ferrno"><code>gcry_err_code_to_errno</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fmake"><code>gcry_err_make</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fmake_005ffrom_005ferrno"><code>gcry_err_make_from_errno</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fsource"><code>gcry_err_source</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ferr_005fsource_005ft"><code>gcry_err_source_t</code></a></td><td valign="top"><a href="#Error-Values">3.2.1 Error Values</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ffips_005fmode_005factive"><code>gcry_fips_mode_active</code></a></td><td valign="top"><a href="#Controlling-the-library">3.1 Controlling the library</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005ffree"><code>gcry_free</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fget_005fconfig"><code>gcry_get_config</code></a></td><td valign="top"><a href="#Config-reporting">14.4 How to check Libgcrypt&rsquo;s configuration.</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005falloc_005ft"><code>gcry_handler_alloc_t</code></a></td><td valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005ferror_005ft"><code>gcry_handler_error_t</code></a></td><td valign="top"><a href="#Error-handler">4.3 Error handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005ffree_005ft"><code>gcry_handler_free_t</code></a></td><td valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005flog_005ft"><code>gcry_handler_log_t</code></a></td><td valign="top"><a href="#Logging-handler">4.4 Logging handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005fno_005fmem_005ft"><code>gcry_handler_no_mem_t</code></a></td><td valign="top"><a href="#Error-handler">4.3 Error handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005fprogress_005ft"><code>gcry_handler_progress_t</code></a></td><td valign="top"><a href="#Progress-handler">4.1 Progress handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005frealloc_005ft"><code>gcry_handler_realloc_t</code></a></td><td valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fhandler_005fsecure_005fcheck_005ft"><code>gcry_handler_secure_check_t</code></a></td><td valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fkdf_005fderive"><code>gcry_kdf_derive</code></a></td><td valign="top"><a href="#Key-Derivation">9. Key Derivation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005falgo_005fname"><code>gcry_mac_algo_name</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fclose"><code>gcry_mac_close</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fget_005falgo"><code>gcry_mac_get_algo</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fget_005falgo_005fkeylen"><code>gcry_mac_get_algo_keylen</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fget_005falgo_005fmaclen"><code>gcry_mac_get_algo_maclen</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fmap_005fname"><code>gcry_mac_map_name</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fopen"><code>gcry_mac_open</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fread"><code>gcry_mac_read</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005freset"><code>gcry_mac_reset</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fsetiv"><code>gcry_mac_setiv</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fsetkey"><code>gcry_mac_setkey</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005ftest_005falgo"><code>gcry_mac_test_algo</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fverify"><code>gcry_mac_verify</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmac_005fwrite"><code>gcry_mac_write</code></a></td><td valign="top"><a href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmalloc"><code>gcry_malloc</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmalloc_005fsecure"><code>gcry_malloc_secure</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005falgo_005fname"><code>gcry_md_algo_name</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fclose"><code>gcry_md_close</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fcopy"><code>gcry_md_copy</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fdebug"><code>gcry_md_debug</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fenable"><code>gcry_md_enable</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fextract"><code>gcry_md_extract</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005ffinal"><code>gcry_md_final</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fget_005falgo"><code>gcry_md_get_algo</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fget_005falgo_005fdlen"><code>gcry_md_get_algo_dlen</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fget_005fasnoid"><code>gcry_md_get_asnoid</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fhash_005fbuffer"><code>gcry_md_hash_buffer</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fhash_005fbuffers"><code>gcry_md_hash_buffers</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fis_005fenabled"><code>gcry_md_is_enabled</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fis_005fsecure"><code>gcry_md_is_secure</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fmap_005fname"><code>gcry_md_map_name</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fopen"><code>gcry_md_open</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fputc"><code>gcry_md_putc</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fread"><code>gcry_md_read</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005freset"><code>gcry_md_reset</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fsetkey"><code>gcry_md_setkey</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005ftest_005falgo"><code>gcry_md_test_algo</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmd_005fwrite"><code>gcry_md_write</code></a></td><td valign="top"><a href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fabs"><code>gcry_mpi_abs</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fadd"><code>gcry_mpi_add</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005faddm"><code>gcry_mpi_addm</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fadd_005fui"><code>gcry_mpi_add_ui</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005faprint"><code>gcry_mpi_aprint</code></a></td><td valign="top"><a href="#MPI-formats">12.3 MPI formats</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fclear_005fbit"><code>gcry_mpi_clear_bit</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fclear_005fflag"><code>gcry_mpi_clear_flag</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fclear_005fhighbit"><code>gcry_mpi_clear_highbit</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fcmp"><code>gcry_mpi_cmp</code></a></td><td valign="top"><a href="#Comparisons">12.5 Comparisons</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fcmp_005fui"><code>gcry_mpi_cmp_ui</code></a></td><td valign="top"><a href="#Comparisons">12.5 Comparisons</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fcopy"><code>gcry_mpi_copy</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fdiv"><code>gcry_mpi_div</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fdump"><code>gcry_mpi_dump</code></a></td><td valign="top"><a href="#MPI-formats">12.3 MPI formats</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fadd"><code>gcry_mpi_ec_add</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fcurve_005fpoint"><code>gcry_mpi_ec_curve_point</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fdecode_005fpoint"><code>gcry_mpi_ec_decode_point</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fdup"><code>gcry_mpi_ec_dup</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fget_005faffine"><code>gcry_mpi_ec_get_affine</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fget_005fmpi"><code>gcry_mpi_ec_get_mpi</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fget_005fpoint"><code>gcry_mpi_ec_get_point</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fmul"><code>gcry_mpi_ec_mul</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fnew"><code>gcry_mpi_ec_new</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fset_005fmpi"><code>gcry_mpi_ec_set_mpi</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fset_005fpoint"><code>gcry_mpi_ec_set_point</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fec_005fsub"><code>gcry_mpi_ec_sub</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fgcd"><code>gcry_mpi_gcd</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fget_005fflag"><code>gcry_mpi_get_flag</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fget_005fnbits"><code>gcry_mpi_get_nbits</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fget_005fopaque"><code>gcry_mpi_get_opaque</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fget_005fui"><code>gcry_mpi_get_ui</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005finvm"><code>gcry_mpi_invm</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fis_005fneg"><code>gcry_mpi_is_neg</code></a></td><td valign="top"><a href="#Comparisons">12.5 Comparisons</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005flshift"><code>gcry_mpi_lshift</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fmod"><code>gcry_mpi_mod</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fmul"><code>gcry_mpi_mul</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fmulm"><code>gcry_mpi_mulm</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fmul_005f2exp"><code>gcry_mpi_mul_2exp</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fmul_005fui"><code>gcry_mpi_mul_ui</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fneg"><code>gcry_mpi_neg</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fnew"><code>gcry_mpi_new</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fcopy"><code>gcry_mpi_point_copy</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fget"><code>gcry_mpi_point_get</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fnew"><code>gcry_mpi_point_new</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005frelease"><code>gcry_mpi_point_release</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fset"><code>gcry_mpi_point_set</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fsnatch_005fget"><code>gcry_mpi_point_snatch_get</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005fsnatch_005fset"><code>gcry_mpi_point_snatch_set</code></a></td><td valign="top"><a href="#EC-functions">12.7 EC functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpoint_005ft"><code>gcry_mpi_point_t</code></a></td><td valign="top"><a href="#Data-types">12.1 Data types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fpowm"><code>gcry_mpi_powm</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fprint"><code>gcry_mpi_print</code></a></td><td valign="top"><a href="#MPI-formats">12.3 MPI formats</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005frandomize"><code>gcry_mpi_randomize</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005frelease"><code>gcry_mpi_release</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005frshift"><code>gcry_mpi_rshift</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fscan"><code>gcry_mpi_scan</code></a></td><td valign="top"><a href="#MPI-formats">12.3 MPI formats</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset"><code>gcry_mpi_set</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fbit"><code>gcry_mpi_set_bit</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fflag"><code>gcry_mpi_set_flag</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fhighbit"><code>gcry_mpi_set_highbit</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fopaque"><code>gcry_mpi_set_opaque</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fopaque_005fcopy"><code>gcry_mpi_set_opaque_copy</code></a></td><td valign="top"><a href="#Miscellaneous">12.8 Miscellaneous</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fset_005fui"><code>gcry_mpi_set_ui</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fsnatch"><code>gcry_mpi_snatch</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fsnew"><code>gcry_mpi_snew</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fsub"><code>gcry_mpi_sub</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fsubm"><code>gcry_mpi_subm</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fsub_005fui"><code>gcry_mpi_sub_ui</code></a></td><td valign="top"><a href="#Calculations">12.4 Calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005fswap"><code>gcry_mpi_swap</code></a></td><td valign="top"><a href="#Basic-functions">12.2 Basic functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005ft"><code>gcry_mpi_t</code></a></td><td valign="top"><a href="#Data-types">12.1 Data types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fmpi_005ftest_005fbit"><code>gcry_mpi_test_bit</code></a></td><td valign="top"><a href="#Bit-manipulations">12.6 Bit manipulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005falgo_005finfo"><code>gcry_pk_algo_info</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005falgo_005fname"><code>gcry_pk_algo_name</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fctl"><code>gcry_pk_ctl</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fdecrypt"><code>gcry_pk_decrypt</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fencrypt"><code>gcry_pk_encrypt</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fgenkey"><code>gcry_pk_genkey</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fget_005fkeygrip"><code>gcry_pk_get_keygrip</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fget_005fnbits"><code>gcry_pk_get_nbits</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fhash_005fsign"><code>gcry_pk_hash_sign</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fhash_005fverify"><code>gcry_pk_hash_verify</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fmap_005fname"><code>gcry_pk_map_name</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005frandom_005foverride_005fnew"><code>gcry_pk_random_override_new</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fsign"><code>gcry_pk_sign</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005ftestkey"><code>gcry_pk_testkey</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005ftest_005falgo"><code>gcry_pk_test_algo</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpk_005fverify"><code>gcry_pk_verify</code></a></td><td valign="top"><a href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fprime_005fcheck"><code>gcry_prime_check</code></a></td><td valign="top"><a href="#Checking">13.2 Checking</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fprime_005fgenerate"><code>gcry_prime_generate</code></a></td><td valign="top"><a href="#Generation">13.1 Generation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fprime_005fgroup_005fgenerator"><code>gcry_prime_group_generator</code></a></td><td valign="top"><a href="#Generation">13.1 Generation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fprime_005frelease_005ffactors"><code>gcry_prime_release_factors</code></a></td><td valign="top"><a href="#Generation">13.1 Generation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fpubkey_005fget_005fsexp"><code>gcry_pubkey_get_sexp</code></a></td><td valign="top"><a href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005frandomize"><code>gcry_randomize</code></a></td><td valign="top"><a href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005frandom_005fbytes"><code>gcry_random_bytes</code></a></td><td valign="top"><a href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005frandom_005fbytes_005fsecure"><code>gcry_random_bytes_secure</code></a></td><td valign="top"><a href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005frandom_005flevel_005ft"><code>gcry_random_level_t</code></a></td><td valign="top"><a href="#Quality-of-random-numbers">10.1 Quality of random numbers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005frealloc"><code>gcry_realloc</code></a></td><td valign="top"><a href="#Memory-allocation">14.1 Memory allocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fset_005fallocation_005fhandler"><code>gcry_set_allocation_handler</code></a></td><td valign="top"><a href="#Allocation-handler">4.2 Allocation handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fset_005ffatalerror_005fhandler"><code>gcry_set_fatalerror_handler</code></a></td><td valign="top"><a href="#Error-handler">4.3 Error handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fset_005flog_005fhandler"><code>gcry_set_log_handler</code></a></td><td valign="top"><a href="#Logging-handler">4.4 Logging handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fset_005foutofcore_005fhandler"><code>gcry_set_outofcore_handler</code></a></td><td valign="top"><a href="#Error-handler">4.3 Error handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fset_005fprogress_005fhandler"><code>gcry_set_progress_handler</code></a></td><td valign="top"><a href="#Progress-handler">4.1 Progress handler</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fbuild"><code>gcry_sexp_build</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fcanon_005flen"><code>gcry_sexp_canon_len</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fcar"><code>gcry_sexp_car</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fcdr"><code>gcry_sexp_cdr</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fcreate"><code>gcry_sexp_create</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fdump"><code>gcry_sexp_dump</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fextract_005fparam"><code>gcry_sexp_extract_param</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005ffind_005ftoken"><code>gcry_sexp_find_token</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005flength"><code>gcry_sexp_length</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnew"><code>gcry_sexp_new</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnth"><code>gcry_sexp_nth</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnth_005fbuffer"><code>gcry_sexp_nth_buffer</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnth_005fdata"><code>gcry_sexp_nth_data</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnth_005fmpi"><code>gcry_sexp_nth_mpi</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fnth_005fstring"><code>gcry_sexp_nth_string</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005frelease"><code>gcry_sexp_release</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fsprint"><code>gcry_sexp_sprint</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005fsscan"><code>gcry_sexp_sscan</code></a></td><td valign="top"><a href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fsexp_005ft"><code>gcry_sexp_t</code></a></td><td valign="top"><a href="#Data-types-for-S_002dexpressions">11.1 Data types for S-expressions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fstrerror"><code>gcry_strerror</code></a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gcry_005fstrsource"><code>gcry_strsource</code></a></td><td valign="top"><a href="#Error-Strings">3.2.4 Error Strings</a></td></tr>
<tr><td colspan="3"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a href="#Function-and-Data-Index-1_fn_letter-A" class="summary-letter"><b>A</b></a>
 &nbsp; 
<a href="#Function-and-Data-Index-1_fn_letter-G" class="summary-letter"><b>G</b></a>
 &nbsp; 
</td></tr></table>



<hr size="6">
<a name="SEC_Foot"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Footnotes</h1>
<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>At least this is true for POSIX threads,
as <code>pthread_create</code> is a function that synchronizes memory with
respects to other threads.  There are many functions which have this
property, a complete list can be found in POSIX, IEEE Std 1003.1-2003,
Base Definitions, Issue 6, in the definition of the term &ldquo;Memory
Synchronization&rdquo;.  For other thread packages, more relaxed or more
strict rules may apply.
</p><h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p>NB. Libgcrypt uses the RDRAND feature only as one
source of entropy.  A CPU with a broken RDRAND will thus not
compromise the random number generator
</p><h3><a name="FOOT3" href="#DOCF3">(3)</a></h3>
<p>A version control
system available for many platforms
</p><h3><a name="FOOT4" href="#DOCF4">(4)</a></h3>
<p>See
<a href="http://www.gnupg.org/documentation/mailing-lists.en.html">http://www.gnupg.org/documentation/mailing-lists.en.html</a> for
details.
</p><h3><a name="FOOT5" href="#DOCF5">(5)</a></h3>
<p>Chae Hoon Lim
and Pil Joong Lee. A key recovery attack on discrete log-based schemes
using a prime order subgroup. In Burton S. Kaliski Jr., editor,
Advances in Cryptology: Crypto &rsquo;97, pages 249&ndash;263, Berlin /
Heidelberg / New York, 1997. Springer-Verlag.  Described on page 260.
</p><h3><a name="FOOT6" href="#DOCF6">(6)</a></h3>
<p>Also described in chapter
6 of his book &quot;Cryptographic Security Architecture&quot;, New York, 2004,
ISBN 0-387-95387-6.
</p><hr size="1">
<a name="SEC_Contents"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>
<div class="contents">

<ul class="toc">
  <li><a name="toc-Introduction-1" href="#Introduction">1. Introduction</a>
  <ul class="toc">
    <li><a name="toc-Getting-Started-1" href="#Getting-Started">1.1 Getting Started</a></li>
    <li><a name="toc-Features-1" href="#Features">1.2 Features</a></li>
    <li><a name="toc-Overview-1" href="#Overview">1.3 Overview</a></li>
  </ul></li>
  <li><a name="toc-Preparation-1" href="#Preparation">2. Preparation</a>
  <ul class="toc">
    <li><a name="toc-Header-1" href="#Header">2.1 Header</a></li>
    <li><a name="toc-Building-sources-1" href="#Building-sources">2.2 Building sources</a></li>
    <li><a name="toc-Building-sources-using-Automake-1" href="#Building-sources-using-Automake">2.3 Building sources using Automake</a></li>
    <li><a name="toc-Initializing-the-library-1" href="#Initializing-the-library">2.4 Initializing the library</a></li>
    <li><a name="toc-Multi_002dThreading-1" href="#Multi_002dThreading">2.5 Multi-Threading</a></li>
    <li><a name="toc-How-to-enable-the-FIPS-mode" href="#Enabling-FIPS-mode">2.6 How to enable the FIPS mode</a></li>
    <li><a name="toc-How-to-disable-the-FIPS-mode" href="#Disabling-FIPS-mode">2.7 How to disable the FIPS mode</a></li>
    <li><a name="toc-How-to-disable-hardware-features" href="#Hardware-features">2.8 How to disable hardware features</a></li>
  </ul></li>
  <li><a name="toc-Generalities-1" href="#Generalities">3. Generalities</a>
  <ul class="toc">
    <li><a name="toc-Controlling-the-library-1" href="#Controlling-the-library">3.1 Controlling the library</a></li>
    <li><a name="toc-Error-Handling-1" href="#Error-Handling">3.2 Error Handling</a>
    <ul class="toc">
      <li><a name="toc-Error-Values-1" href="#Error-Values">3.2.1 Error Values</a></li>
      <li><a name="toc-Error-Sources-1" href="#Error-Sources">3.2.2 Error Sources</a></li>
      <li><a name="toc-Error-Codes-1" href="#Error-Codes">3.2.3 Error Codes</a></li>
      <li><a name="toc-Error-Strings-1" href="#Error-Strings">3.2.4 Error Strings</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Handler-Functions-1" href="#Handler-Functions">4. Handler Functions</a>
  <ul class="toc">
    <li><a name="toc-Progress-handler-1" href="#Progress-handler">4.1 Progress handler</a></li>
    <li><a name="toc-Allocation-handler-1" href="#Allocation-handler">4.2 Allocation handler</a></li>
    <li><a name="toc-Error-handler-1" href="#Error-handler">4.3 Error handler</a></li>
    <li><a name="toc-Logging-handler-1" href="#Logging-handler">4.4 Logging handler</a></li>
  </ul></li>
  <li><a name="toc-Symmetric-cryptography-1" href="#Symmetric-cryptography">5. Symmetric cryptography</a>
  <ul class="toc">
    <li><a name="toc-Available-ciphers-1" href="#Available-ciphers">5.1 Available ciphers</a></li>
    <li><a name="toc-Available-cipher-modes-1" href="#Available-cipher-modes">5.2 Available cipher modes</a></li>
    <li><a name="toc-Working-with-cipher-handles-1" href="#Working-with-cipher-handles">5.3 Working with cipher handles</a></li>
    <li><a name="toc-General-cipher-functions-1" href="#General-cipher-functions">5.4 General cipher functions</a></li>
  </ul></li>
  <li><a name="toc-Public-Key-cryptography-1" href="#Public-Key-cryptography">6. Public Key cryptography</a>
  <ul class="toc">
    <li><a name="toc-Available-algorithms-1" href="#Available-algorithms">6.1 Available algorithms</a></li>
    <li><a name="toc-Used-S_002dexpressions-1" href="#Used-S_002dexpressions">6.2 Used S-expressions</a>
    <ul class="toc">
      <li><a name="toc-RSA-key-parameters-1" href="#RSA-key-parameters">6.2.1 RSA key parameters</a></li>
      <li><a name="toc-DSA-key-parameters-1" href="#DSA-key-parameters">6.2.2 DSA key parameters</a></li>
      <li><a name="toc-ECC-key-parameters-1" href="#ECC-key-parameters">6.2.3 ECC key parameters</a></li>
    </ul></li>
    <li><a name="toc-Cryptographic-Functions-1" href="#Cryptographic-Functions">6.3 Cryptographic Functions</a></li>
    <li><a name="toc-Dedicated-functions-for-elliptic-curves_002e" href="#Dedicated-ECC-Functions">6.4 Dedicated functions for elliptic curves.</a></li>
    <li><a name="toc-General-public_002dkey-related-Functions-1" href="#General-public_002dkey-related-Functions">6.5 General public-key related Functions</a></li>
  </ul></li>
  <li><a name="toc-Hashing-1" href="#Hashing">7. Hashing</a>
  <ul class="toc">
    <li><a name="toc-Available-hash-algorithms-1" href="#Available-hash-algorithms">7.1 Available hash algorithms</a></li>
    <li><a name="toc-Working-with-hash-algorithms-1" href="#Working-with-hash-algorithms">7.2 Working with hash algorithms</a></li>
  </ul></li>
  <li><a name="toc-Message-Authentication-Codes-1" href="#Message-Authentication-Codes">8. Message Authentication Codes</a>
  <ul class="toc">
    <li><a name="toc-Available-MAC-algorithms-1" href="#Available-MAC-algorithms">8.1 Available MAC algorithms</a></li>
    <li><a name="toc-Working-with-MAC-algorithms-1" href="#Working-with-MAC-algorithms">8.2 Working with MAC algorithms</a></li>
  </ul></li>
  <li><a name="toc-Key-Derivation-1" href="#Key-Derivation">9. Key Derivation</a></li>
  <li><a name="toc-Random-Numbers-1" href="#Random-Numbers">10. Random Numbers</a>
  <ul class="toc">
    <li><a name="toc-Quality-of-random-numbers-1" href="#Quality-of-random-numbers">10.1 Quality of random numbers</a></li>
    <li><a name="toc-Retrieving-random-numbers-1" href="#Retrieving-random-numbers">10.2 Retrieving random numbers</a></li>
  </ul></li>
  <li><a name="toc-S_002dexpressions-1" href="#S_002dexpressions">11. S-expressions</a>
  <ul class="toc">
    <li><a name="toc-Data-types-for-S_002dexpressions-1" href="#Data-types-for-S_002dexpressions">11.1 Data types for S-expressions</a></li>
    <li><a name="toc-Working-with-S_002dexpressions-1" href="#Working-with-S_002dexpressions">11.2 Working with S-expressions</a></li>
  </ul></li>
  <li><a name="toc-MPI-library-1" href="#MPI-library">12. MPI library</a>
  <ul class="toc">
    <li><a name="toc-Data-types-1" href="#Data-types">12.1 Data types</a></li>
    <li><a name="toc-Basic-functions-1" href="#Basic-functions">12.2 Basic functions</a></li>
    <li><a name="toc-MPI-formats-1" href="#MPI-formats">12.3 MPI formats</a></li>
    <li><a name="toc-Calculations-1" href="#Calculations">12.4 Calculations</a></li>
    <li><a name="toc-Comparisons-1" href="#Comparisons">12.5 Comparisons</a></li>
    <li><a name="toc-Bit-manipulations-1" href="#Bit-manipulations">12.6 Bit manipulations</a></li>
    <li><a name="toc-EC-functions-1" href="#EC-functions">12.7 EC functions</a></li>
    <li><a name="toc-Miscellaneous-1" href="#Miscellaneous">12.8 Miscellaneous</a></li>
  </ul></li>
  <li><a name="toc-Prime-numbers-1" href="#Prime-numbers">13. Prime numbers</a>
  <ul class="toc">
    <li><a name="toc-Generation-1" href="#Generation">13.1 Generation</a></li>
    <li><a name="toc-Checking-1" href="#Checking">13.2 Checking</a></li>
  </ul></li>
  <li><a name="toc-Utilities-1" href="#Utilities">14. Utilities</a>
  <ul class="toc">
    <li><a name="toc-Memory-allocation-1" href="#Memory-allocation">14.1 Memory allocation</a></li>
    <li><a name="toc-Context-management-1" href="#Context-management">14.2 Context management</a></li>
    <li><a name="toc-Buffer-description-1" href="#Buffer-description">14.3 Buffer description</a></li>
    <li><a name="toc-How-to-check-Libgcrypt_0027s-configuration_002e" href="#Config-reporting">14.4 How to check Libgcrypt&rsquo;s configuration.</a></li>
  </ul></li>
  <li><a name="toc-Tools-1" href="#Tools">15. Tools</a>
  <ul class="toc">
    <li><a name="toc-A-HMAC_002dSHA_002d256-tool" href="#hmac256">15.1 A HMAC-SHA-256 tool</a></li>
  </ul></li>
  <li><a name="toc-Configuration-files-and-environment-variables" href="#Configuration">16. Configuration files and environment variables</a></li>
  <li><a name="toc-Architecture-1" href="#Architecture">17. Architecture</a>
  <ul class="toc">
    <li><a name="toc-Public_002dKey-Architecture" href="#Public_002dKey-Subsystem-Architecture">17.1 Public-Key Architecture</a></li>
    <li><a name="toc-Symmetric-Encryption-Subsystem-Architecture-1" href="#Symmetric-Encryption-Subsystem-Architecture">17.2 Symmetric Encryption Subsystem Architecture</a></li>
    <li><a name="toc-Hashing-and-MACing-Subsystem-Architecture-1" href="#Hashing-and-MACing-Subsystem-Architecture">17.3 Hashing and MACing Subsystem Architecture</a></li>
    <li><a name="toc-Multi_002dPrecision_002dInteger-Subsystem-Architecture-1" href="#Multi_002dPrecision_002dInteger-Subsystem-Architecture">17.4 Multi-Precision-Integer Subsystem Architecture</a></li>
    <li><a name="toc-Prime_002dNumber_002dGenerator-Subsystem-Architecture-1" href="#Prime_002dNumber_002dGenerator-Subsystem-Architecture">17.5 Prime-Number-Generator Subsystem Architecture</a></li>
    <li><a name="toc-Random_002dNumber-Subsystem-Architecture-1" href="#Random_002dNumber-Subsystem-Architecture">17.6 Random-Number Subsystem Architecture</a>
    <ul class="toc">
      <li><a name="toc-Description-of-the-CSPRNG" href="#CSPRNG-Description">17.6.1 Description of the CSPRNG</a></li>
      <li><a name="toc-Description-of-the-DRBG" href="#DRBG-Description">17.6.2 Description of the DRBG</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Description-of-the-Self_002dTests" href="#Self_002dTests">A. Description of the Self-Tests</a>
  <ul class="toc">
    <li><a name="toc-Power_002dUp-Tests" href="#Power_002dUp-Tests">A.1 Power-Up Tests</a>
    <ul class="toc">
      <li><a name="toc-Symmetric-Cipher-Algorithm-Power_002dUp-Tests" href="#Symmetric-Cipher-Algorithm-Power_002dUp-Tests">A.1.1 Symmetric Cipher Algorithm Power-Up Tests</a></li>
      <li><a name="toc-Hash-Algorithm-Power_002dUp-Tests" href="#Hash-Algorithm-Power_002dUp-Tests">A.1.2 Hash Algorithm Power-Up Tests</a></li>
      <li><a name="toc-MAC-Algorithm-Power_002dUp-Tests" href="#MAC-Algorithm-Power_002dUp-Tests">A.1.3 MAC Algorithm Power-Up Tests</a></li>
      <li><a name="toc-Random-Number-Power_002dUp-Test" href="#Random-Number-Power_002dUp-Test">A.1.4 Random Number Power-Up Test</a></li>
      <li><a name="toc-Public-Key-Algorithm-Power_002dUp-Tests" href="#Public-Key-Algorithm-Power_002dUp-Tests">A.1.5 Public Key Algorithm Power-Up Tests</a></li>
      <li><a name="toc-Key-derivation-function-Power_002dUp-Tests" href="#Key-derivation-function-Power_002dUp-Tests">A.1.6 Key derivation function Power-Up Tests</a></li>
      <li><a name="toc-Integrity-Power_002dUp-Tests" href="#Integrity-Power_002dUp-Tests">A.1.7 Integrity Power-Up Tests</a></li>
    </ul></li>
    <li><a name="toc-Conditional-Tests" href="#Conditional-Tests">A.2 Conditional Tests</a>
    <ul class="toc">
      <li><a name="toc-Key_002dPair-Generation-Tests" href="#Key_002dPair-Generation-Tests">A.2.1 Key-Pair Generation Tests</a></li>
      <li><a name="toc-Software-Load-Tests" href="#Software-Load-Tests">A.2.2 Software Load Tests</a></li>
      <li><a name="toc-Manual-Key-Entry-Tests" href="#Manual-Key-Entry-Tests">A.2.3 Manual Key Entry Tests</a></li>
    </ul></li>
    <li><a name="toc-Application-Requested-Tests" href="#Application-Requested-Tests">A.3 Application Requested Tests</a>
    <ul class="toc">
      <li><a name="toc-Symmetric-Cipher-Algorithm-Tests" href="#Symmetric-Cipher-Algorithm-Tests">A.3.1 Symmetric Cipher Algorithm Tests</a></li>
      <li><a name="toc-Hash-Algorithm-Tests" href="#Hash-Algorithm-Tests">A.3.2 Hash Algorithm Tests</a></li>
      <li><a name="toc-MAC-Algorithm-Tests" href="#MAC-Algorithm-Tests">A.3.3 MAC Algorithm Tests</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Description-of-the-FIPS-Mode" href="#FIPS-Mode">B. Description of the FIPS Mode</a>
  <ul class="toc">
    <li><a name="toc-Restrictions-in-FIPS-Mode" href="#Restrictions-in-FIPS-Mode">B.1 Restrictions in FIPS Mode</a></li>
    <li><a name="toc-FIPS-Finite-State-Machine" href="#FIPS-Finite-State-Machine">B.2 FIPS Finite State Machine</a></li>
    <li><a name="toc-FIPS-Miscellaneous-Information" href="#FIPS-Miscellaneous-Information">B.3 FIPS Miscellaneous Information</a></li>
  </ul></li>
  <li><a name="toc-GNU-Lesser-General-Public-License" href="#Library-Copying">GNU Lesser General Public License</a></li>
  <li><a name="toc-GNU-General-Public-License" href="#Copying">GNU General Public License</a></li>
  <li><a name="toc-List-of-Figures-and-Tables" href="#Figures-and-Tables">List of Figures and Tables</a></li>
  <li><a name="toc-Concept-Index-1" href="#Concept-Index">Concept Index</a></li>
  <li><a name="toc-Function-and-Data-Index-1" href="#Function-and-Data-Index">Function and Data Index</a></li>
</ul>
</div>
<hr size="1">
<a name="SEC_Overview"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Short Table of Contents</h1>
<div class="shortcontents">
<ul class="toc">
<li><a name="stoc-Introduction-1" href="#Introduction">1. Introduction</a></li>
<li><a name="stoc-Preparation-1" href="#Preparation">2. Preparation</a></li>
<li><a name="stoc-Generalities-1" href="#Generalities">3. Generalities</a></li>
<li><a name="stoc-Handler-Functions-1" href="#Handler-Functions">4. Handler Functions</a></li>
<li><a name="stoc-Symmetric-cryptography-1" href="#Symmetric-cryptography">5. Symmetric cryptography</a></li>
<li><a name="stoc-Public-Key-cryptography-1" href="#Public-Key-cryptography">6. Public Key cryptography</a></li>
<li><a name="stoc-Hashing-1" href="#Hashing">7. Hashing</a></li>
<li><a name="stoc-Message-Authentication-Codes-1" href="#Message-Authentication-Codes">8. Message Authentication Codes</a></li>
<li><a name="stoc-Key-Derivation-1" href="#Key-Derivation">9. Key Derivation</a></li>
<li><a name="stoc-Random-Numbers-1" href="#Random-Numbers">10. Random Numbers</a></li>
<li><a name="stoc-S_002dexpressions-1" href="#S_002dexpressions">11. S-expressions</a></li>
<li><a name="stoc-MPI-library-1" href="#MPI-library">12. MPI library</a></li>
<li><a name="stoc-Prime-numbers-1" href="#Prime-numbers">13. Prime numbers</a></li>
<li><a name="stoc-Utilities-1" href="#Utilities">14. Utilities</a></li>
<li><a name="stoc-Tools-1" href="#Tools">15. Tools</a></li>
<li><a name="stoc-Configuration-files-and-environment-variables" href="#Configuration">16. Configuration files and environment variables</a></li>
<li><a name="stoc-Architecture-1" href="#Architecture">17. Architecture</a></li>
<li><a name="stoc-Description-of-the-Self_002dTests" href="#Self_002dTests">A. Description of the Self-Tests</a></li>
<li><a name="stoc-Description-of-the-FIPS-Mode" href="#FIPS-Mode">B. Description of the FIPS Mode</a></li>
<li><a name="stoc-GNU-Lesser-General-Public-License" href="#Library-Copying">GNU Lesser General Public License</a></li>
<li><a name="stoc-GNU-General-Public-License" href="#Copying">GNU General Public License</a></li>
<li><a name="stoc-List-of-Figures-and-Tables" href="#Figures-and-Tables">List of Figures and Tables</a></li>
<li><a name="stoc-Concept-Index-1" href="#Concept-Index">Concept Index</a></li>
<li><a name="stoc-Function-and-Data-Index-1" href="#Function-and-Data-Index">Function and Data Index</a></li>
</ul>
</div>
<hr size="1">
<a name="SEC_About"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>
<p>
  This document was generated by <em>root</em> on <em>September 11, 2023</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr size="1">
<p>
 <font size="-1">
  This document was generated by <em>root</em> on <em>September 11, 2023</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.82</em></a>.
 </font>
 <br>

</p>
</body>
</html>
